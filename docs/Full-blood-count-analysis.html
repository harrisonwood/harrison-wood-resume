<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Harrison Wood" />


<title>Full blood count analysis</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.9/datatables.js"></script>
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">harrison-wood-resume</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/harrisonwood/harrison-wood-resume">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Full blood count analysis</h1>
<h4 class="author">Harrison Wood</h4>
<h4 class="date">9/19/2019</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-10-08
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>harrison-wood-resume/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.4.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20191008code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20191008)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20191008code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20191008)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomharrisonwoodharrisonwoodresumetree79272274970c260673e281eaf6ba23b2a7fc966dtargetblank7927227a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/harrisonwood/harrison-wood-resume/tree/79272274970c260673e281eaf6ba23b2a7fc966d" target="_blank">7927227</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomharrisonwoodharrisonwoodresumetree79272274970c260673e281eaf6ba23b2a7fc966dtargetblank7927227a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  VennDiagram2019-10-08_13-07-32.log
    Untracked:  code/common-functions.R
    Untracked:  data/Dexamethasone-study/
    Untracked:  data/Summary-blood-data.xlsx
    Untracked:  docs/figure/
    Untracked:  output/Dexamethasone-study/
    Untracked:  public/

Unstaged changes:
    Modified:   Workflowr-initialisation-script.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/harrisonwood/harrison-wood-resume/blob/79272274970c260673e281eaf6ba23b2a7fc966d/analysis/Full-blood-count-analysis.Rmd" target="_blank">7927227</a>
</td>
<td>
harrisonwood
</td>
<td>
2019-10-08
</td>
<td>
Publish site for interview
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="loading-data" class="section level2">
<h2>Loading data</h2>
<p>Data are stored in the ./data/ folder, and consist of full blood count measurements from an Advia 2120i Haematology system. Measurements were made on blood draws obtained via cardiac puncture of isofluorane-anaesthetised mice and stored in EDTA-coated tubes.</p>
<p>First we load the data in .xlsx format</p>
<pre class="r"><code>#Load the summary blood data
rawData &lt;- read_excel(&quot;data/Summary-blood-data.xlsx&quot;)
data &lt;- as.data.frame(rawData)</code></pre>
<div id="htmlwidget-1dd09e18dd9f56c1c39b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1dd09e18dd9f56c1c39b">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75"],["4637","4657","4665","4666","4669","4684","4696","4701","4704","4705","4708","4722","4723","4728","4730","294","297","303","309","317","302","313","319","320","324","326","328","322","330","4747","4780","4791","4795","4797","227","228","229","4752","4754","4755","4761","4790","4820","4841","4621","4622","4628","4629","4645","4650","4690","96","97","99","100","113","119","128","134","164","334","360","4835","4838","332","333","335","341","343","347","350","357","362","336","361"],["A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","A3NBL6","R577X ","R577X ","A3NBL6","A3NBL6","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X ","R577X "],["WT","KO","KO","WT","WT","WT","WT","KO","WT","KO","KO","KO","WT","WT","KO","XX","RR","RR","RR","RR","XX","RR","XX","XX","XX","XX","RR","RR","RR","KO","KO","WT","KO","KO","WT","WT","WT","WT","KO","WT","KO","WT","KO","WT","KO","KO","WT","WT","KO","WT","WT","KO","WT","KO","WT","KO","WT","WT","KO","KO","RR","RR","WT","WT","XX","XX","RR","RR","XX","RR","RR","XX","RR","RR","XX"],["F","F","F","F","F","F","F","F","F","F","F","F","F","F","F","M","M","F","M","F","M","F","M","M","F","M","M","F","F","F","F","F","F","F","M","M","M","F","F","F","F","F","F","F","F","F","F","F","F","F","F","M","M","M","M","M","M","M","M","M","F","F","M","M","F","F","M","M","F","M","M","M","M","M","F"],["3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months","3 months"],["None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","In situ muscle physiology","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     ","None                     "],["2019-06-28","2019-06-28","2019-06-28","2019-06-28","2019-06-28","2019-06-28","2019-06-28","2019-07-08","2019-07-08","2019-07-08","2019-07-08","2019-07-08","2019-07-08","2019-07-08","2019-07-08","2019-07-02","2019-07-02","2019-07-02","2019-07-02","2019-07-02","2019-07-03","2019-07-03","2019-07-03","2019-07-03","2019-07-11","2019-07-11","2019-07-11","2019-07-12","2019-07-12","2019-08-29","2019-08-29","2019-08-30","2019-08-30","2019-08-30","2019-09-02","2019-09-02","2019-09-02","2019-09-03","2019-09-03","2019-09-03","2019-09-03","2019-09-06","2019-09-06","2019-09-06","2019-06-26","2019-06-26","2019-06-26","2019-06-26","2019-06-26","2019-06-26","2019-06-26","2019-07-10","2019-07-10","2019-07-10","2019-07-10","2019-07-10","2019-07-10","2019-07-10","2019-07-10","2019-09-10","2019-09-10","2019-09-10","2019-09-10","2019-09-10","2019-09-11","2019-09-11","2019-09-11","2019-09-13","2019-09-13","2019-09-13","2019-09-13","2019-09-17","2019-09-17","2019-09-17","2019-09-17"],["Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","FAILED","FAILED","Y     ","Y     ","FAILED","Y     ","Y     ","Y     ","Y     ","Y     ","FAILED","Y     ","Y     ","FAILED","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","FAILED","Y     ","FAILED","FAILED","FAILED","FAILED","FAILED","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","FAILED","Y     ","FAILED","FAILED","Y     ","Y     ","FAILED","Y     ","FAILED","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     ","Y     "],["NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","Clotting                                   ","Clotting                                   ","NA                                         ","NA                                         ","Clotting                                   ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","Clotting                                   ","NA                                         ","NA                                         ","Clotting                                   ","NA                                         ","NA                                         ","NA                                         ","Left overnight                             ","Left overnight                             ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","Punctured the lung on blood draw           ","NA                                         ","NA                                         ","NA                                         ","Jane reported difficulty getting this blood","NA                                         ","Had to go fishing                          ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","Clotting                                   ","NA                                         ","Clotting                                   ","Clotting                                   ","Clotting                                   ","Clotting                                   ","Clotting                                   ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","Clotting                                   ","NA                                         ","Clotting                                   ","Clotting                                   ","Seeming internal bruise in gastrocnemius   ","NA                                         ","Clotting                                   ","Really had to fish for blood               ","Clotting                                   ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         ","NA                                         "],["2904BL6WT.4637","2904BL6KO.4657","2904BL6KO.4665","2904BL6WT.4666","2904BL6WT.4669","2904BL6WT.4684","2904BL6WT.4696","2967-KO.4701  ","2967-WT.4704  ","2967-KO.4705  ","NA            ","NA            ","2967-WT.4723  ","2967-WT.4728  ","NA            ","2922-XX.294M  ","2922-RR.297M  ","2932-RR.303F  ","2922-RR.309M  ","2932-RR.317F  ","NA            ","2932-RR.313F  ","2932-XX.319M  ","NA            ","2992-XXF.324  ","2992-XXM.326  ","2992-RRM.328  ","3006-RRF.322  ","3006-RRF.330  ","3332-A3NKO4747","3332-A3NKO4780","3337-A3NWT4791","3337-A3NKO4795","3337-A3NKO4797","3345-A3N.WT227","3345-A3N.WT228","3345-A3N.WT229","3346-A3NWT4752","3346-A3NKO4754","3346-A3NWT4755","3346-A3NKO4761","3391A3NBL64790","3391A3NBL64820","3391A3NBL64841","2874BL6KO4621 ","NA            ","2874BL6WT4628 ","NA            ","NA            ","NA            ","NA            ","NA            ","2983-WTM.97   ","2983-KOM.99   ","2983-WTM.100  ","2983-KOM.113  ","2983-WTM.119  ","2983-WTM.128  ","NA            ","3406A3NBL6K164","NA            ","NA            ","3406A3NBLW4835","3406A3NBLW4838","NA            ","3411R577XF.333","NA            ","3440-R577XM341","3440-R577XF343","3440-R577XM347","3440-R577XM350","3458R577XM357 ","3458R577XM362 ","3458R577XM336 ","3458R577XF361 "],["WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","NA  ","NA  ","WEHI","WEHI","NA  ","WEHI","WEHI","WEHI","WEHI","WEHI","NA  ","WEHI","WEHI","NA  ","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","NA  ","WEHI","NA  ","NA  ","NA  ","NA  ","NA  ","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","NA  ","WEHI","NA  ","NA  ","WEHI","WEHI","NA  ","WEHI","NA  ","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI","WEHI"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["2","2","2","2","2","2","2","2","2","2","NA","NA","2","2","NA","2","2","2","2","2","NA","2","2","NA","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","NA","2","NA","NA","NA","NA","NA","2","2","2","2","2","2","NA","2","NA","NA","2","2","NA","2","NA","2","2","2","2","2","2","2","2"],["292","293","294","290","288","289","291","69","64","67","NA","NA","62","63","NA","152","150","179","151","178","NA","177","174","NA","237","235","236","303","302","109","110","138","140","139","59","60","61","71","73","72","74","319","320","321","179","NA","183","NA","NA","NA","NA","NA","183","188","185","187","182","184","NA","135","NA","NA","137","136","NA","176","NA","319","322","320","321","97","98","99","100"],["6/28/2019 3:22:50 PM","6/28/2019 3:23:38 PM","6/28/2019 3:24:27 PM","6/28/2019 3:21:12 PM","6/28/2019 3:19:36 PM","6/28/2019 3:20:25 PM","6/28/2019 3:22:02 PM","43684.658333333333  ","43684.654861111114  ","43684.656944444447  ","NA                  ","NA                  ","43684.65347222222   ","43684.654166666667  ","NA                  ","43503.661354166667  ","43503.660208333335  ","43531.644999999997  ","43503.660787037035  ","43531.644444444442  ","NA                  ","43531.641655092593  ","43531.634502314817  ","NA                  ","43776.638043981482  ","43776.636944444443  ","43776.637476851851  ","43806.625486111108  ","43806.624930555554  ","8/29/2019 3:41:06 PM","8/29/2019 3:41:53 PM","8/30/2019 3:32:22 PM","8/30/2019 3:34:01 PM","8/30/2019 3:33:13 PM","43505.66306712963   ","43505.663611111115  ","43505.664178240739  ","43533.657175925924  ","43533.658402777779  ","43533.657835648148  ","43533.65896990741   ","43625.660208333335  ","43625.660798611112  ","43625.661319444444  ","6/26/2019 3:26:17 PM","NA                  ","6/26/2019 3:31:20 PM","NA                  ","NA                  ","NA                  ","NA                  ","NA                  ","43745.647268518522  ","43745.65047453704   ","43745.6483912037    ","43745.649918981479  ","43745.646643518521  ","43745.647847222222  ","NA                  ","43747.646631944444  ","NA                  ","NA                  ","43747.648958333331  ","43747.647326388891  ","NA                  ","43778.646458333336  ","NA                  ","9/13/2019 3:31:18 PM","9/13/2019 3:33:45 PM","9/13/2019 3:32:08 PM","9/13/2019 3:32:56 PM","9/17/2019 3:47:40 PM","9/17/2019 3:48:27 PM","9/17/2019 3:49:20 PM","9/17/2019 3:50:12 PM"],["5.48","5.77","4.35","7.70","4.48","9.41","4.20","4.21","4.04","3.71","NA","NA","5.07","4.03","NA","10.66","2.92","4.75","4.38","13.34","NA","3.57","3.88","NA","4.64","6.66","3.44","4.21","6.40","2.41","1.74","4.63","1.49","2.13","4.77","4.18","4.24","1.95","0.53","2.64","4.21","2.92","14.15","1.76","5.86","NA","5.23","NA","NA","NA","NA","NA","8.32","5.79","2.85","5.17","4.42","8.26","NA","5.73","NA","NA","3.93","4.38","NA","6.73","NA","6.63","3.54","2.73","2.60","3.70","3.32","4.78","2.06"],["5.54","6.17","4.10","7.43","4.36","9.33","4.16","4.19","4.10","3.80","NA","NA","5.13","4.08","NA","10.58","2.86","5.04","4.33","11.97","NA","3.75","4.64","NA","4.43","6.44","3.29","3.79","6.76","2.47","1.89","4.23","1.46","2.06","4.59","4.29","4.32","1.88","0.55","2.71","4.09","2.99","14.30","1.78","5.66","NA","5.34","NA","NA","NA","NA","NA","8.06","5.42","2.85","4.84","4.47","8.03","NA","5.71","NA","NA","3.94","4.59","NA","6.61","NA","6.73","3.48","2.69","2.50","3.87","3.28","4.65","1.97"],["9.47","8.56","8.11","7.31","9.19","8.34","8.55","9.08","9.15","8.95","NA","NA","8.87","8.71","NA","8.31","9.09","7.98","7.78","7.73","NA","8.80","8.04","NA","6.95","9.71","9.43","7.81","8.96","8.69","9.36","7.62","9.14","9.54","10.14","9.20","9.49","7.32","7.74","9.12","8.87","9.18","5.88","8.57","9.13","NA","8.90","NA","NA","NA","NA","NA","8.50","8.99","8.45","8.89","9.26","7.95","NA","7.48","NA","NA","9.23","8.51","NA","7.07","NA","8.35","9.13","8.53","9.47","9.03","8.85","9.43","8.21"],["14.5","13.1","12.9","11.3","14.0","13.0","12.9","14.1","13.9","13.8","NA","NA","13.4","13.2","NA","12.5","13.6","13.4","11.7","13.2","NA","13.4","12.2","NA","11.4","14.6","14.0","12.5","14.1","13.6","14.4","12.0","14.0","14.6","14.9","13.7","14.1","11.7","12.3","14.0","13.7","13.9","10.6","13.9","13.8","NA","13.5","NA","NA","NA","NA","NA","13.7","13.5","13.0","13.3","13.8","12.3","NA","12.2","NA","NA","13.9","12.8","NA","11.1","NA","12.9","13.7","12.5","14.0","13.4","13.0","13.9","12.5"],["13.8","12.6","12.2","10.8","13.4","12.3","12.6","13.1","13.1","13.1","NA","NA","12.6","12.4","NA","12.1","13.1","11.7","11.2","11.2","NA","12.9","11.6","NA","10.4","13.8","13.3","11.6","13.2","12.5","13.2","11.0","13.0","13.6","13.8","12.6","13.0","10.5","11.1","12.7","12.7","12.8","8.5","12.2","13.1","NA","12.8","NA","NA","NA","NA","NA","12.8","12.8","12.5","12.5","13.2","11.4","NA","11.0","NA","NA","13.0","11.9","NA","10.2","NA","11.8","12.9","12.0","13.2","12.5","12.1","12.9","11.8"],["45.6","39.3","38.6","33.2","44.6","39.0","40.0","44.0","43.7","41.5","NA","NA","42.1","41.6","NA","36.5","42.6","37.4","34.2","36.8","NA","40.4","35.9","NA","31.1","46.4","43.8","34.6","42.3","40.7","45.2","34.2","43.6","45.8","47.3","42.4","43.3","33.7","35.5","45.6","40.9","41.7","26.3","38.6","44.5","NA","43.4","NA","NA","NA","NA","NA","42.5","42.7","40.4","43.4","43.4","36.2","NA","35.5","NA","NA","44.2","41.9","NA","31.0","NA","37.4","42.6","38.7","45.3","42.7","42.1","44.6","38.0"],["48.1","45.9","47.6","45.4","48.5","46.7","46.9","48.5","47.8","46.3","NA","NA","47.4","47.7","NA","44.0","46.9","46.9","44.0","47.6","NA","45.9","44.6","NA","44.8","47.8","46.4","44.4","47.2","46.8","48.3","44.8","47.7","48.1","46.6","46.1","45.6","46.0","45.9","50.0","46.1","45.4","44.7","45.1","48.8","NA","48.8","NA","NA","NA","NA","NA","50.0","47.5","47.8","48.8","46.9","45.5","NA","47.6","NA","NA","47.9","49.2","NA","43.9","NA","44.8","46.6","45.3","47.8","47.2","47.5","47.3","46.3"],["15.3","15.3","15.9","15.5","15.2","15.5","15.1","15.5","15.2","15.5","NA","NA","15.1","15.1","NA","15.0","15.0","16.8","15.1","17.1","NA","15.3","15.2","NA","16.4","15.0","14.9","16.0","15.8","15.7","15.4","15.7","15.3","15.3","14.7","14.9","14.9","16.0","15.9","15.3","15.4","15.1","18.1","16.2","15.1","NA","15.2","NA","NA","NA","NA","NA","16.1","15.0","15.4","14.9","14.9","15.4","NA","16.3","NA","NA","15.0","15.0","NA","15.7","NA","15.4","15.0","14.7","14.7","14.9","14.7","14.7","15.2"],["31.8","33.2","33.4","34.2","31.4","33.3","32.3","31.9","31.7","33.3","NA","NA","31.8","31.7","NA","34.2","31.9","35.9","34.2","35.9","NA","33.3","34.0","NA","36.7","31.4","32.1","36.2","33.4","33.5","31.9","35.1","32.1","31.8","31.6","32.3","32.7","34.7","34.6","30.7","33.5","33.2","40.5","35.9","31.0","NA","31.1","NA","NA","NA","NA","NA","32.2","31.5","32.3","30.6","31.7","33.9","NA","34.3","NA","NA","31.4","30.5","NA","35.8","NA","34.5","32.2","32.4","30.9","31.5","31.0","31.1","32.9"],["30.3","31.9","31.7","32.5","30.1","31.5","31.5","29.8","29.9","31.7","NA","NA","30.0","29.9","NA","33.2","30.8","31.3","32.7","30.5","NA","32.0","32.3","NA","33.4","29.7","30.3","33.4","31.2","30.8","29.3","32.2","29.8","29.6","29.1","29.8","30.0","31.1","31.2","27.8","31.1","30.7","32.4","31.5","29.4","NA","29.5","NA","NA","NA","NA","NA","30.0","29.9","31.0","28.9","30.4","31.6","NA","31.0","NA","NA","29.3","28.3","NA","32.8","NA","31.6","30.3","30.9","29.1","29.3","28.8","28.8","31.0"],["14.6","14.7","15.1","14.8","14.6","14.8","14.8","14.5","14.3","14.7","NA","NA","14.3","14.3","NA","14.6","14.4","14.7","14.4","14.5","NA","14.7","14.4","NA","15.0","14.2","14.1","14.8","14.8","14.4","14.1","14.5","14.3","14.3","13.6","13.7","13.7","14.3","14.4","13.9","14.4","14.0","14.5","14.2","14.4","NA","14.4","NA","NA","NA","NA","NA","15.0","14.2","14.8","14.1","14.3","14.4","NA","14.7","NA","NA","14.0","13.9","NA","14.4","NA","14.2","14.1","14.0","13.9","13.9","13.7","13.6","14.4"],["1.79","1.83","1.89","1.88","1.83","1.82","1.83","1.77","1.73","1.85","NA","NA","1.75","1.75","NA","1.82","1.84","1.81","1.78","1.85","NA","1.82","1.81","NA","1.95","1.75","1.69","1.95","1.85","1.84","1.71","1.82","1.80","1.80","1.64","1.64","1.64","1.80","1.78","1.69","1.82","1.69","1.86","1.75","1.76","NA","1.75","NA","NA","NA","NA","NA","1.91","1.69","1.83","1.74","1.71","1.66","NA","1.88","NA","NA","1.76","1.82","NA","1.84","NA","1.76","1.79","1.69","1.71","1.68","1.63","1.62","1.82"],["12.1","12.6","13.0","13.1","12.2","12.5","12.4","12.4","12.2","12.9","NA","NA","12.3","12.3","NA","12.6","12.9","12.8","12.8","13.1","NA","12.8","13.2","NA","13.1","12.2","12.1","13.8","12.4","12.4","11.6","12.5","12.0","11.9","11.6","11.8","12.0","12.5","12.1","11.8","12.5","11.8","14.4","12.1","12.1","NA","12.0","NA","NA","NA","NA","NA","12.8","11.9","12.6","12.8","12.3","11.8","NA","13.6","NA","NA","13.0","14.1","NA","13.3","NA","13.0","12.3","12.4","12.1","12.0","12.1","11.8","12.3"],["1.75","1.90","1.82","2.11","1.73","1.87","1.82","1.69","1.70","1.92","NA","NA","1.73","1.70","NA","2.07","1.80","1.76","1.93","1.82","NA","2.02","2.06","NA","2.19","1.68","1.69","2.61","1.84","1.88","1.67","2.11","1.78","1.80","1.76","1.73","1.74","1.96","1.87","1.64","1.98","1.82","2.77","2.03","1.69","NA","1.72","NA","NA","NA","NA","NA","1.64","1.67","1.68","1.61","1.66","1.77","NA","2.05","NA","NA","1.78","1.76","NA","2.28","NA","2.07","1.80","1.83","1.71","1.67","1.66","1.59","1.83"],["952","922","630","465","1010","706","909","854","873","852","NA","NA","910","901","NA","847","1090","757","957","772","NA","880","567","NA","646","1000","800","706","859","875","932","812","817","866","1101","1003","975","343","715","806","833","825","349","794","889","NA","933","NA","NA","NA","NA","NA","653","1086","812","1079","1035","979","NA","722","NA","NA","942","905","NA","277","NA","803","901","971","1114","1018","1017","1069","826"],["4.6","4.5","4.7","5.4","4.7","5.2","4.5","4.7","4.7","4.9","NA","NA","4.6","4.6","NA","5.3","4.5","5.6","4.6","6.4","NA","4.6","5.5","NA","5.1","4.5","4.5","6.5","5.0","4.4","4.3","5.3","4.3","4.4","4.4","4.3","4.3","4.9","4.8","4.4","4.4","4.4","8.1","4.5","4.5","NA","4.5","NA","NA","NA","NA","NA","4.5","4.4","4.4","4.5","4.6","4.5","NA","4.5","NA","NA","4.5","4.6","NA","5.6","NA","5.0","4.5","4.3","4.5","4.3","4.3","4.3","4.3"],["41.1","35.1","44.7","56.2","39.0","54.8","36.5","41.5","39.8","49.7","NA","NA","42.3","38.0","NA","49.3","35.7","46.9","36.4","68.8","NA","37.2","52.3","NA","48.0","40.0","39.1","68.4","49.4","40.3","37.8","50.1","38.8","39.9","40.1","37.7","36.7","42.3","40.1","36.0","38.0","39.4","123.6","43.8","40.7","NA","41.9","NA","NA","NA","NA","NA","44.9","36.4","33.0","45.7","47.4","41.0","NA","41.6","NA","NA","39.5","38.8","NA","71.3","NA","50.6","36.9","33.4","46.9","35.2","37.4","39.2","39.9"],["28.9","29.5","28.7","27.2","28.6","27.4","29.7","28.5","28.6","28.1","NA","NA","28.4","29.2","NA","26.9","29.7","24.4","29.2","22.8","NA","29.7","27.6","NA","27.6","29.7","28.3","24.8","26.6","29.8","30.1","26.0","30.2","29.9","30.0","29.7","29.9","27.4","27.9","29.3","29.6","30.0","23.4","29.1","29.8","NA","29.2","NA","NA","NA","NA","NA","29.9","29.8","30.4","30.0","29.5","29.2","NA","30.2","NA","NA","30.1","29.7","NA","25.0","NA","28.3","29.6","30.3","29.3","30.2","30.3","29.6","30.3"],["1.27","1.27","1.28","1.38","1.26","1.32","1.28","1.28","1.27","1.30","NA","NA","1.25","1.29","NA","1.32","1.27","1.28","1.29","1.31","NA","1.32","1.44","NA","1.33","1.27","1.20","1.46","1.25","1.26","1.25","1.25","1.27","1.26","1.26","1.23","1.24","1.27","1.27","1.23","1.26","1.26","1.42","1.24","1.28","NA","1.25","NA","NA","NA","NA","NA","1.29","1.27","1.28","1.30","1.28","1.26","NA","1.31","NA","NA","1.30","1.31","NA","1.24","NA","1.33","1.26","1.26","1.25","1.25","1.25","1.21","1.27"],["0.44","0.41","0.30","0.25","0.47","0.36","0.41","0.40","0.41","0.42","NA","NA","0.42","0.42","NA","0.45","0.49","0.43","0.44","0.49","NA","0.41","0.31","NA","0.33","0.45","0.36","0.46","0.43","0.39","0.40","0.43","0.36","0.38","0.48","0.43","0.42","0.17","0.35","0.36","0.37","0.36","0.28","0.36","0.40","NA","0.42","NA","NA","NA","NA","NA","0.29","0.48","0.35","0.49","0.47","0.44","NA","0.33","NA","NA","0.42","0.42","NA","0.16","NA","0.40","0.40","0.42","0.50","0.44","0.44","0.46","0.36"],["0","0","0","2","0","3","0","1","0","1","NA","NA","1","0","NA","1","0","2","0","11","NA","0","1","NA","1","1","0","8","2","0","0","1","0","0","0","0","0","0","0","0","0","0","22","1","1","NA","1","NA","NA","NA","NA","NA","1","0","0","1","2","0","NA","1","NA","NA","1","0","NA","3","NA","1","0","0","1","0","0","0","0"],["8.0","3.0","6.9","5.5","4.0","5.5","4.6","4.2","4.6","4.5","NA","NA","5.8","5.1","NA","10.5","46.5","8.4","33.9","3.3","NA","6.0","14.3","NA","7.3","9.2","6.9","9.3","5.7","18.0","8.4","8.1","24.8","8.4","12.2","11.9","13.7","12.3","5.9","9.5","7.3","21.8","3.6","9.1","5.4","NA","6.7","NA","NA","NA","NA","NA","6.9","6.5","7.7","7.1","6.3","6.5","NA","9.0","NA","NA","34.3","33.1","NA","5.5","NA","6.0","6.1","6.0","8.4","9.9","11.2","7.8","7.1"],["85.3","90.1","89.4","80.4","89.9","77.1","89.7","91.7","90.3","89.6","NA","NA","87.0","90.1","NA","84.1","47.9","79.2","58.7","92.3","NA","89.5","62.6","NA","85.5","86.2","85.6","85.7","85.3","77.0","89.9","86.3","71.6","86.9","70.3","84.6","81.1","72.7","85.1","83.4","86.8","73.1","78.5","86.5","88.0","NA","86.2","NA","NA","NA","NA","NA","87.4","88.0","89.0","88.5","82.1","89.5","NA","85.1","NA","NA","57.9","61.9","NA","79.2","NA","87.8","87.9","88.9","88.3","83.0","83.9","86.9","86.9"],["2.6","1.2","1.7","1.1","2.0","1.8","1.7","1.5","1.7","2.1","NA","NA","1.4","1.6","NA","0.7","4.1","0.5","3.4","0.6","NA","1.3","0.9","NA","0.9","1.2","1.1","0.3","1.1","1.4","0.4","0.6","1.1","0.6","1.0","0.6","1.0","0.8","0.8","0.6","1.3","1.2","0.4","0.4","1.4","NA","2.3","NA","NA","NA","NA","NA","2.0","2.1","1.0","1.2","1.4","1.3","NA","2.5","NA","NA","3.5","1.9","NA","0.5","NA","1.9","1.8","1.2","1.2","1.4","0.7","1.8","1.9"],["1.5","1.9","1.5","2.2","3.2","1.4","3.0","1.9","2.5","2.7","NA","NA","2.9","2.0","NA","1.6","1.3","9.7","1.8","0.9","NA","2.4","19.4","NA","3.1","2.6","1.8","2.1","6.7","3.1","0.8","1.0","2.2","2.0","2.6","2.0","2.2","6.7","0.4","2.9","1.8","2.8","0.5","2.8","4.4","NA","4.0","NA","NA","NA","NA","NA","2.3","2.8","2.0","2.7","6.4","1.3","NA","2.0","NA","NA","1.6","2.2","NA","4.0","NA","2.4","3.3","3.1","1.4","4.5","3.0","2.3","2.8"],["0.2","0.3","0.2","8.3","0.2","2.3","0.1","0.1","0.1","0.4","NA","NA","0.2","0.2","NA","2.1","0.1","0.4","1.4","6.8","NA","0.4","1.5","NA","2.3","0.1","0.5","1.7","0.3","0.4","0.1","3.1","0.2","0.1","0.7","0.2","0.4","3.1","14.2","0.0","0.7","0.3","22.4","0.2","0.2","NA","0.2","NA","NA","NA","NA","NA","0.2","0.1","0.2","0.0","0.3","0.3","NA","0.5","NA","NA","0.1","0.1","NA","20.7","NA","0.7","0.1","0.3","0.0","0.1","0.1","0.1","0.3"],["2.4","3.5","0.4","10.7","0.7","11.9","0.9","0.6","0.8","0.8","NA","NA","2.6","0.9","NA","0.9","0.2","1.8","0.7","2.9","NA","0.3","1.3","NA","0.8","0.8","4.1","0.8","0.9","0.1","0.4","1.0","0.2","2.1","13.2","0.6","1.6","4.4","7.8","3.7","2.1","0.9","17.0","1.0","0.5","NA","0.7","NA","NA","NA","NA","NA","1.2","0.6","0.2","0.6","3.5","1.0","NA","0.9","NA","NA","2.5","0.8","NA","10.8","NA","1.2","0.9","0.5","0.6","1.1","1.0","1.2","0.9"],["0.44","0.17","0.30","0.43","0.18","0.52","0.19","0.18","0.19","0.17","NA","NA","0.30","0.21","NA","1.12","1.36","0.40","1.49","0.44","NA","0.22","0.56","NA","0.34","0.61","0.24","0.39","0.37","0.43","0.15","0.37","0.37","0.18","0.58","0.50","0.58","0.24","0.03","0.25","0.31","0.64","0.51","0.16","0.32","NA","0.35","NA","NA","NA","NA","NA","0.58","0.37","0.22","0.37","0.28","0.54","NA","0.52","NA","NA","1.35","1.45","NA","0.37","NA","0.40","0.22","0.16","0.22","0.37","0.37","0.37","0.15"],["4.67","5.20","3.89","6.20","4.03","7.25","3.77","3.86","3.65","3.32","NA","NA","4.42","3.63","NA","8.97","1.40","3.77","2.57","12.31","NA","3.20","2.43","NA","3.96","5.74","2.95","3.61","5.46","1.85","1.57","3.99","1.07","1.85","3.35","3.53","3.44","1.42","0.45","2.20","3.65","2.13","11.11","1.53","5.16","NA","4.51","NA","NA","NA","NA","NA","7.27","5.09","2.54","4.58","3.63","7.39","NA","4.87","NA","NA","2.27","2.71","NA","5.33","NA","5.82","3.11","2.42","2.30","3.08","2.79","4.15","1.79"],["0.14","0.07","0.07","0.08","0.09","0.17","0.07","0.06","0.07","0.08","NA","NA","0.07","0.07","NA","0.08","0.12","0.03","0.15","0.08","NA","0.05","0.03","NA","0.04","0.08","0.04","0.01","0.07","0.03","0.01","0.03","0.02","0.01","0.05","0.03","0.04","0.02","0.00","0.02","0.05","0.03","0.05","0.01","0.08","NA","0.12","NA","NA","NA","NA","NA","0.17","0.12","0.03","0.06","0.06","0.11","NA","0.14","NA","NA","0.14","0.08","NA","0.04","NA","0.13","0.07","0.03","0.03","0.05","0.02","0.08","0.04"],["0.08","0.11","0.07","0.17","0.14","0.13","0.12","0.08","0.10","0.10","NA","NA","0.15","0.08","NA","0.17","0.04","0.46","0.08","0.12","NA","0.09","0.75","NA","0.15","0.17","0.06","0.09","0.43","0.07","0.01","0.05","0.03","0.04","0.12","0.08","0.09","0.13","0.00","0.08","0.08","0.08","0.07","0.05","0.26","NA","0.21","NA","NA","NA","NA","NA","0.19","0.16","0.06","0.14","0.28","0.11","NA","0.11","NA","NA","0.06","0.10","NA","0.27","NA","0.16","0.12","0.08","0.04","0.17","0.10","0.11","0.06"],["0.01","0.02","0.01","0.64","0.01","0.22","0.01","0.00","0.00","0.02","NA","NA","0.01","0.01","NA","0.23","0.00","0.02","0.06","0.90","NA","0.01","0.06","NA","0.11","0.01","0.02","0.07","0.02","0.01","0.00","0.14","0.00","0.00","0.03","0.01","0.02","0.06","0.08","0.00","0.03","0.01","3.17","0.00","0.01","NA","0.01","NA","NA","NA","NA","NA","0.01","0.01","0.00","0.00","0.01","0.03","NA","0.03","NA","NA","0.01","0.00","NA","1.39","NA","0.05","0.00","0.01","0.00","0.00","0.00","0.00","0.01"],["0.13","0.20","0.02","0.83","0.03","1.12","0.04","0.03","0.03","0.03","NA","NA","0.13","0.04","NA","0.10","0.00","0.09","0.03","0.39","NA","0.01","0.05","NA","0.04","0.05","0.14","0.03","0.06","0.00","0.01","0.05","0.00","0.04","0.63","0.02","0.07","0.08","0.04","0.10","0.09","0.03","2.40","0.02","0.03","NA","0.04","NA","NA","NA","NA","NA","0.10","0.03","0.01","0.03","0.15","0.08","NA","0.05","NA","NA","0.10","0.04","NA","0.73","NA","0.08","0.03","0.01","0.02","0.04","0.03","0.06","0.02"],["24.0","4.2","10.8","11.2","8.4","20.4","12.0","8.2","3.6","11.8","NA","NA","5.3","5.0","NA","14.5","40.5","6.7","4.7","9.8","NA","7.4","16.4","NA","16.8","4.1","6.2","9.0","7.3","22.7","21.9","17.1","13.4","33.4","30.9","19.5","15.3","23.3","26.1","17.9","6.0","10.7","11.0","6.5","8.3","NA","3.6","NA","NA","NA","NA","NA","5.8","10.3","9.5","5.1","8.7","9.8","NA","12.5","NA","NA","9.7","20.4","NA","15.0","NA","9.5","8.8","4.8","7.7","2.3","1.7","5.6","8.4"],["75.7","95.4","88.9","79.4","91.4","76.4","87.8","91.7","96.2","87.8","NA","NA","94.4","94.5","NA","83.2","59.2","92.9","93.8","82.1","NA","92.1","80.1","NA","80.6","95.7","93.1","88.7","92.3","76.8","77.9","79.5","86.5","66.4","67.9","80.2","84.3","71.9","59.1","81.8","93.1","88.9","66.2","93.1","91.4","NA","96.1","NA","NA","NA","NA","NA","93.9","89.5","90.3","94.8","90.9","89.8","NA","86.9","NA","NA","90.1","79.5","NA","63.7","NA","89.8","91.0","94.9","92.2","97.7","98.2","94.3","91.2"],["1.89","2.00","2.11","2.03","2.08","1.97","1.83","1.82","1.92","1.83","NA","NA","2.05","2.11","NA","1.86","2.11","1.84","2.00","1.56","NA","1.75","1.93","NA","1.93","1.86","1.85","1.93","1.86","1.90","1.89","1.97","1.83","1.94","2.35","1.88","1.93","2.05","1.79","1.76","1.93","2.00","2.35","1.80","2.11","NA","2.00","NA","NA","NA","NA","NA","2.26","1.84","2.03","1.92","1.89","1.98","NA","1.88","NA","NA","2.22","2.00","NA","2.06","NA","1.86","2.05","1.93","1.92","1.81","1.77","1.64","1.74"],["-1.0","8.5","1.0","9.3","0.1","-2.5","1.1","2.3","2.7","6.7","NA","NA","5.0","2.3","NA","-1.1","0.4","21.7","0.2","-10.6","NA","4.9","3.7","NA","6.1","7.1","0.3","7.2","6.0","4.0","16.7","3.6","3.5","14.9","9.6","6.7","2.6","14.9","8.2","11.4","1.0","8.3","17.0","15.8","17.5","NA","7.7","NA","NA","NA","NA","NA","0.5","2.1","1.9","0.5","10.8","-1.9","NA","2.7","NA","NA","2.8","3.9","NA","75.5","NA","4.7","8.7","6.6","1.1","7.5","-0.8","2.4","4.7"],["3.27","2.17","3.16","2.60","3.16","3.02","3.15","3.80","3.99","2.85","NA","NA","3.31","3.89","NA","2.98","3.59","4.07","2.58","3.79","NA","0.00","3.12","NA","2.98","3.59","3.47","3.52","3.86","3.51","3.57","3.39","3.28","3.34","3.36","3.20","3.02","3.48","2.60","4.39","4.25","2.96","3.28","2.81","3.52","NA","3.97","NA","NA","NA","NA","NA","4.04","3.08","3.06","3.60","3.21","2.72","NA","3.20","NA","NA","3.90","4.69","NA","2.82","NA","2.86","2.86","2.65","2.98","3.08","3.32","3.14","2.66"],["51.3","49.9","51.6","50.5","51.2","50.8","50.9","51.3","50.6","50.2","NA","NA","50.3","50.7","NA","49.2","50.2","50.2","48.6","50.5","NA","0.0","49.2","NA","49.4","50.0","49.3","48.4","50.3","50.4","51.3","49.8","50.8","50.8","49.5","49.9","49.7","50.5","50.5","52.5","50.0","49.6","50.9","49.9","51.5","NA","51.8","NA","NA","NA","NA","NA","52.9","50.1","51.1","51.2","49.8","49.7","NA","52.7","NA","NA","50.8","52.1","NA","49.4","NA","49.7","50.1","49.4","50.8","50.5","50.9","50.5","50.5"],["30.1","30.8","30.6","30.4","30.1","30.3","30.3","30.1","30.1","30.6","NA","NA","30.1","30.0","NA","30.8","30.3","30.8","30.8","30.4","NA","0.0","30.6","NA","31.3","30.2","30.4","31.9","30.9","29.8","29.2","30.1","29.6","29.7","29.1","29.0","29.0","29.5","29.7","28.2","30.1","29.6","29.3","29.6","29.5","NA","29.5","NA","NA","NA","NA","NA","30.0","30.0","30.6","29.6","30.5","30.3","NA","28.9","NA","NA","29.3","28.6","NA","30.2","NA","29.5","29.6","29.5","29.0","29.0","28.5","28.8","29.7"],["15.4","15.3","15.8","15.3","15.4","15.4","15.4","15.4","15.2","15.3","NA","NA","15.1","15.2","NA","15.1","15.2","15.4","14.9","15.3","NA","0.0","15.0","NA","15.4","15.1","15.0","15.4","15.5","15.0","15.0","15.0","15.1","15.1","14.4","14.5","14.4","14.9","15.0","14.8","15.0","14.7","14.9","14.8","15.2","NA","15.3","NA","NA","NA","NA","NA","15.9","15.0","15.6","15.1","15.1","15.1","NA","15.2","NA","NA","14.8","14.9","NA","14.9","NA","14.7","14.8","14.6","14.7","14.6","14.5","14.6","15.0"],["12.1","12.8","12.9","13.0","12.0","12.5","12.2","12.1","12.3","12.7","NA","NA","12.2","12.1","NA","12.6","12.7","12.8","12.5","13.1","NA","0.0","13.0","NA","12.8","12.1","11.8","13.8","12.3","12.2","11.5","13.3","11.9","11.8","11.9","11.9","12.1","12.3","11.7","11.6","12.4","11.9","13.0","11.6","11.9","NA","11.9","NA","NA","NA","NA","NA","12.8","11.8","12.3","12.4","12.2","12.0","NA","13.2","NA","NA","12.8","13.7","NA","13.2","NA","13.1","12.4","12.3","12.0","12.0","12.0","11.8","12.2"],["1.76","1.94","1.86","2.02","1.72","1.88","1.77","1.73","1.75","1.84","NA","NA","1.77","1.74","NA","1.97","1.83","1.77","1.85","1.88","NA","0.00","2.06","NA","2.06","1.74","1.76","2.92","1.88","1.79","1.63","2.03","1.76","1.76","1.74","1.75","1.74","1.84","1.73","1.60","1.96","1.84","2.04","1.88","1.70","NA","1.69","NA","NA","NA","NA","NA","1.65","1.62","1.66","1.67","1.72","1.79","NA","1.81","NA","NA","1.77","1.84","NA","2.04","NA","2.00","1.82","1.78","1.70","1.68","1.63","1.66","1.76"],["59.9","62.2","62.5","61.3","59.6","60.9","59.7","60.0","59.6","60.7","NA","NA","59.2","59.1","NA","57.6","58.0","59.4","57.7","60.7","NA","0.0","58.1","NA","58.7","58.5","56.9","54.7","59.0","59.5","58.8","61.1","58.1","57.6","58.0","58.0","58.7","59.5","58.1","59.1","58.0","56.3","59.8","56.6","59.6","NA","60.5","NA","NA","NA","NA","NA","61.8","58.1","59.4","59.2","58.0","59.9","NA","63.0","NA","NA","58.9","61.0","NA","59.6","NA","60.3","60.1","60.2","58.7","58.6","57.8","58.6","58.5"],["27.7","27.1","27.3","26.7","28.3","26.8","27.6","27.9","27.8","27.2","NA","NA","27.7","27.8","NA","28.1","28.0","27.9","27.5","27.0","NA","0.0","27.6","NA","28.0","28.1","28.0","30.0","28.5","27.2","27.7","26.9","27.5","27.8","26.9","26.5","26.3","26.6","27.1","26.5","27.8","27.8","27.1","27.7","27.1","NA","27.4","NA","NA","NA","NA","NA","28.2","28.0","28.1","27.6","28.1","26.8","NA","25.9","NA","NA","26.9","26.2","NA","27.1","NA","26.1","27.2","25.9","26.7","27.1","26.4","26.7","27.5"],["16.4","16.6","16.9","16.1","16.8","16.2","16.4","16.7","16.5","16.4","NA","NA","16.3","16.3","NA","16.0","16.1","16.5","15.8","16.2","NA","0.0","15.9","NA","16.2","16.4","15.8","16.2","16.6","16.1","16.2","16.1","15.9","15.9","15.5","15.3","15.3","15.8","15.7","15.6","16.0","15.5","16.0","15.6","16.1","NA","16.5","NA","NA","NA","NA","NA","17.3","16.1","16.6","16.2","16.2","15.8","NA","16.2","NA","NA","15.8","16.0","NA","16.0","NA","15.5","16.3","15.5","15.6","15.8","15.2","15.6","16.0"],["17.0","20.4","17.3","19.4","14.7","17.9","14.9","13.0","15.5","15.9","NA","NA","16.2","13.5","NA","20.3","13.3","16.0","15.0","16.4","NA","0.0","17.6","NA","19.2","15.7","13.6","20.0","16.2","13.0","12.1","22.8","12.4","14.5","14.7","15.8","15.1","13.4","10.5","12.1","15.2","14.5","19.2","13.6","16.0","NA","14.8","NA","NA","NA","NA","NA","15.5","16.0","14.5","14.4","16.6","18.1","NA","15.4","NA","NA","13.4","13.2","NA","18.2","NA","18.8","15.1","13.6","14.1","14.9","13.5","14.1","13.4"],["2.95","3.35","3.19","3.76","2.61","3.23","2.90","2.58","2.74","2.95","NA","NA","2.81","2.74","NA","3.67","2.90","2.87","3.24","3.20","NA","0.00","3.99","NA","3.68","2.89","2.83","4.72","3.02","2.97","2.33","3.70","2.61","2.68","2.85","2.95","3.04","3.06","2.77","2.28","3.14","3.00","3.12","2.86","2.76","NA","2.56","NA","NA","NA","NA","NA","2.85","2.70","2.77","2.58","3.04","3.40","NA","2.96","NA","NA","2.67","2.54","NA","3.40","NA","3.72","2.92","3.14","2.79","2.66","2.59","2.71","2.85"],["1.11","0.27","0.29","0.63","0.45","1.55","1.00","2.11","2.78","0.46","NA","NA","2.53","2.66","NA","0.36","1.78","7.49","0.49","13.33","NA","0.00","0.34","NA","0.63","0.98","0.68","0.95","2.09","0.75","2.55","6.85","2.01","1.44","4.10","0.41","0.33","2.48","0.49","5.30","0.76","1.10","3.24","1.17","3.30","NA","2.43","NA","NA","NA","NA","NA","1.65","0.86","0.45","2.20","0.71","0.40","NA","1.34","NA","NA","2.75","8.44","NA","2.13","NA","0.68","0.40","0.35","2.67","1.58","1.25","1.95","0.23"],["31.86","8.17","16.02","9.13","20.00","19.64","19.89","39.16","35.40","15.73","NA","NA","36.78","37.51","NA","10.86","24.52","44.98","9.43","50.80","NA","0.00","11.52","NA","16.48","32.67","27.00","15.68","25.62","27.58","38.35","15.60","31.69","30.18","36.67","20.83","21.06","23.06","16.08","44.48","19.15","25.39","36.63","28.71","38.67","NA","36.25","NA","NA","NA","NA","NA","36.87","34.62","22.56","40.97","26.40","14.89","NA","20.60","NA","NA","34.51","52.24","NA","16.67","NA","13.16","16.06","12.95","39.97","30.97","31.75","35.11","18.09"],["0.1","0.1","0.1","0.1","0.1","0.1","0.1","0.1","0.1","0.1","NA","NA","0.1","0.1","NA","0.1","0.1","0.1","0.1","0.2","NA","0.1","0.2","NA","0.1","0.1","0.1","0.2","0.1","0.1","0.1","0.2","0.1","0.1","0.2","0.2","0.2","0.3","0.1","0.3","0.2","0.2","1.5","0.3","0.1","NA","0.2","NA","NA","NA","NA","NA","0.1","0.1","0.1","0.2","0.1","0.1","NA","0.4","NA","NA","0.3","0.4","NA","0.2","NA","0.3","0.1","0.1","0.2","0.1","0.2","0.2","0.1"],["4742","5001","3782","6647","3890","8097","3646","3644","3510","3217","NA","NA","4396","3490","NA","9177","2542","4112","3801","11401","NA","3105","3354","NA","4016","5742","2986","3645","5536","2099","1518","4027","1299","1852","4136","3628","3674","1689","464","2283","3656","2529","12082","1532","5074","NA","4525","NA","NA","NA","NA","NA","7180","5014","2475","4521","3827","7128","NA","4956","NA","NA","3403","3797","NA","5805","NA","5735","3079","2379","2263","3228","2882","4146","1796"],["97569","90890","85001","77358","96098","87319","90720","94039","94635","92964","NA","NA","93078","91771","NA","88422","96098","85140","85401","83675","NA","92140","83927","NA","76108","99648","96045","83444","93164","91176","96411","82610","93912","97093","103177","95978","97685","76225","82784","93816","92108","94349","65107","89809","94776","NA","93593","NA","NA","NA","NA","NA","88171","95419","89145","94725","96804","86911","NA","80989","NA","NA","95648","90286","NA","73642","NA","88131","94573","90896","98723","94901","93735","98204","87329"],["0.22","0.20","0.13","0.08","0.21","0.12","0.21","0.17","0.18","0.13","NA","NA","0.16","0.17","NA","0.14","0.26","0.10","0.20","0.08","NA","0.17","0.10","NA","0.10","0.24","0.18","0.08","0.13","0.20","0.25","0.12","0.20","0.22","0.29","0.24","0.23","0.06","0.12","0.19","0.20","0.19","0.04","0.16","0.22","NA","0.23","NA","NA","NA","NA","NA","0.15","0.26","0.20","0.26","0.24","0.20","NA","0.16","NA","NA","0.23","0.18","NA","0.05","NA","0.14","0.22","0.25","0.27","0.27","0.29","0.29","0.22"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","3","0","3","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","3","0","0","0","2","0","0","0","3","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","3","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","1","0","1","0","0","0","0","NA","NA","0","0","NA","1","0","1","0","0","NA","0","1","NA","1","0","0","1","1","0","0","0","0","0","0","0","0","1","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","1","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","1","0","0","0","NA","0","0","NA","0","0","0","0","0","0","1","0","0","0","1","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","1","0","1","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","1","1","1","1","0"],["0","0","0","0","0","0","0","0","0","0","NA","NA","0","0","NA","0","0","0","0","0","NA","0","0","NA","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","NA","0","NA","NA","NA","NA","NA","0","0","0","0","0","0","NA","0","NA","NA","0","0","NA","0","NA","0","0","0","0","0","0","0","0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID #<\/th>\n      <th>Model<\/th>\n      <th>Genotype<\/th>\n      <th>Sex<\/th>\n      <th>Age<\/th>\n      <th>Intervention<\/th>\n      <th>Date collected<\/th>\n      <th>Processed?<\/th>\n      <th>Notes<\/th>\n      <th>Idee<\/th>\n      <th>Instr#<\/th>\n      <th>SampleMode<\/th>\n      <th>SampleSel<\/th>\n      <th>Sequence<\/th>\n      <th>Date/Time<\/th>\n      <th>WBCB<\/th>\n      <th>WBCP<\/th>\n      <th>RBC<\/th>\n      <th>HGB<\/th>\n      <th>CalcHGB<\/th>\n      <th>HCT<\/th>\n      <th>MCV<\/th>\n      <th>MCH<\/th>\n      <th>MCHC<\/th>\n      <th>CHCM<\/th>\n      <th>CH<\/th>\n      <th>CHDW<\/th>\n      <th>RDW<\/th>\n      <th>HDW<\/th>\n      <th>PLT<\/th>\n      <th>MPV<\/th>\n      <th>PDW<\/th>\n      <th>MPC<\/th>\n      <th>MPM<\/th>\n      <th>PCT<\/th>\n      <th>Large PLT<\/th>\n      <th>%NEUT<\/th>\n      <th>%LYM<\/th>\n      <th>%MONO<\/th>\n      <th>%EOS<\/th>\n      <th>%BASO<\/th>\n      <th>%LUC<\/th>\n      <th>AbsNeut<\/th>\n      <th>AbsLymph<\/th>\n      <th>AbsMono<\/th>\n      <th>AbsEos<\/th>\n      <th>AbsBaso<\/th>\n      <th>AbsLUC<\/th>\n      <th>%PMN<\/th>\n      <th>%MN<\/th>\n      <th>LobIndex<\/th>\n      <th>MPXI<\/th>\n      <th>%RETIC<\/th>\n      <th>MCVg<\/th>\n      <th>CHCMg<\/th>\n      <th>CHg<\/th>\n      <th>R_C_RDW<\/th>\n      <th>R_C_HDW<\/th>\n      <th>MCVr<\/th>\n      <th>CHCMr<\/th>\n      <th>CHr<\/th>\n      <th>RDWr<\/th>\n      <th>HDWr<\/th>\n      <th>IRF_H<\/th>\n      <th>IRF_M+H<\/th>\n      <th>%HYPO<\/th>\n      <th>Baso PHA<\/th>\n      <th>RBC PHA<\/th>\n      <th>#RBC Frag<\/th>\n      <th>micro_cond<\/th>\n      <th>macro_cond<\/th>\n      <th>hypo_cond<\/th>\n      <th>hyper_cond<\/th>\n      <th>aniso_cond<\/th>\n      <th>var_cond<\/th>\n      <th>left_shift_cond<\/th>\n      <th>blast_cond<\/th>\n      <th>atyps_cond<\/th>\n      <th>nrbc_cond<\/th>\n      <th>ig_cond<\/th>\n      <th>large_plt_cond<\/th>\n      <th>plt_clumps_cond<\/th>\n      <th>mpo_deficiency<\/th>\n      <th>rbc_fragments_condition<\/th>\n      <th>rbc_ghosts_condition<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="clean-up-data" class="section level2">
<h2>Clean up data</h2>
<p>We then clean up the data for further analysis. This includes removing labels and descriptors, failed samples, and, optionally, categorical descriptors.</p>
<pre class="r"><code>#Remove failed samples
removeFailures &lt;- TRUE
if (removeFailures) {
  completedSamples &lt;- data$`Processed?` == &quot;Y&quot;
  data &lt;- data[completedSamples,]
}

#Remove abnormal samples
removeAbnormals &lt;- TRUE
if (removeAbnormals) {
  normalSamples &lt;- data$atyps_cond == 0
  data &lt;- data[normalSamples,]
}

#Clean up the data by excluding fields irrelevant to the analysis
labelFields &lt;-
  c(
    &quot;Age&quot;,
    &quot;Processed?&quot;,
    &quot;Notes&quot;,
    &quot;Idee&quot;,
    &quot;Instr#&quot;,
    &quot;SampleMode&quot;,
    &quot;SampleSel&quot;,
    &quot;Sequence&quot;,
    &quot;Date/Time&quot;
  )
data &lt;- data[, !(names(data) %in% labelFields)]

#Drop the fields containing categorical descriptions
categoricalFields &lt;-
  c(
    &quot;micro_cond&quot;,
    &quot;macro_cond&quot;,
    &quot;hypo_cond&quot;,
    &quot;hyper_cond&quot;,
    &quot;aniso_cond&quot;,
    &quot;var_cond&quot;,
    &quot;left_shift_cond&quot;,
    &quot;blast_cond&quot;,
    &quot;atyps_cond&quot;,
    &quot;nrbc_cond&quot;,
    &quot;ig_cond&quot;,
    &quot;large_plt_cond&quot;,
    &quot;plt_clumps_cond&quot;,
    &quot;mpo_deficiency&quot;,
    &quot;rbc_fragments_condition&quot;,
    &quot;rbc_ghosts_condition&quot;
  )
removeCategoricals &lt;- TRUE
if (removeCategoricals) {
  data &lt;- data[, !(names(data) %in% categoricalFields)]
}

#Clean up variable names to permit use in formulae later in analysis
names(data)&lt;-make.names(names(data))

#Ensure each animal has a unique identifier
data[,&quot;ID..&quot;]&lt;-make.unique(as.character(data[,&quot;ID..&quot;]))</code></pre>
</div>
<div id="experimental-design" class="section level2">
<h2>Experimental design</h2>
<p>We then factorise the independent variables and set up descriptors for the experimental design to prepare for plotting and later analysis.</p>
<pre class="r"><code>#Group genotypes based on Actn3 presence or absence
data$Actn3 &lt;- factor((data$Genotype == &quot;WT&quot; | data$Genotype == &quot;RR&quot;))
levels(data$Actn3) &lt;- c(&quot;KO&quot;, &quot;WT&quot;)

#Factor independent variables describing the experimental design
independentVariables &lt;-
  c(&quot;ID..&quot;,
    &quot;Model&quot;,
    &quot;Genotype&quot;,
    &quot;Sex&quot;,
    &quot;Intervention&quot;,
    &quot;Date.collected&quot;,
    &quot;Actn3&quot;)
data[independentVariables] &lt;-
  lapply(data[independentVariables], factor)

#Generate a list of the dependent properties being measured
dependentVariables &lt;- colnames(data)[!colnames(data)%in%independentVariables]

#Define colours for each grouping of independent variables
#Generate a data frame containing the colour key for the independent variable to be assessed
generateColourKey &lt;- function(plotGrouping = plotGrouping) {
  plotColours &lt;-
    suppressWarnings(I(brewer.pal(nlevels(data[, plotGrouping]), name =
                                    &quot;Set1&quot;))[1:nlevels(data[, plotGrouping])])
  names(plotColours) &lt;- levels(data[, plotGrouping])
  return(plotColours)
}

#Generate a colour legend for the independent variable
showColourLegend &lt;- function(plotColours = plotColours) {
  suppressWarnings(
    condformat(data.frame(Category = names(plotColours))) +
      rule_fill_discrete(1, expression = names(plotColours), colours = plotColours)
  )
}</code></pre>
</div>
<div id="principal-component-analysis" class="section level2">
<h2>Principal component analysis</h2>
<p>We then calculate the principal components of the dataset after centering and scaling, and plot the PCA coloured by each experimental factor to investigate the distrubtion of samples.</p>
<pre class="r"><code>#Exclude outlier samples biasing the PCA
outlierSamples &lt;- c(&quot;313&quot;)
excludeOutliers &lt;- TRUE
if (excludeOutliers) {
  #Filter out the outliers
  PCAdata &lt;- data[!data$ID.. %in% outlierSamples, ]
}

#Extract the labels
PCAlabels&lt;-PCAdata[, (names(PCAdata) %in% independentVariables)]
#Then trim them from the dataset
PCAdata&lt;-PCAdata[, !(names(PCAdata) %in% independentVariables)]

#Compute the PCA
PCA&lt;-prcomp(PCAdata,center=TRUE,scale=TRUE)</code></pre>
<div id="plot-each-independent-variable" class="section level3">
<h3>Plot each independent variable</h3>
<p>Click and drag on any plot to rotate the view.</p>
</div>
<div id="actn3" class="section level3">
<h3>Actn3</h3>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Category
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #E41A1C; text-align: center;">
KO
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
2
</td>
<td style="background-color: #377EB8; border-bottom: 2px solid grey; text-align: center;">
WT
</td>
</tr>
</tbody>
</table>
<script>/*
* Copyright (C) 2009 Apple Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
*    notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
*    notice, this list of conditions and the following disclaimer in the
*    documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
* PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* Copyright (2016) Duncan Murdoch - fixed CanvasMatrix4.ortho,
* cleaned up.
*/
/*
CanvasMatrix4 class
This class implements a 4x4 matrix. It has functions which
duplicate the functionality of the OpenGL matrix stack and
glut functions.
IDL:
[
Constructor(in CanvasMatrix4 matrix),           // copy passed matrix into new CanvasMatrix4
Constructor(in sequence<float> array)           // create new CanvasMatrix4 with 16 floats (row major)
Constructor()                                   // create new CanvasMatrix4 with identity matrix
]
interface CanvasMatrix4 {
attribute float m11;
attribute float m12;
attribute float m13;
attribute float m14;
attribute float m21;
attribute float m22;
attribute float m23;
attribute float m24;
attribute float m31;
attribute float m32;
attribute float m33;
attribute float m34;
attribute float m41;
attribute float m42;
attribute float m43;
attribute float m44;
void load(in CanvasMatrix4 matrix);                 // copy the values from the passed matrix
void load(in sequence<float> array);                // copy 16 floats into the matrix
sequence<float> getAsArray();                       // return the matrix as an array of 16 floats
WebGLFloatArray getAsCanvasFloatArray();           // return the matrix as a WebGLFloatArray with 16 values
void makeIdentity();                                // replace the matrix with identity
void transpose();                                   // replace the matrix with its transpose
void invert();                                      // replace the matrix with its inverse
void translate(in float x, in float y, in float z); // multiply the matrix by passed translation values on the right
void scale(in float x, in float y, in float z);     // multiply the matrix by passed scale values on the right
void rotate(in float angle,                         // multiply the matrix by passed rotation values on the right
in float x, in float y, in float z);    // (angle is in degrees)
void multRight(in CanvasMatrix matrix);             // multiply the matrix by the passed matrix on the right
void multLeft(in CanvasMatrix matrix);              // multiply the matrix by the passed matrix on the left
void ortho(in float left, in float right,           // multiply the matrix by the passed ortho values on the right
in float bottom, in float top,
in float near, in float far);
void frustum(in float left, in float right,         // multiply the matrix by the passed frustum values on the right
in float bottom, in float top,
in float near, in float far);
void perspective(in float fovy, in float aspect,    // multiply the matrix by the passed perspective values on the right
in float zNear, in float zFar);
void lookat(in float eyex, in float eyey, in float eyez,    // multiply the matrix by the passed lookat
in float ctrx, in float ctry, in float ctrz,    // values on the right
in float upx, in float upy, in float upz);
}
*/
CanvasMatrix4 = function(m)
{
if (typeof m == 'object') {
if ("length" in m && m.length >= 16) {
this.load(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]);
return;
}
else if (m instanceof CanvasMatrix4) {
this.load(m);
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.load = function()
{
if (arguments.length == 1 && typeof arguments[0] == 'object') {
var matrix = arguments[0];
if ("length" in matrix && matrix.length == 16) {
this.m11 = matrix[0];
this.m12 = matrix[1];
this.m13 = matrix[2];
this.m14 = matrix[3];
this.m21 = matrix[4];
this.m22 = matrix[5];
this.m23 = matrix[6];
this.m24 = matrix[7];
this.m31 = matrix[8];
this.m32 = matrix[9];
this.m33 = matrix[10];
this.m34 = matrix[11];
this.m41 = matrix[12];
this.m42 = matrix[13];
this.m43 = matrix[14];
this.m44 = matrix[15];
return;
}
if (arguments[0] instanceof CanvasMatrix4) {
this.m11 = matrix.m11;
this.m12 = matrix.m12;
this.m13 = matrix.m13;
this.m14 = matrix.m14;
this.m21 = matrix.m21;
this.m22 = matrix.m22;
this.m23 = matrix.m23;
this.m24 = matrix.m24;
this.m31 = matrix.m31;
this.m32 = matrix.m32;
this.m33 = matrix.m33;
this.m34 = matrix.m34;
this.m41 = matrix.m41;
this.m42 = matrix.m42;
this.m43 = matrix.m43;
this.m44 = matrix.m44;
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.getAsArray = function()
{
return [
this.m11, this.m12, this.m13, this.m14,
this.m21, this.m22, this.m23, this.m24,
this.m31, this.m32, this.m33, this.m34,
this.m41, this.m42, this.m43, this.m44
];
};
CanvasMatrix4.prototype.getAsWebGLFloatArray = function()
{
return new WebGLFloatArray(this.getAsArray());
};
CanvasMatrix4.prototype.makeIdentity = function()
{
this.m11 = 1;
this.m12 = 0;
this.m13 = 0;
this.m14 = 0;
this.m21 = 0;
this.m22 = 1;
this.m23 = 0;
this.m24 = 0;
this.m31 = 0;
this.m32 = 0;
this.m33 = 1;
this.m34 = 0;
this.m41 = 0;
this.m42 = 0;
this.m43 = 0;
this.m44 = 1;
};
CanvasMatrix4.prototype.transpose = function()
{
var tmp = this.m12;
this.m12 = this.m21;
this.m21 = tmp;
tmp = this.m13;
this.m13 = this.m31;
this.m31 = tmp;
tmp = this.m14;
this.m14 = this.m41;
this.m41 = tmp;
tmp = this.m23;
this.m23 = this.m32;
this.m32 = tmp;
tmp = this.m24;
this.m24 = this.m42;
this.m42 = tmp;
tmp = this.m34;
this.m34 = this.m43;
this.m43 = tmp;
};
CanvasMatrix4.prototype.invert = function()
{
// Calculate the 4x4 determinant
// If the determinant is zero,
// then the inverse matrix is not unique.
var det = this._determinant4x4();
if (Math.abs(det) < 1e-8)
return null;
this._makeAdjoint();
// Scale the adjoint matrix to get the inverse
this.m11 /= det;
this.m12 /= det;
this.m13 /= det;
this.m14 /= det;
this.m21 /= det;
this.m22 /= det;
this.m23 /= det;
this.m24 /= det;
this.m31 /= det;
this.m32 /= det;
this.m33 /= det;
this.m34 /= det;
this.m41 /= det;
this.m42 /= det;
this.m43 /= det;
this.m44 /= det;
};
CanvasMatrix4.prototype.translate = function(x,y,z)
{
if (x === undefined)
x = 0;
if (y === undefined)
y = 0;
if (z === undefined)
z = 0;
var matrix = new CanvasMatrix4();
matrix.m41 = x;
matrix.m42 = y;
matrix.m43 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.scale = function(x,y,z)
{
if (x === undefined)
x = 1;
if (z === undefined) {
if (y === undefined) {
y = x;
z = x;
}
else
z = 1;
}
else if (y === undefined)
y = x;
var matrix = new CanvasMatrix4();
matrix.m11 = x;
matrix.m22 = y;
matrix.m33 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.rotate = function(angle,x,y,z)
{
// angles are in degrees. Switch to radians
angle = angle / 180 * Math.PI;
angle /= 2;
var sinA = Math.sin(angle);
var cosA = Math.cos(angle);
var sinA2 = sinA * sinA;
// normalize
var length = Math.sqrt(x * x + y * y + z * z);
if (length === 0) {
// bad vector, just use something reasonable
x = 0;
y = 0;
z = 1;
} else if (length != 1) {
x /= length;
y /= length;
z /= length;
}
var mat = new CanvasMatrix4();
// optimize case where axis is along major axis
if (x == 1 && y === 0 && z === 0) {
mat.m11 = 1;
mat.m12 = 0;
mat.m13 = 0;
mat.m21 = 0;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 2 * sinA * cosA;
mat.m31 = 0;
mat.m32 = -2 * sinA * cosA;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y == 1 && z === 0) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 0;
mat.m13 = -2 * sinA * cosA;
mat.m21 = 0;
mat.m22 = 1;
mat.m23 = 0;
mat.m31 = 2 * sinA * cosA;
mat.m32 = 0;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y === 0 && z == 1) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 2 * sinA * cosA;
mat.m13 = 0;
mat.m21 = -2 * sinA * cosA;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 0;
mat.m31 = 0;
mat.m32 = 0;
mat.m33 = 1;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else {
var x2 = x*x;
var y2 = y*y;
var z2 = z*z;
mat.m11 = 1 - 2 * (y2 + z2) * sinA2;
mat.m12 = 2 * (x * y * sinA2 + z * sinA * cosA);
mat.m13 = 2 * (x * z * sinA2 - y * sinA * cosA);
mat.m21 = 2 * (y * x * sinA2 - z * sinA * cosA);
mat.m22 = 1 - 2 * (z2 + x2) * sinA2;
mat.m23 = 2 * (y * z * sinA2 + x * sinA * cosA);
mat.m31 = 2 * (z * x * sinA2 + y * sinA * cosA);
mat.m32 = 2 * (z * y * sinA2 - x * sinA * cosA);
mat.m33 = 1 - 2 * (x2 + y2) * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
}
this.multRight(mat);
};
CanvasMatrix4.prototype.multRight = function(mat)
{
var m11 = (this.m11 * mat.m11 + this.m12 * mat.m21 +
this.m13 * mat.m31 + this.m14 * mat.m41);
var m12 = (this.m11 * mat.m12 + this.m12 * mat.m22 +
this.m13 * mat.m32 + this.m14 * mat.m42);
var m13 = (this.m11 * mat.m13 + this.m12 * mat.m23 +
this.m13 * mat.m33 + this.m14 * mat.m43);
var m14 = (this.m11 * mat.m14 + this.m12 * mat.m24 +
this.m13 * mat.m34 + this.m14 * mat.m44);
var m21 = (this.m21 * mat.m11 + this.m22 * mat.m21 +
this.m23 * mat.m31 + this.m24 * mat.m41);
var m22 = (this.m21 * mat.m12 + this.m22 * mat.m22 +
this.m23 * mat.m32 + this.m24 * mat.m42);
var m23 = (this.m21 * mat.m13 + this.m22 * mat.m23 +
this.m23 * mat.m33 + this.m24 * mat.m43);
var m24 = (this.m21 * mat.m14 + this.m22 * mat.m24 +
this.m23 * mat.m34 + this.m24 * mat.m44);
var m31 = (this.m31 * mat.m11 + this.m32 * mat.m21 +
this.m33 * mat.m31 + this.m34 * mat.m41);
var m32 = (this.m31 * mat.m12 + this.m32 * mat.m22 +
this.m33 * mat.m32 + this.m34 * mat.m42);
var m33 = (this.m31 * mat.m13 + this.m32 * mat.m23 +
this.m33 * mat.m33 + this.m34 * mat.m43);
var m34 = (this.m31 * mat.m14 + this.m32 * mat.m24 +
this.m33 * mat.m34 + this.m34 * mat.m44);
var m41 = (this.m41 * mat.m11 + this.m42 * mat.m21 +
this.m43 * mat.m31 + this.m44 * mat.m41);
var m42 = (this.m41 * mat.m12 + this.m42 * mat.m22 +
this.m43 * mat.m32 + this.m44 * mat.m42);
var m43 = (this.m41 * mat.m13 + this.m42 * mat.m23 +
this.m43 * mat.m33 + this.m44 * mat.m43);
var m44 = (this.m41 * mat.m14 + this.m42 * mat.m24 +
this.m43 * mat.m34 + this.m44 * mat.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.multLeft = function(mat)
{
var m11 = (mat.m11 * this.m11 + mat.m12 * this.m21 +
mat.m13 * this.m31 + mat.m14 * this.m41);
var m12 = (mat.m11 * this.m12 + mat.m12 * this.m22 +
mat.m13 * this.m32 + mat.m14 * this.m42);
var m13 = (mat.m11 * this.m13 + mat.m12 * this.m23 +
mat.m13 * this.m33 + mat.m14 * this.m43);
var m14 = (mat.m11 * this.m14 + mat.m12 * this.m24 +
mat.m13 * this.m34 + mat.m14 * this.m44);
var m21 = (mat.m21 * this.m11 + mat.m22 * this.m21 +
mat.m23 * this.m31 + mat.m24 * this.m41);
var m22 = (mat.m21 * this.m12 + mat.m22 * this.m22 +
mat.m23 * this.m32 + mat.m24 * this.m42);
var m23 = (mat.m21 * this.m13 + mat.m22 * this.m23 +
mat.m23 * this.m33 + mat.m24 * this.m43);
var m24 = (mat.m21 * this.m14 + mat.m22 * this.m24 +
mat.m23 * this.m34 + mat.m24 * this.m44);
var m31 = (mat.m31 * this.m11 + mat.m32 * this.m21 +
mat.m33 * this.m31 + mat.m34 * this.m41);
var m32 = (mat.m31 * this.m12 + mat.m32 * this.m22 +
mat.m33 * this.m32 + mat.m34 * this.m42);
var m33 = (mat.m31 * this.m13 + mat.m32 * this.m23 +
mat.m33 * this.m33 + mat.m34 * this.m43);
var m34 = (mat.m31 * this.m14 + mat.m32 * this.m24 +
mat.m33 * this.m34 + mat.m34 * this.m44);
var m41 = (mat.m41 * this.m11 + mat.m42 * this.m21 +
mat.m43 * this.m31 + mat.m44 * this.m41);
var m42 = (mat.m41 * this.m12 + mat.m42 * this.m22 +
mat.m43 * this.m32 + mat.m44 * this.m42);
var m43 = (mat.m41 * this.m13 + mat.m42 * this.m23 +
mat.m43 * this.m33 + mat.m44 * this.m43);
var m44 = (mat.m41 * this.m14 + mat.m42 * this.m24 +
mat.m43 * this.m34 + mat.m44 * this.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.ortho = function(left, right, bottom, top, near, far)
{
var tx = (left + right) / (left - right);
var ty = (top + bottom) / (bottom - top);
var tz = (far + near) / (near - far);
var matrix = new CanvasMatrix4();
matrix.m11 = 2 / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = 0;
matrix.m32 = 0;
matrix.m33 = -2 / (far - near);
matrix.m34 = 0;
matrix.m41 = tx;
matrix.m42 = ty;
matrix.m43 = tz;
matrix.m44 = 1;
this.multRight(matrix);
};
CanvasMatrix4.prototype.frustum = function(left, right, bottom, top, near, far)
{
var matrix = new CanvasMatrix4();
var A = (right + left) / (right - left);
var B = (top + bottom) / (top - bottom);
var C = -(far + near) / (far - near);
var D = -(2 * far * near) / (far - near);
matrix.m11 = (2 * near) / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 * near / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = A;
matrix.m32 = B;
matrix.m33 = C;
matrix.m34 = -1;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = D;
matrix.m44 = 0;
this.multRight(matrix);
};
CanvasMatrix4.prototype.perspective = function(fovy, aspect, zNear, zFar)
{
var top = Math.tan(fovy * Math.PI / 360) * zNear;
var bottom = -top;
var left = aspect * bottom;
var right = aspect * top;
this.frustum(left, right, bottom, top, zNear, zFar);
};
CanvasMatrix4.prototype.lookat = function(eyex, eyey, eyez, centerx, centery, centerz, upx, upy, upz)
{
var matrix = new CanvasMatrix4();
// Make rotation matrix
// Z vector
var zx = eyex - centerx;
var zy = eyey - centery;
var zz = eyez - centerz;
var mag = Math.sqrt(zx * zx + zy * zy + zz * zz);
if (mag) {
zx /= mag;
zy /= mag;
zz /= mag;
}
// Y vector
var yx = upx;
var yy = upy;
var yz = upz;
// X vector = Y cross Z
xx =  yy * zz - yz * zy;
xy = -yx * zz + yz * zx;
xz =  yx * zy - yy * zx;
// Recompute Y = Z cross X
yx = zy * xz - zz * xy;
yy = -zx * xz + zz * xx;
yx = zx * xy - zy * xx;
// cross product gives area of parallelogram, which is < 1.0 for
// non-perpendicular unit-length vectors; so normalize x, y here
mag = Math.sqrt(xx * xx + xy * xy + xz * xz);
if (mag) {
xx /= mag;
xy /= mag;
xz /= mag;
}
mag = Math.sqrt(yx * yx + yy * yy + yz * yz);
if (mag) {
yx /= mag;
yy /= mag;
yz /= mag;
}
matrix.m11 = xx;
matrix.m12 = xy;
matrix.m13 = xz;
matrix.m14 = 0;
matrix.m21 = yx;
matrix.m22 = yy;
matrix.m23 = yz;
matrix.m24 = 0;
matrix.m31 = zx;
matrix.m32 = zy;
matrix.m33 = zz;
matrix.m34 = 0;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = 0;
matrix.m44 = 1;
matrix.translate(-eyex, -eyey, -eyez);
this.multRight(matrix);
};
// Support functions
CanvasMatrix4.prototype._determinant2x2 = function(a, b, c, d)
{
return a * d - b * c;
};
CanvasMatrix4.prototype._determinant3x3 = function(a1, a2, a3, b1, b2, b3, c1, c2, c3)
{
return a1 * this._determinant2x2(b2, b3, c2, c3) -
b1 * this._determinant2x2(a2, a3, c2, c3) +
c1 * this._determinant2x2(a2, a3, b2, b3);
};
CanvasMatrix4.prototype._determinant4x4 = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
return a1 * this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4) -
b1 * this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4) +
c1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4) -
d1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
};
CanvasMatrix4.prototype._makeAdjoint = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
// Row column labeling reversed since we transpose rows & columns
this.m11  =   this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4);
this.m21  = - this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4);
this.m31  =   this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4);
this.m41  = - this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
this.m12  = - this._determinant3x3(b1, b3, b4, c1, c3, c4, d1, d3, d4);
this.m22  =   this._determinant3x3(a1, a3, a4, c1, c3, c4, d1, d3, d4);
this.m32  = - this._determinant3x3(a1, a3, a4, b1, b3, b4, d1, d3, d4);
this.m42  =   this._determinant3x3(a1, a3, a4, b1, b3, b4, c1, c3, c4);
this.m13  =   this._determinant3x3(b1, b2, b4, c1, c2, c4, d1, d2, d4);
this.m23  = - this._determinant3x3(a1, a2, a4, c1, c2, c4, d1, d2, d4);
this.m33  =   this._determinant3x3(a1, a2, a4, b1, b2, b4, d1, d2, d4);
this.m43  = - this._determinant3x3(a1, a2, a4, b1, b2, b4, c1, c2, c4);
this.m14  = - this._determinant3x3(b1, b2, b3, c1, c2, c3, d1, d2, d3);
this.m24  =   this._determinant3x3(a1, a2, a3, c1, c2, c3, d1, d2, d3);
this.m34  = - this._determinant3x3(a1, a2, a3, b1, b2, b3, d1, d2, d3);
this.m44  =   this._determinant3x3(a1, a2, a3, b1, b2, b3, c1, c2, c3);
};</script>
<script>// To generate the help pages for this library, use
// jsdoc --destination ../../../doc/rglwidgetClass --template ~/node_modules/jsdoc-baseline rglClass.src.js
// To validate, use
// setwd(".../inst/htmlwidgets/lib/rglClass")
// hints <- js::jshint(readLines("rglClass.src.js"))
// hints[, c("line", "reason")]
/**
* The class of an rgl widget
* @class
*/
rglwidgetClass = function() {
this.canvas = null;
this.userMatrix = new CanvasMatrix4();
this.types = [];
this.prMatrix = new CanvasMatrix4();
this.mvMatrix = new CanvasMatrix4();
this.vp = null;
this.prmvMatrix = null;
this.origs = null;
this.gl = null;
this.scene = null;
this.select = {state: "inactive", subscene: null, region: {p1: {x:0, y:0}, p2: {x:0, y:0}}};
this.drawing = false;
};
/**
* Multiply matrix by vector
* @returns {number[]}
* @param M {number[][]} Left operand
* @param v {number[]} Right operand
*/
rglwidgetClass.prototype.multMV = function(M, v) {
return [ M.m11 * v[0] + M.m12 * v[1] + M.m13 * v[2] + M.m14 * v[3],
M.m21 * v[0] + M.m22 * v[1] + M.m23 * v[2] + M.m24 * v[3],
M.m31 * v[0] + M.m32 * v[1] + M.m33 * v[2] + M.m34 * v[3],
M.m41 * v[0] + M.m42 * v[1] + M.m43 * v[2] + M.m44 * v[3]
];
};
/**
* Multiply row vector by Matrix
* @returns {number[]}
* @param v {number[]} left operand
* @param M {number[][]} right operand
*/
rglwidgetClass.prototype.multVM = function(v, M) {
return [ M.m11 * v[0] + M.m21 * v[1] + M.m31 * v[2] + M.m41 * v[3],
M.m12 * v[0] + M.m22 * v[1] + M.m32 * v[2] + M.m42 * v[3],
M.m13 * v[0] + M.m23 * v[1] + M.m33 * v[2] + M.m43 * v[3],
M.m14 * v[0] + M.m24 * v[1] + M.m34 * v[2] + M.m44 * v[3]
];
};
/**
* Euclidean length of a vector
* @returns {number}
* @param v {number[]}
*/
rglwidgetClass.prototype.vlen = function(v) {
return Math.sqrt(this.dotprod(v, v));
};
/**
* Dot product of two vectors
* @instance rglwidgetClass
* @returns {number}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.dotprod = function(a, b) {
return a[0]*b[0] + a[1]*b[1] + a[2]*b[2];
};
/**
* Cross product of two vectors
* @returns {number[]}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
};
/**
* Bind vectors or matrices by columns
* @returns {number[][]}
* @param a {number[]|number[][]}
* @param b {number[]|number[][]}
*/
rglwidgetClass.prototype.cbind = function(a, b) {
if (b.length < a.length)
b = this.repeatToLen(b, a.length);
else if (a.length < b.length)
a = this.repeatToLen(a, b.length);
return a.map(function(currentValue, index, array) {
return currentValue.concat(b[index]);
});
};
/**
* Swap elements
* @returns {any[]}
* @param a {any[]}
* @param i {number} Element to swap
* @param j {number} Other element to swap
*/
rglwidgetClass.prototype.swap = function(a, i, j) {
var temp = a[i];
a[i] = a[j];
a[j] = temp;
};
/**
* Flatten a matrix into a vector
* @returns {any[]}
* @param a {any[][]}
*/
rglwidgetClass.prototype.flatten = function(arr, result) {
var value;
if (typeof result === "undefined") result = [];
for (var i = 0, length = arr.length; i < length; i++) {
value = arr[i];
if (Array.isArray(value)) {
this.flatten(value, result);
} else {
result.push(value);
}
}
return result;
};
/**
* set element of 1d or 2d array as if it was flattened.
* Column major, zero based!
* @returns {any[]|any[][]}
* @param {any[]|any[][]} a - array
* @param {number} i - element
* @param {any} value
*/
rglwidgetClass.prototype.setElement = function(a, i, value) {
if (Array.isArray(a[0])) {
var dim = a.length,
col = Math.floor(i/dim),
row = i % dim;
a[row][col] = value;
} else {
a[i] = value;
}
};
/**
* Transpose an array
* @returns {any[][]}
* @param {any[][]} a
*/
rglwidgetClass.prototype.transpose = function(a) {
var newArray = [],
n = a.length,
m = a[0].length,
i;
for(i = 0; i < m; i++){
newArray.push([]);
}
for(i = 0; i < n; i++){
for(var j = 0; j < m; j++){
newArray[j].push(a[i][j]);
}
}
return newArray;
};
/**
* Calculate sum of squares of a numeric vector
* @returns {number}
* @param {number[]} x
*/
rglwidgetClass.prototype.sumsq = function(x) {
var result = 0, i;
for (i=0; i < x.length; i++)
result += x[i]*x[i];
return result;
};
/**
* Convert a matrix to a CanvasMatrix4
* @returns {CanvasMatrix4}
* @param {number[][]|number[]} mat
*/
rglwidgetClass.prototype.toCanvasMatrix4 = function(mat) {
if (mat instanceof CanvasMatrix4)
return mat;
var result = new CanvasMatrix4();
mat = this.flatten(this.transpose(mat));
result.load(mat);
return result;
};
/**
* Convert an R-style numeric colour string to an rgb vector
* @returns {number[]}
* @param {string} s
*/
rglwidgetClass.prototype.stringToRgb = function(s) {
s = s.replace("#", "");
var bigint = parseInt(s, 16);
return [((bigint >> 16) & 255)/255,
((bigint >> 8) & 255)/255,
(bigint & 255)/255];
};
/**
* Take a component-by-component product of two 3 vectors
* @returns {number[]}
* @param {number[]} x
* @param {number[]} y
*/
rglwidgetClass.prototype.componentProduct = function(x, y) {
if (typeof y === "undefined") {
this.alertOnce("Bad arg to componentProduct");
}
var result = new Float32Array(3), i;
for (i = 0; i<3; i++)
result[i] = x[i]*y[i];
return result;
};
/**
* Get next higher power of two
* @returns { number }
* @param { number } value - input value
*/
rglwidgetClass.prototype.getPowerOfTwo = function(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
};
/**
* Unique entries
* @returns { any[] }
* @param { any[] } arr - An array
*/
rglwidgetClass.prototype.unique = function(arr) {
arr = [].concat(arr);
return arr.filter(function(value, index, self) {
return self.indexOf(value) === index;
});
};
/**
* Shallow compare of arrays
* @returns { boolean }
* @param { any[] } a - An array
* @param { any[] } b - Another array
*/
rglwidgetClass.prototype.equalArrays = function(a, b) {
return a === b || (a && b &&
a.length === b.length &&
a.every(function(v, i) {return v === b[i];}));
};
/**
* Repeat an array to a desired length
* @returns {any[]}
* @param {any | any[]} arr The input array
* @param {number} len The desired output length
*/
rglwidgetClass.prototype.repeatToLen = function(arr, len) {
arr = [].concat(arr);
while (arr.length < len/2)
arr = arr.concat(arr);
return arr.concat(arr.slice(0, len - arr.length));
};
/**
* Give a single alert message, not to be repeated.
* @param {string} msg  The message to give.
*/
rglwidgetClass.prototype.alertOnce = function(msg) {
if (typeof this.alerted !== "undefined")
return;
this.alerted = true;
alert(msg);
};
rglwidgetClass.prototype.f_is_lit = 1;
rglwidgetClass.prototype.f_is_smooth = 2;
rglwidgetClass.prototype.f_has_texture = 4;
rglwidgetClass.prototype.f_depth_sort = 8;
rglwidgetClass.prototype.f_fixed_quads = 16;
rglwidgetClass.prototype.f_is_transparent = 32;
rglwidgetClass.prototype.f_is_lines = 64;
rglwidgetClass.prototype.f_sprites_3d = 128;
rglwidgetClass.prototype.f_sprite_3d = 256;
rglwidgetClass.prototype.f_is_subscene = 512;
rglwidgetClass.prototype.f_is_clipplanes = 1024;
rglwidgetClass.prototype.f_fixed_size = 2048;
rglwidgetClass.prototype.f_is_points = 4096;
rglwidgetClass.prototype.f_is_twosided = 8192;
rglwidgetClass.prototype.f_fat_lines = 16384;
rglwidgetClass.prototype.f_is_brush = 32768;
/**
* Which list does a particular id come from?
* @returns { string }
* @param {number} id The id to look up.
*/
rglwidgetClass.prototype.whichList = function(id) {
var obj = this.getObj(id),
flags = obj.flags;
if (obj.type === "light")
return "lights";
if (flags & this.f_is_subscene)
return "subscenes";
if (flags & this.f_is_clipplanes)
return "clipplanes";
if (flags & this.f_is_transparent)
return "transparent";
return "opaque";
};
/**
* Get an object by id number.
* @returns { Object }
* @param {number} id
*/
rglwidgetClass.prototype.getObj = function(id) {
if (typeof id !== "number") {
this.alertOnce("getObj id is "+typeof id);
}
return this.scene.objects[id];
};
/**
* Get ids of a particular type from a subscene or the whole scene
* @returns { number[] }
* @param {string} type What type of object?
* @param {number} subscene  Which subscene?  If not given, find in the whole scene
*/
rglwidgetClass.prototype.getIdsByType = function(type, subscene) {
var
result = [], i, self = this;
if (typeof subscene === "undefined") {
Object.keys(this.scene.objects).forEach(
function(key) {
key = parseInt(key, 10);
if (self.getObj(key).type === type)
result.push(key);
});
} else {
ids = this.getObj(subscene).objects;
for (i=0; i < ids.length; i++) {
if (this.getObj(ids[i]).type === type) {
result.push(ids[i]);
}
}
}
return result;
};
/**
* Get a particular material property for an id
* @returns { any }
* @param {number} id  Which object?
* @param {string} property Which material property?
*/
rglwidgetClass.prototype.getMaterial = function(id, property) {
var obj = this.getObj(id), mat;
if (typeof obj.material === "undefined")
console.error("material undefined");
mat = obj.material[property];
if (typeof mat === "undefined")
mat = this.scene.material[property];
return mat;
};
/**
* Is a particular id in a subscene?
* @returns { boolean }
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.inSubscene = function(id, subscene) {
return this.getObj(subscene).objects.indexOf(id) > -1;
};
/**
* Add an id to a subscene.
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.addToSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
ids = [id],
obj = this.getObj(id), i;
if (typeof obj != "undefined" && typeof (obj.newIds) !== "undefined") {
ids = ids.concat(obj.newIds);
}
thesub.objects = [].concat(thesub.objects);
for (i = 0; i < ids.length; i++) {
id = ids[i];
if (thesub.objects.indexOf(id) == -1) {
thelist = this.whichList(id);
thesub.objects.push(id);
thesub[thelist].push(id);
}
}
};
/**
* Delete an id from a subscene
* @param { number } id - the id to add
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.delFromSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
obj = this.getObj(id),
ids = [id], i;
if (typeof obj !== "undefined" && typeof (obj.newIds) !== "undefined")
ids = ids.concat(obj.newIds);
thesub.objects = [].concat(thesub.objects); // It might be a scalar
for (j=0; j<ids.length;j++) {
id = ids[j];
i = thesub.objects.indexOf(id);
if (i > -1) {
thesub.objects.splice(i, 1);
thelist = this.whichList(id);
i = thesub[thelist].indexOf(id);
thesub[thelist].splice(i, 1);
}
}
};
/**
* Set the ids in a subscene
* @param { number[] } ids - the ids to set
* @param { number } subsceneid - the id of the subscene
*/
rglwidgetClass.prototype.setSubsceneEntries = function(ids, subsceneid) {
var sub = this.getObj(subsceneid);
sub.objects = ids;
this.initSubscene(subsceneid);
};
/**
* Get the ids in a subscene
* @returns {number[]}
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getSubsceneEntries = function(subscene) {
return this.getObj(subscene).objects;
};
/**
* Get the ids of the subscenes within a subscene
* @returns { number[] }
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getChildSubscenes = function(subscene) {
return this.getObj(subscene).subscenes;
};
/**
* Start drawing
* @returns { boolean } Previous state
*/
rglwidgetClass.prototype.startDrawing = function() {
var value = this.drawing;
this.drawing = true;
return value;
};
/**
* Stop drawing and check for context loss
* @param { boolean } saved - Previous state
*/
rglwidgetClass.prototype.stopDrawing = function(saved) {
this.drawing = saved;
if (!saved && this.gl && this.gl.isContextLost())
this.restartCanvas();
};
/**
* Generate the vertex shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getVertexShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userVertexShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
nclipplanes = this.countClipplanes(),
fixed_size = flags & this.f_fixed_size,
is_points = flags & this.f_is_points,
is_twosided = flags & this.f_is_twosided,
fat_lines = flags & this.f_fat_lines,
is_brush = flags & this.f_is_brush,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
result = "  /* ****** "+type+" object "+id+" vertex shader ****** */\n"+
"  attribute vec3 aPos;\n"+
"  attribute vec4 aCol;\n"+
" uniform mat4 mvMatrix;\n"+
" uniform mat4 prMatrix;\n"+
" varying vec4 vCol;\n"+
" varying vec4 vPosition;\n";
if ((is_lit && !fixed_quads && !is_brush) || sprite_3d)
result = result + "  attribute vec3 aNorm;\n"+
" uniform mat4 normMatrix;\n"+
" varying vec3 vNormal;\n";
if (has_texture || type === "text")
result = result + " attribute vec2 aTexcoord;\n"+
" varying vec2 vTexcoord;\n";
if (fixed_size)
result = result + "  uniform vec2 textScale;\n";
if (fixed_quads)
result = result + "  attribute vec2 aOfs;\n";
else if (sprite_3d)
result = result + "  uniform vec3 uOrig;\n"+
"  uniform float uSize;\n"+
"  uniform mat4 usermat;\n";
if (is_twosided)
result = result + "  attribute vec3 aPos1;\n"+
"  attribute vec3 aPos2;\n"+
"  varying float normz;\n";
if (fat_lines) {
result = result +   "  attribute vec3 aNext;\n"+
"  attribute vec2 aPoint;\n"+
"  varying vec2 vPoint;\n"+
"  varying float vLength;\n"+
"  uniform float uAspect;\n"+
"  uniform float uLwd;\n";
}
result = result + "  void main(void) {\n";
if ((nclipplanes || (!fixed_quads && !sprite_3d)) && !is_brush)
result = result + "    vPosition = mvMatrix * vec4(aPos, 1.);\n";
if (!fixed_quads && !sprite_3d && !is_brush)
result = result + "    gl_Position = prMatrix * vPosition;\n";
if (is_points) {
var size = this.getMaterial(id, "size");
result = result + "    gl_PointSize = "+size.toFixed(1)+";\n";
}
result = result + "    vCol = aCol;\n";
if (is_lit && !fixed_quads && !sprite_3d && !is_brush)
result = result + "    vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n";
if (has_texture || type == "text")
result = result + "    vTexcoord = aTexcoord;\n";
if (fixed_size)
result = result + "    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w;\n"+
"   gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n";
if (type == "sprites" && !fixed_size)
result = result + "    vec4 pos = mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w + vec4(aOfs, 0., 0.);\n"+
"   gl_Position = prMatrix*pos;\n";
if (sprite_3d)
result = result + "   vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n"+
"   vec4 pos = mvMatrix * vec4(uOrig, 1.);\n"+
"   vPosition = pos/pos.w + vec4(uSize*(vec4(aPos, 1.)*usermat).xyz,0.);\n"+
"   gl_Position = prMatrix * vPosition;\n";
if (is_twosided)
result = result + "   vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n"+
"   pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n"+
"   vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n"+
"   pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n"+
"   normz = pos1.x*pos2.y - pos1.y*pos2.x;\n";
if (fat_lines) 
/* This code was inspired by Matt Deslauriers' code in https://mattdesl.svbtle.com/drawing-lines-is-hard */
result = result + "   vec2 aspectVec = vec2(uAspect, 1.0);\n"+
"   mat4 projViewModel = prMatrix * mvMatrix;\n"+
"   vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n"+
"   currentProjected = currentProjected/currentProjected.w;\n"+
"   vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n"+
"   vec2 currentScreen = currentProjected.xy * aspectVec;\n"+
"   vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n"+
"   float len = uLwd;\n"+
"   vec2 dir = vec2(1.0, 0.0);\n"+
"   vPoint = aPoint;\n"+
"   vLength = length(nextScreen - currentScreen)/2.0;\n"+
"   vLength = vLength/(vLength + len);\n"+
"   if (vLength > 0.0) {\n"+
"     dir = normalize(nextScreen - currentScreen);\n"+
"   }\n"+
"   vec2 normal = vec2(-dir.y, dir.x);\n"+
"   dir.x /= uAspect;\n"+
"   normal.x /= uAspect;\n"+
"   vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n"+
"   gl_Position = currentProjected + offset;\n";
if (is_brush)
result = result + "   gl_Position = vec4(aPos, 1.);\n";
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Generate the fragment shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getFragmentShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userFragmentShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
is_twosided = (flags & this.f_is_twosided) > 0,
fat_lines = flags & this.f_fat_lines,
is_transparent = flags & this.f_is_transparent,
nclipplanes = this.countClipplanes(), i,
texture_format, nlights,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
if (has_texture)
texture_format = this.getMaterial(id, "textype");
result = "/* ****** "+type+" object "+id+" fragment shader ****** */\n"+
"#ifdef GL_ES\n"+
"#ifdef GL_FRAGMENT_PRECISION_HIGH\n"+
"  precision highp float;\n"+
"#else\n"+
"  precision mediump float;\n"+
"#endif\n"+
"#endif\n"+
"  varying vec4 vCol; // carries alpha\n"+
"  varying vec4 vPosition;\n";
if (has_texture || type === "text")
result = result + "  varying vec2 vTexcoord;\n"+
" uniform sampler2D uSampler;\n";
if (is_lit && !fixed_quads)
result = result + "  varying vec3 vNormal;\n";
for (i = 0; i < nclipplanes; i++)
result = result + "  uniform vec4 vClipplane"+i+";\n";
if (is_lit) {
nlights = this.countLights();
if (nlights)
result = result + "  uniform mat4 mvMatrix;\n";
else
is_lit = false;
}
if (is_lit) {
result = result + "   uniform vec3 emission;\n"+
"   uniform float shininess;\n";
for (i=0; i < nlights; i++) {
result = result + "   uniform vec3 ambient" + i + ";\n"+
"   uniform vec3 specular" + i +"; // light*material\n"+
"   uniform vec3 diffuse" + i + ";\n"+
"   uniform vec3 lightDir" + i + ";\n"+
"   uniform bool viewpoint" + i + ";\n"+
"   uniform bool finite" + i + ";\n";
}
}
if (is_twosided)
result = result + "   uniform bool front;\n"+
"   varying float normz;\n";
if (fat_lines)
result = result + "   varying vec2 vPoint;\n"+
"   varying float vLength;\n";
result = result + "  void main(void) {\n";
if (fat_lines) {
result = result + "    vec2 point = vPoint;\n"+
"    bool neg = point.y < 0.0;\n"+
"    point.y = neg ? "+
"      (point.y + vLength)/(1.0 - vLength) :\n"+
"     -(point.y - vLength)/(1.0 - vLength);\n";
if (is_transparent && type == "linestrip")
result = result+"    if (neg && length(point) <= 1.0) discard;\n";
result = result + "    point.y = min(point.y, 0.0);\n"+
"    if (length(point) > 1.0) discard;\n";
}
for (i=0; i < nclipplanes;i++)
result = result + "    if (dot(vPosition, vClipplane"+i+") < 0.0) discard;\n";
if (fixed_quads) {
result = result +   "    vec3 n = vec3(0., 0., 1.);\n";
} else if (is_lit) {
result = result +   "    vec3 n = normalize(vNormal);\n";
}
if (is_twosided) {
result = result +   "    if ((normz <= 0.) != front) discard;\n";
}
if (is_lit) {
result = result + "    vec3 eye = normalize(-vPosition.xyz);\n"+
"   vec3 lightdir;\n"+
"   vec4 colDiff;\n"+
"   vec3 halfVec;\n"+
"   vec4 lighteffect = vec4(emission, 0.);\n"+
"   vec3 col;\n"+
"   float nDotL;\n";
if (!fixed_quads) {
result = result +   "   n = -faceforward(n, n, eye);\n";
}
for (i=0; i < nlights; i++) {
result = result + "   colDiff = vec4(vCol.rgb * diffuse" + i + ", vCol.a);\n"+
"   lightdir = lightDir" + i + ";\n"+
"   if (!viewpoint" + i +")\n"+
"     lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n"+
"   if (!finite" + i + ") {\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   } else {\n"+
"     lightdir = normalize(lightdir - vPosition.xyz);\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   }\n"+
"    col = ambient" + i + ";\n"+
"   nDotL = dot(n, lightdir);\n"+
"   col = col + max(nDotL, 0.) * colDiff.rgb;\n"+
"   col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular" + i + ";\n"+
"   lighteffect = lighteffect + vec4(col, colDiff.a);\n";
}
} else {
result = result +   "   vec4 colDiff = vCol;\n"+
"    vec4 lighteffect = colDiff;\n";
}
if (type === "text")
result = result +   "    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n";
if (has_texture) {
result = result + {
rgb:            "   vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n",
rgba:           "   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n",
alpha:          "   vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n"+
"   textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n",
luminance:      "   vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n",
"luminance.alpha":"    vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n"+
"   textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n"
}[texture_format]+
"   gl_FragColor = textureColor;\n";
} else if (type === "text") {
result = result +   "    if (textureColor.a < 0.1)\n"+
"     discard;\n"+
"   else\n"+
"     gl_FragColor = textureColor;\n";
} else
result = result +   "   gl_FragColor = lighteffect;\n";
//if (fat_lines)
//  result = result +   "   gl_FragColor = vec4(0.0, abs(point.x), abs(point.y), 1.0);"
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Call gl functions to create and compile shader
* @returns {Object}
* @param { number } shaderType - gl code for shader type
* @param { string } code - code for the shader
*/
rglwidgetClass.prototype.getShader = function(shaderType, code) {
var gl = this.gl, shader;
shader = gl.createShader(shaderType);
gl.shaderSource(shader, code);
gl.compileShader(shader);
if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost())
alert(gl.getShaderInfoLog(shader));
return shader;
};
/**
* Handle a texture after its image has been loaded
* @param { Object } texture - the gl texture object
* @param { Object } textureCanvas - the canvas holding the image
*/
rglwidgetClass.prototype.handleLoadedTexture = function(texture, textureCanvas) {
var gl = this.gl || this.initGL();
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.generateMipmap(gl.TEXTURE_2D);
gl.bindTexture(gl.TEXTURE_2D, null);
};
/**
* Get maximum dimension of texture in current browser.
* @returns {number}
*/
rglwidgetClass.prototype.getMaxTexSize = function() {
var gl = this.gl || this.initGL();  
return Math.min(4096, gl.getParameter(gl.MAX_TEXTURE_SIZE));
};
/**
* Load an image to a texture
* @param { string } uri - The image location
* @param { Object } texture - the gl texture object
*/
rglwidgetClass.prototype.loadImageToTexture = function(uri, texture) {
var canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
image = new Image(),
self = this;
image.onload = function() {
var w = image.width,
h = image.height,
canvasX = self.getPowerOfTwo(w),
canvasY = self.getPowerOfTwo(h),
gl = self.gl || self.initGL(),
maxTexSize = self.getMaxTexSize();
while (canvasX > 1 && canvasY > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
canvasX /= 2;
canvasY /= 2;
}
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
self.handleLoadedTexture(texture, canvas);
self.drawScene();
};
image.src = uri;
};
/**
* Draw text to the texture canvas
* @returns { Object } object with text measurements
* @param { string } text - the text
* @param { number } cex - expansion
* @param { string } family - font family
* @param { number } font - font number
*/
rglwidgetClass.prototype.drawTextToCanvas = function(text, cex, family, font) {
var canvasX, canvasY,
textY,
scaling = 20,
textColour = "white",
backgroundColour = "rgba(0,0,0,0)",
canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
i, textHeight = 0, textHeights = [], width, widths = [], 
offsetx, offsety = 0, line, lines = [], offsetsx = [],
offsetsy = [], lineoffsetsy = [], fontStrings = [],
maxTexSize = this.getMaxTexSize(),
getFontString = function(i) {
textHeights[i] = scaling*cex[i];
var fontString = textHeights[i] + "px",
family0 = family[i],
font0 = font[i];
if (family0 === "sans")
family0 = "sans-serif";
else if (family0 === "mono")
family0 = "monospace";
fontString = fontString + " " + family0;
if (font0 === 2 || font0 === 4)
fontString = "bold " + fontString;
if (font0 === 3 || font0 === 4)
fontString = "italic " + fontString;
return fontString;
};
cex = this.repeatToLen(cex, text.length);
family = this.repeatToLen(family, text.length);
font = this.repeatToLen(font, text.length);
canvasX = 1;
line = -1;
offsetx = maxTexSize;
for (i = 0; i < text.length; i++)  {
ctx.font = fontStrings[i] = getFontString(i);
width = widths[i] = ctx.measureText(text[i]).width;
if (offsetx + width > maxTexSize) {
line += 1;
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
if (offsety > maxTexSize)
console.error("Too many strings for texture.");
textHeight = 0;
offsetx = 0;
}
textHeight = Math.max(textHeight, textHeights[i]);
offsetsx[i] = offsetx;
offsetx += width;
canvasX = Math.max(canvasX, offsetx);
lines[i] = line;
}
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
for (i = 0; i < text.length; i++) {
offsetsy[i] = lineoffsetsy[lines[i]];
}
canvasX = this.getPowerOfTwo(canvasX);
canvasY = this.getPowerOfTwo(offsety);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.textBaseline = "alphabetic";
for(i = 0; i < text.length; i++) {
ctx.font = fontStrings[i];
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.fillText(text[i], offsetsx[i],  offsetsy[i]);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeights:textHeights,
offsetsx:offsetsx, offsetsy:offsetsy};
};
/**
* Set the gl viewport and scissor test
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setViewport = function(id) {
var gl = this.gl || this.initGL(),
vp = this.getObj(id).par3d.viewport,
x = vp.x*this.canvas.width,
y = vp.y*this.canvas.height,
width = vp.width*this.canvas.width,
height = vp.height*this.canvas.height;
this.vp = {x:x, y:y, width:width, height:height};
gl.viewport(x, y, width, height);
gl.scissor(x, y, width, height);
gl.enable(gl.SCISSOR_TEST);
};
/**
* Set the projection matrix for a subscene
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setprMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.projection;
if (embedding === "replace")
this.prMatrix.makeIdentity();
else
this.setprMatrix(subscene.parent);
if (embedding === "inherit")
return;
// This is based on the Frustum::enclose code from geom.cpp
var bbox = subscene.par3d.bbox,
scale = subscene.par3d.scale,
ranges = [(bbox[1]-bbox[0])*scale[0]/2,
(bbox[3]-bbox[2])*scale[1]/2,
(bbox[5]-bbox[4])*scale[2]/2],
radius = Math.sqrt(this.sumsq(ranges))*1.1; // A bit bigger to handle labels
if (radius <= 0) radius = 1;
var observer = subscene.par3d.observer,
distance = observer[2],
FOV = subscene.par3d.FOV, ortho = FOV === 0,
t = ortho ? 1 : Math.tan(FOV*Math.PI/360),
near = distance - radius,
far = distance + radius,
hlen,
aspect = this.vp.width/this.vp.height,
z = subscene.par3d.zoom,
userProjection = subscene.par3d.userProjection;
if (far < 0.0)
far = 1.0;
if (near < far/100.0)
near = far/100.0;
hlen = t*near;
if (ortho) {
if (aspect > 1)
this.prMatrix.ortho(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.ortho(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
} else {
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
}
this.prMatrix.multRight(userProjection);
};
/**
* Set the model-view matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmvMatrix = function(id) {
var observer = this.getObj(id).par3d.observer;
this.mvMatrix.makeIdentity();
this.setmodelMatrix(id);
this.mvMatrix.translate(-observer[0], -observer[1], -observer[2]);
};
/**
* Set the model matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmodelMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.model;
if (embedding !== "inherit") {
var scale = subscene.par3d.scale,
bbox = subscene.par3d.bbox,
center = [(bbox[0]+bbox[1])/2,
(bbox[2]+bbox[3])/2,
(bbox[4]+bbox[5])/2];
this.mvMatrix.translate(-center[0], -center[1], -center[2]);
this.mvMatrix.scale(scale[0], scale[1], scale[2]);
this.mvMatrix.multRight( subscene.par3d.userMatrix );
}
if (embedding !== "replace")
this.setmodelMatrix(subscene.parent);
};
/**
* Set the normals matrix for a subscene
* @param { number } subsceneid - id of the subscene
*/
rglwidgetClass.prototype.setnormMatrix = function(subsceneid) {
var self = this,
recurse = function(id) {
var sub = self.getObj(id),
embedding = sub.embeddings.model;
if (embedding !== "inherit") {
var scale = sub.par3d.scale;
self.normMatrix.scale(1/scale[0], 1/scale[1], 1/scale[2]);
self.normMatrix.multRight(sub.par3d.userMatrix);
}
if (embedding !== "replace")
recurse(sub.parent);
};
self.normMatrix.makeIdentity();
recurse(subsceneid);
};
/**
* Set the combined projection-model-view matrix
*/
rglwidgetClass.prototype.setprmvMatrix = function() {
this.prmvMatrix = new CanvasMatrix4( this.mvMatrix );
this.prmvMatrix.multRight( this.prMatrix );
};
/**
* Count clipping planes in a scene
* @returns {number}
*/
rglwidgetClass.prototype.countClipplanes = function() {
return this.countObjs("clipplanes");
};
/**
* Count lights in a scene
* @returns { number }
*/
rglwidgetClass.prototype.countLights = function() {
return this.countObjs("light");
};
/**
* Count objects of specific type in a scene
* @returns { number }
* @param { string } type - Type of object to count
*/
rglwidgetClass.prototype.countObjs = function(type) {
var self = this,
bound = 0;
Object.keys(this.scene.objects).forEach(
function(key) {
if (self.getObj(parseInt(key, 10)).type === type)
bound = bound + 1;
});
return bound;
};
/**
* Initialize a subscene
* @param { number } id - id of subscene.
*/
rglwidgetClass.prototype.initSubscene = function(id) {
var sub = this.getObj(id),
i, obj;
if (sub.type !== "subscene")
return;
sub.par3d.userMatrix = this.toCanvasMatrix4(sub.par3d.userMatrix);
sub.par3d.userProjection = this.toCanvasMatrix4(sub.par3d.userProjection);
sub.par3d.userProjection.transpose();
sub.par3d.listeners = [].concat(sub.par3d.listeners);
sub.backgroundId = undefined;
sub.subscenes = [];
sub.clipplanes = [];
sub.transparent = [];
sub.opaque = [];
sub.lights = [];
for (i=0; i < sub.objects.length; i++) {
obj = this.getObj(sub.objects[i]);
if (typeof obj === "undefined") {
sub.objects.splice(i, 1);
i--;
} else if (obj.type === "background")
sub.backgroundId = obj.id;
else
sub[this.whichList(obj.id)].push(obj.id);
}
};
/**
* Copy object
* @param { number } id - id of object to copy
* @param { string } reuse - Document id of scene to reuse
*/
rglwidgetClass.prototype.copyObj = function(id, reuse) {
var obj = this.getObj(id),
prev = document.getElementById(reuse);
if (prev !== null) {
prev = prev.rglinstance;
var
prevobj = prev.getObj(id),
fields = ["flags", "type",
"colors", "vertices", "centers",
"normals", "offsets",
"texts", "cex", "family", "font", "adj",
"material",
"radii",
"texcoords",
"userMatrix", "ids",
"dim",
"par3d", "userMatrix",
"viewpoint", "finite",
"pos"],
i;
for (i = 0; i < fields.length; i++) {
if (typeof prevobj[fields[i]] !== "undefined")
obj[fields[i]] = prevobj[fields[i]];
}
} else
console.warn("copyObj failed");
};
/**
* Update the triangles used to display a plane
* @param { number } id - id of the plane
* @param { Object } bbox - bounding box in which to display the plane
*/
rglwidgetClass.prototype.planeUpdateTriangles = function(id, bbox) {
var perms = [[0,0,1], [1,2,2], [2,1,0]],
x, xrow, elem, A, d, nhits, i, j, k, u, v, w, intersect, which, v0, v2, vx, reverse,
face1 = [], face2 = [], normals = [],
obj = this.getObj(id),
nPlanes = obj.normals.length;
obj.bbox = bbox;
obj.vertices = [];
obj.initialized = false;
for (elem = 0; elem < nPlanes; elem++) {
//    Vertex Av = normal.getRecycled(elem);
x = [];
A = obj.normals[elem];
d = obj.offsets[elem][0];
nhits = 0;
for (i=0; i<3; i++)
for (j=0; j<2; j++)
for (k=0; k<2; k++) {
u = perms[0][i];
v = perms[1][i];
w = perms[2][i];
if (A[w] !== 0.0) {
intersect = -(d + A[u]*bbox[j+2*u] + A[v]*bbox[k+2*v])/A[w];
if (bbox[2*w] < intersect && intersect < bbox[1+2*w]) {
xrow = [];
xrow[u] = bbox[j+2*u];
xrow[v] = bbox[k+2*v];
xrow[w] = intersect;
x.push(xrow);
face1[nhits] = j + 2*u;
face2[nhits] = k + 2*v;
nhits++;
}
}
}
if (nhits > 3) {
/* Re-order the intersections so the triangles work */
for (i=0; i<nhits-2; i++) {
which = 0; /* initialize to suppress warning */
for (j=i+1; j<nhits; j++) {
if (face1[i] == face1[j] || face1[i] == face2[j] ||
face2[i] == face1[j] || face2[i] == face2[j] ) {
which = j;
break;
}
}
if (which > i+1) {
this.swap(x, i+1, which);
this.swap(face1, i+1, which);
this.swap(face2, i+1, which);
}
}
}
if (nhits >= 3) {
/* Put in order so that the normal points out the FRONT of the faces */
v0 = [x[0][0] - x[1][0] , x[0][1] - x[1][1], x[0][2] - x[1][2]];
v2 = [x[2][0] - x[1][0] , x[2][1] - x[1][1], x[2][2] - x[1][2]];
/* cross-product */
vx = this.xprod(v0, v2);
reverse = this.dotprod(vx, A) > 0;
for (i=0; i<nhits-2; i++) {
obj.vertices.push(x[0]);
normals.push(A);
for (j=1; j<3; j++) {
obj.vertices.push(x[i + (reverse ? 3-j : j)]);
normals.push(A);
}
}
}
}
obj.pnormals = normals;
};
rglwidgetClass.prototype.getAdj = function (pos, offset, text) {
switch(pos) {
case 1: return [0.5, 1 + offset];
case 2: return [1 + offset/text.length, 0.5];
case 3: return [0.5, -offset];
case 4: return [-offset/text.length, 0.5];
}
}
/**
* Initialize object for display
* @param { number } id - id of object to initialize
*/
rglwidgetClass.prototype.initObj = function(id) {
var obj = this.getObj(id),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = obj.is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
is_brush = flags & this.f_is_brush,
gl = this.gl || this.initGL(),
polygon_offset,
texinfo, drawtype, nclipplanes, f, nrows, oldrows,
i,j,v,v1,v2, mat, uri, matobj, pass, passes, pmode,
dim, nx, nz, attr;
if (typeof id !== "number") {
this.alertOnce("initObj id is "+typeof id);
}
obj.initialized = true;
if (type === "bboxdeco" || type === "subscene")
return;
if (type === "light") {
obj.ambient = new Float32Array(obj.colors[0].slice(0,3));
obj.diffuse = new Float32Array(obj.colors[1].slice(0,3));
obj.specular = new Float32Array(obj.colors[2].slice(0,3));
obj.lightDir = new Float32Array(obj.vertices[0]);
return;
}
if (type === "clipplanes") {
obj.vClipplane = this.flatten(this.cbind(obj.normals, obj.offsets));
return;
}
if (type === "background" && typeof obj.ids !== "undefined") {
obj.quad = this.flatten([].concat(obj.ids));
return;
}
polygon_offset = this.getMaterial(id, "polygon_offset");
if (polygon_offset[0] != 0 || polygon_offset[1] != 0)
obj.polygon_offset = polygon_offset;
if (is_transparent) {
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}
if (is_brush)
this.initSelection(id);
if (typeof obj.vertices === "undefined")
obj.vertices = [];
v = obj.vertices;
obj.vertexCount = v.length;
if (!obj.vertexCount) return;
if (is_twosided) {
if (typeof obj.userAttributes === "undefined")
obj.userAttributes = {};
v1 = Array(v.length);
v2 = Array(v.length);
if (obj.type == "triangles" || obj.type == "quads") {
if (obj.type == "triangles")
nrow = 3;
else
nrow = 4;
for (i=0; i<Math.floor(v.length/nrow); i++)
for (j=0; j<nrow; j++) {
v1[nrow*i + j] = v[nrow*i + ((j+1) % nrow)];
v2[nrow*i + j] = v[nrow*i + ((j+2) % nrow)];
}
} else if (obj.type == "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz && j+1 < nx) {
v2[j + nx*i] = v[j + nx*(i+1)];
v1[j + nx*i] = v[j+1 + nx*(i+1)];
} else if (i+1 < nz) {
v2[j + nx*i] = v[j-1 + nx*i];
v1[j + nx*i] = v[j + nx*(i+1)];
} else {
v2[j + nx*i] = v[j + nx*(i-1)];
v1[j + nx*i] = v[j-1 + nx*(i-1)];
}
}
}
}
obj.userAttributes.aPos1 = v1;
obj.userAttributes.aPos2 = v2;
}
if (!sprites_3d) {
if (gl.isContextLost()) return;
obj.prog = gl.createProgram();
gl.attachShader(obj.prog, this.getShader( gl.VERTEX_SHADER,
this.getVertexShader(id) ));
gl.attachShader(obj.prog, this.getShader( gl.FRAGMENT_SHADER,
this.getFragmentShader(id) ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(obj.prog, 0, "aPos");
gl.bindAttribLocation(obj.prog, 1, "aCol");
gl.linkProgram(obj.prog);
var linked = gl.getProgramParameter(obj.prog, gl.LINK_STATUS);
if (!linked) {
// An error occurred while linking
var lastError = gl.getProgramInfoLog(obj.prog);
console.warn("Error in program linking:" + lastError);
gl.deleteProgram(obj.prog);
return;
}
}
if (type === "text") {
texinfo = this.drawTextToCanvas(obj.texts,
this.flatten(obj.cex),
this.flatten(obj.family),
this.flatten(obj.family));
}
if (fixed_quads && !sprites_3d) {
obj.ofsLoc = gl.getAttribLocation(obj.prog, "aOfs");
}
if (sprite_3d) {
obj.origLoc = gl.getUniformLocation(obj.prog, "uOrig");
obj.sizeLoc = gl.getUniformLocation(obj.prog, "uSize");
obj.usermatLoc = gl.getUniformLocation(obj.prog, "usermat");
}
if (has_texture || type == "text") {
if (!obj.texture)
obj.texture = gl.createTexture();
obj.texLoc = gl.getAttribLocation(obj.prog, "aTexcoord");
obj.sampler = gl.getUniformLocation(obj.prog, "uSampler");
}
if (has_texture) {
mat = obj.material;
if (typeof mat.uri !== "undefined")
uri = mat.uri;
else if (typeof mat.uriElementId === "undefined") {
matobj = this.getObj(mat.uriId);
if (typeof matobj !== "undefined") {
uri = matobj.material.uri;
} else {
uri = "";
}
} else
uri = document.getElementById(mat.uriElementId).rglinstance.getObj(mat.uriId).material.uri;
this.loadImageToTexture(uri, obj.texture);
}
if (type === "text") {
this.handleLoadedTexture(obj.texture, this.textureCanvas);
}
var stride = 3, nc, cofs, nofs, radofs, oofs, tofs, vnew, fnew,
nextofs = -1, pointofs = -1, alias, colors, key, selection, filter, adj, pos, offset;
obj.alias = undefined;
colors = obj.colors;
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
key = this.scene.crosstalk.key[j];
options = this.scene.crosstalk.options[j];
colors = colors.slice(0); 
for (i = 0; i < v.length; i++)
colors[i] = obj.colors[i % obj.colors.length].slice(0);
if ( (selection = this.scene.crosstalk.selection) &&
(selection.length || !options.selectedIgnoreNone) )
for (i = 0; i < v.length; i++) {
if (!selection.includes(key[i])) {
if (options.deselectedColor)
colors[i] = options.deselectedColor.slice(0);
colors[i][3] = colors[i][3]*options.deselectedFade;   /* default: mostly transparent if not selected */
} else if (options.selectedColor)
colors[i] = options.selectedColor.slice(0);
}
if ( (filter = this.scene.crosstalk.filter) )
for (i = 0; i < v.length; i++) 
if (!filter.includes(key[i])) {
if (options.filteredColor)
colors[i] = options.filteredColor.slice(0);
colors[i][3] = colors[i][3]*options.filteredFade;   /* default: completely hidden if filtered */
}
}  
nc = obj.colorCount = colors.length;
if (nc > 1) {
cofs = stride;
stride = stride + 4;
v = this.cbind(v, colors);
} else {
cofs = -1;
obj.onecolor = this.flatten(colors);
}
if (typeof obj.normals !== "undefined") {
nofs = stride;
stride = stride + 3;
v = this.cbind(v, typeof obj.pnormals !== "undefined" ? obj.pnormals : obj.normals);
} else
nofs = -1;
if (typeof obj.radii !== "undefined") {
radofs = stride;
stride = stride + 1;
// FIXME:  always concat the radii?
if (obj.radii.length === v.length) {
v = this.cbind(v, obj.radii);
} else if (obj.radii.length === 1) {
v = v.map(function(row, i, arr) { return row.concat(obj.radii[0]);});
}
} else
radofs = -1;
// Add default indices
f = Array(v.length);
for (i = 0; i < v.length; i++)
f[i] = i;
obj.f = [f,f];
if (type == "sprites" && !sprites_3d) {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
fnew = new Array(4*v.length);
alias = new Array(v.length);
var rescale = fixed_size ? 72 : 1,
size = obj.radii, s = rescale*size[0]/2;
last = v.length;
f = obj.f[0];
for (i=0; i < v.length; i++) {
if (size.length > 1)
s = rescale*size[i]/2;
vnew[i]  = v[i].concat([0,0,-s,-s]);
fnew[4*i] = f[i];
vnew[last]= v[i].concat([1,0, s,-s]);
fnew[4*i+1] = last++;
vnew[last]= v[i].concat([1,1, s, s]);
fnew[4*i+2] = last++;
vnew[last]= v[i].concat([0,1,-s, s]);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (type === "text") {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
f = obj.f[0];
fnew = new Array(4*f.length);
alias = new Array(v.length);
last = v.length;
adj = this.flatten(obj.adj);
if (typeof obj.pos !== "undefined") {
pos = this.flatten(obj.pos);
offset = adj[0];
}
for (i=0; i < v.length; i++) {
if (typeof pos !== "undefined")
adj = this.getAdj(pos[i % pos.length], offset, obj.texts[i]);
vnew[i]  = v[i].concat([0,-0.5]).concat(adj);
fnew[4*i] = f[i];
vnew[last] = v[i].concat([1,-0.5]).concat(adj);
fnew[4*i+1] = last++;
vnew[last] = v[i].concat([1, 1.5]).concat(adj);
fnew[4*i+2] = last++;
vnew[last] = v[i].concat([0, 1.5]).concat(adj);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
for (j=0; j < 4; j++) {
v1 = vnew[fnew[4*i+j]];
v1[tofs+2] = 2*(v1[tofs]-v1[tofs+2])*texinfo.widths[i];
v1[tofs+3] = 2*(v1[tofs+1]-v1[tofs+3])*texinfo.textHeights[i];
v1[tofs] = (texinfo.offsetsx[i] + v1[tofs]*texinfo.widths[i])/texinfo.canvasX;
v1[tofs+1] = 1.0-(texinfo.offsetsy[i] -
v1[tofs+1]*texinfo.textHeights[i])/texinfo.canvasY;
vnew[fnew[4*i+j]] = v1;
}
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (typeof obj.texcoords !== "undefined") {
tofs = stride;
stride += 2;
oofs = -1;
v = this.cbind(v, obj.texcoords);
} else {
tofs = -1;
oofs = -1;
}
obj.alias = alias;
if (typeof obj.userAttributes !== "undefined") {
obj.userAttribOffsets = {};
obj.userAttribLocations = {};
obj.userAttribSizes = {};
for (attr in obj.userAttributes) {
obj.userAttribLocations[attr] = gl.getAttribLocation(obj.prog, attr);
if (obj.userAttribLocations[attr] >= 0) { // Attribute may not have been used
obj.userAttribOffsets[attr] = stride;
v = this.cbind(v, obj.userAttributes[attr]);
stride = v[0].length;
obj.userAttribSizes[attr] = stride - obj.userAttribOffsets[attr];
}
}
}
if (typeof obj.userUniforms !== "undefined") {
obj.userUniformLocations = {};
for (attr in obj.userUniforms)
obj.userUniformLocations[attr] = gl.getUniformLocation(obj.prog, attr);
}
if (sprites_3d) {
obj.userMatrix = new CanvasMatrix4(obj.userMatrix);
obj.objects = this.flatten([].concat(obj.ids));
is_lit = false;
for (i=0; i < obj.objects.length; i++)
this.initObj(obj.objects[i]);
}
if (is_lit && !fixed_quads) {
obj.normLoc = gl.getAttribLocation(obj.prog, "aNorm");
}
nclipplanes = this.countClipplanes();
if (nclipplanes && !sprites_3d) {
obj.clipLoc = [];
for (i=0; i < nclipplanes; i++)
obj.clipLoc[i] = gl.getUniformLocation(obj.prog,"vClipplane" + i);
}
if (is_lit) {
obj.emissionLoc = gl.getUniformLocation(obj.prog, "emission");
obj.emission = new Float32Array(this.stringToRgb(this.getMaterial(id, "emission")));
obj.shininessLoc = gl.getUniformLocation(obj.prog, "shininess");
obj.shininess = this.getMaterial(id, "shininess");
obj.nlights = this.countLights();
obj.ambientLoc = [];
obj.ambient = new Float32Array(this.stringToRgb(this.getMaterial(id, "ambient")));
obj.specularLoc = [];
obj.specular = new Float32Array(this.stringToRgb(this.getMaterial(id, "specular")));
obj.diffuseLoc = [];
obj.lightDirLoc = [];
obj.viewpointLoc = [];
obj.finiteLoc = [];
for (i=0; i < obj.nlights; i++) {
obj.ambientLoc[i] = gl.getUniformLocation(obj.prog, "ambient" + i);
obj.specularLoc[i] = gl.getUniformLocation(obj.prog, "specular" + i);
obj.diffuseLoc[i] = gl.getUniformLocation(obj.prog, "diffuse" + i);
obj.lightDirLoc[i] = gl.getUniformLocation(obj.prog, "lightDir" + i);
obj.viewpointLoc[i] = gl.getUniformLocation(obj.prog, "viewpoint" + i);
obj.finiteLoc[i] = gl.getUniformLocation(obj.prog, "finite" + i);
}
}
obj.passes = is_twosided + 1;
obj.pmode = new Array(obj.passes);
for (pass = 0; pass < obj.passes; pass++) {
if (type === "triangles" || type === "quads" || type === "surface")
pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
else pmode = "filled";
obj.pmode[pass] = pmode;
}
obj.f.length = obj.passes;
for (pass = 0; pass < obj.passes; pass++) {
f = fnew = obj.f[pass];
pmode = obj.pmode[pass];
if (pmode === "culled")
f = [];
else if (pmode === "points") {
// stay with default
} else if ((type === "quads" || type === "text" ||
type === "sprites") && !sprites_3d) {
nrows = Math.floor(obj.vertexCount/4);
if (pmode === "filled") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[4*i];
fnew[6*i+1] = f[4*i + 1];
fnew[6*i+2] = f[4*i + 2];
fnew[6*i+3] = f[4*i];
fnew[6*i+4] = f[4*i + 2];
fnew[6*i+5] = f[4*i + 3];
}
} else {
fnew = Array(8*nrows);
for (i=0; i < nrows; i++) {
fnew[8*i] = f[4*i];
fnew[8*i+1] = f[4*i + 1];
fnew[8*i+2] = f[4*i + 1];
fnew[8*i+3] = f[4*i + 2];
fnew[8*i+4] = f[4*i + 2];
fnew[8*i+5] = f[4*i + 3];
fnew[8*i+6] = f[4*i + 3];
fnew[8*i+7] = f[4*i];
}
}
} else if (type === "triangles") {
nrows = Math.floor(obj.vertexCount/3);
if (pmode === "filled") {
fnew = Array(3*nrows);
for (i=0; i < fnew.length; i++) {
fnew[i] = f[i];
}
} else if (pmode === "lines") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[3*i];
fnew[6*i + 1] = f[3*i + 1];
fnew[6*i + 2] = f[3*i + 1];
fnew[6*i + 3] = f[3*i + 2];
fnew[6*i + 4] = f[3*i + 2];
fnew[6*i + 5] = f[3*i];
}
}
} else if (type === "spheres") {
// default
} else if (type === "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
if (pmode === "filled") {
fnew = [];
for (j=0; j<nx-1; j++) {
for (i=0; i<nz-1; i++) {
fnew.push(f[j + nx*i],
f[j + nx*(i+1)],
f[j + 1 + nx*(i+1)],
f[j + nx*i],
f[j + 1 + nx*(i+1)],
f[j + 1 + nx*i]);
}
}
} else if (pmode === "lines") {
fnew = [];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz)
fnew.push(f[j + nx*i],
f[j + nx*(i+1)]);
if (j+1 < nx)
fnew.push(f[j + nx*i],
f[j+1 + nx*i]);
}
}
}
}
obj.f[pass] = fnew;
if (depth_sort) {
drawtype = "DYNAMIC_DRAW";
} else {
drawtype = "STATIC_DRAW";
}
}
if (fat_lines) {
alias = undefined;
obj.nextLoc = gl.getAttribLocation(obj.prog, "aNext");
obj.pointLoc = gl.getAttribLocation(obj.prog, "aPoint");
obj.aspectLoc = gl.getUniformLocation(obj.prog, "uAspect");
obj.lwdLoc = gl.getUniformLocation(obj.prog, "uLwd");
// Expand vertices to turn each segment into a pair of triangles
for (pass = 0; pass < obj.passes; pass++) {
f = obj.f[pass];    
oldrows = f.length;
if (obj.pmode[pass] === "lines") 
break;
}
if (type === "linestrip") 
nrows = 4*(oldrows - 1); 
else
nrows = 2*oldrows;
vnew = new Array(nrows);
fnew = new Array(1.5*nrows);
var fnext = new Array(nrows),
fpt = new Array(nrows), 
pt, start, gap = type === "linestrip" ? 3 : 1;
// We're going to turn each pair of vertices into 4 new ones, with the "next" and "pt" attributes
// added.
// We do this by copying the originals in the first pass, adding the new attributes, then in a 
// second pass add new vertices at the end.
for (i = 0; i < v.length; i++) {
vnew[i] = v[i].concat([0,0,0,0,0]); 
}
nextofs = stride;
pointofs = stride + 3;
stride = stride + 5;
// Now add the extras
last = v.length - 1;
ind = 0;
alias = new Array(f.length);
for (i = 0; i < f.length; i++)
alias[i] = [];
for (i = 0; i < f.length - 1; i++) {
if (type !== "linestrip" && i % 2 == 1)
continue;
k = ++last;
vnew[k] = vnew[f[i]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i+1]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = -1;
fnew[ind] = k;
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+1] = last;
alias[f[i]].push(last-1, last);
last++;
k = last;
vnew[k] = vnew[f[i+1]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = 1;
fnew[ind+2] = k;
fnew[ind+3] = fnew[ind+1];
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+4] = last;
fnew[ind+5] = fnew[ind+2];
ind += 6;
alias[f[i+1]].push(last-1, last);
}
vnew.length = last+1;
v = vnew;
obj.vertexCount = v.length;
if (typeof alias !== "undefined" && typeof obj.alias !== "undefined") {  // Already have aliases from previous section?
var oldalias = obj.alias, newalias = Array(obj.alias.length);
for (i = 0; i < newalias.length; i++) {
newalias[i] = oldalias[i].slice();
for (j = 0; j < oldalias[i].length; j++)
Array.prototype.push.apply(newalias[i], alias[oldalias[j]]); // pushes each element 
}
obj.alias = newalias;
} else
obj.alias = alias;
for (pass = 0; pass < obj.passes; pass++)
if (type === "lines" || type === "linestrip" || obj.pmode[pass] == "lines") {
obj.f[pass] = fnew;
}
if (depth_sort) 
drawtype = "DYNAMIC_DRAW";
else
drawtype = "STATIC_DRAW";
}
for (pass = 0; pass < obj.passes; pass++) {
if (obj.vertexCount > 65535) {
if (this.index_uint) {
obj.f[pass] = new Uint32Array(obj.f[pass]);
obj.index_uint = true;
} else
this.alertOnce("Object has "+obj.vertexCount+" vertices, not supported in this browser.");
} else {
obj.f[pass] = new Uint16Array(obj.f[pass]);
obj.index_uint = false;
}
}
if (stride !== v[0].length) {
this.alertOnce("problem in stride calculation");
}
obj.vOffsets = {vofs:0, cofs:cofs, nofs:nofs, radofs:radofs, oofs:oofs, tofs:tofs,
nextofs:nextofs, pointofs:pointofs, stride:stride};
obj.values = new Float32Array(this.flatten(v));
if (type !== "spheres" && !sprites_3d) {
obj.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW); //
obj.ibuf = Array(obj.passes);
obj.ibuf[0] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[0]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[0], gl[drawtype]);
if (is_twosided) {
obj.ibuf[1] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[1]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[1], gl[drawtype]);
}
}
if (!sprites_3d) {
obj.mvMatLoc = gl.getUniformLocation(obj.prog, "mvMatrix");
obj.prMatLoc = gl.getUniformLocation(obj.prog, "prMatrix");
}
if (fixed_size) {
obj.textScaleLoc = gl.getUniformLocation(obj.prog, "textScale");
}
if (is_lit && !sprites_3d) {
obj.normMatLoc = gl.getUniformLocation(obj.prog, "normMatrix");
}
if (is_twosided) {
obj.frontLoc = gl.getUniformLocation(obj.prog, "front");
}
};
/**
* Set gl depth test based on object's material
* @param { number } id - object to use
*/
rglwidgetClass.prototype.setDepthTest = function(id) {
var gl = this.gl || this.initGL(),
tests = {never: gl.NEVER,
less:  gl.LESS,
equal: gl.EQUAL,
lequal:gl.LEQUAL,
greater: gl.GREATER,
notequal: gl.NOTEQUAL,
gequal: gl.GEQUAL,
always: gl.ALWAYS},
test = tests[this.getMaterial(id, "depth_test")];
gl.depthFunc(test);
};
rglwidgetClass.prototype.mode4type = {points : "POINTS",
linestrip : "LINE_STRIP",
abclines : "LINES",
lines : "LINES",
sprites : "TRIANGLES",
planes : "TRIANGLES",
text : "TRIANGLES",
quads : "TRIANGLES",
surface : "TRIANGLES",
triangles : "TRIANGLES"};
/**
* Sort objects from back to front
* @returns { number[] }
* @param { Object } obj - object to sort
*/
rglwidgetClass.prototype.depthSort = function(obj) {
var n = obj.centers.length,
depths = new Float32Array(n),
result = new Array(n),
compare = function(i,j) { return depths[j] - depths[i]; },
z, w;
for(i=0; i<n; i++) {
z = this.prmvMatrix.m13*obj.centers[i][0] +
this.prmvMatrix.m23*obj.centers[i][1] +
this.prmvMatrix.m33*obj.centers[i][2] +
this.prmvMatrix.m43;
w = this.prmvMatrix.m14*obj.centers[i][0] +
this.prmvMatrix.m24*obj.centers[i][1] +
this.prmvMatrix.m34*obj.centers[i][2] +
this.prmvMatrix.m44;
depths[i] = z/w;
result[i] = i;
}
result.sort(compare);
return result;
};
rglwidgetClass.prototype.disableArrays = function(obj, enabled) {
var gl = this.gl || this.initGL(),
objLocs = ["normLoc", "texLoc", "ofsLoc", "pointLoc", "nextLoc"],
thisLocs = ["posLoc", "colLoc"], i, attr;
for (i = 0; i < objLocs.length; i++) 
if (enabled[objLocs[i]]) gl.disableVertexAttribArray(obj[objLocs[i]]);
for (i = 0; i < thisLocs.length; i++)
if (enabled[thisLocs[i]]) gl.disableVertexAttribArray(this[objLocs[i]]);
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.disableVertexAttribArray( obj.userAttribLocations[attr] );
}
}
}
/**
* Draw an object in a subscene
* @param { number } id - object to draw
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawObj = function(id, subsceneid) {
var obj = this.getObj(id),
subscene = this.getObj(subsceneid),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = flags & this.f_is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
is_points = flags & this.f_is_points,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
gl = this.gl || this.initGL(),
mat,
sphereMV, baseofs, ofs, sscale, i, count, light,
pass, mode, pmode, attr,
enabled = {};
if (typeof id !== "number") {
this.alertOnce("drawObj id is "+typeof id);
}
if (type === "planes") {
if (obj.bbox !== subscene.par3d.bbox || !obj.initialized) {
this.planeUpdateTriangles(id, subscene.par3d.bbox);
}
}
if (!obj.initialized)
this.initObj(id);
if (type === "clipplanes") {
count = obj.offsets.length;
var IMVClip = [];
for (i=0; i < count; i++) {
IMVClip[i] = this.multMV(this.invMatrix, obj.vClipplane.slice(4*i, 4*(i+1)));
}
obj.IMVClip = IMVClip;
return;
}
if (type === "light" || type === "bboxdeco" || !obj.vertexCount)
return;
if (!is_transparent &&
obj.someHidden) {
is_transparent = true;
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}        
this.setDepthTest(id);
if (sprites_3d) {
var norigs = obj.vertices.length,
savenorm = new CanvasMatrix4(this.normMatrix);
this.origs = obj.vertices;
this.usermat = new Float32Array(obj.userMatrix.getAsArray());
this.radii = obj.radii;
this.normMatrix = subscene.spriteNormmat;
for (this.iOrig=0; this.iOrig < norigs; this.iOrig++) {
for (i=0; i < obj.objects.length; i++) {
this.drawObj(obj.objects[i], subsceneid);
}
}
this.normMatrix = savenorm;
return;
} else {
gl.useProgram(obj.prog);
}
if (typeof obj.polygon_offset !== "undefined") {
gl.polygonOffset(obj.polygon_offset[0],
obj.polygon_offset[1]);
gl.enable(gl.POLYGON_OFFSET_FILL);
}
if (sprite_3d) {
gl.uniform3fv(obj.origLoc, new Float32Array(this.origs[this.iOrig]));
if (this.radii.length > 1) {
gl.uniform1f(obj.sizeLoc, this.radii[this.iOrig][0]);
} else {
gl.uniform1f(obj.sizeLoc, this.radii[0][0]);
}
gl.uniformMatrix4fv(obj.usermatLoc, false, this.usermat);
}
if (type === "spheres") {
gl.bindBuffer(gl.ARRAY_BUFFER, this.sphere.buf);
} else {
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
}
gl.uniformMatrix4fv( obj.prMatLoc, false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0,
clipplaneids = subscene.clipplanes,
clip, j;
for (i=0; i < clipplaneids.length; i++) {
clip = this.getObj(clipplaneids[i]);
for (j=0; j < clip.offsets.length; j++) {
gl.uniform4fv(obj.clipLoc[clipcheck + j], clip.IMVClip[j]);
}
clipcheck += clip.offsets.length;
}
if (typeof obj.clipLoc !== "undefined")
for (i=clipcheck; i < obj.clipLoc.length; i++)
gl.uniform4f(obj.clipLoc[i], 0,0,0,0);
if (is_lit) {
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(this.normMatrix.getAsArray()) );
gl.uniform3fv( obj.emissionLoc, obj.emission);
gl.uniform1f( obj.shininessLoc, obj.shininess);
for (i=0; i < subscene.lights.length; i++) {
light = this.getObj(subscene.lights[i]);
if (!light.initialized) this.initObj(subscene.lights[i]);
gl.uniform3fv( obj.ambientLoc[i], this.componentProduct(light.ambient, obj.ambient));
gl.uniform3fv( obj.specularLoc[i], this.componentProduct(light.specular, obj.specular));
gl.uniform3fv( obj.diffuseLoc[i], light.diffuse);
gl.uniform3fv( obj.lightDirLoc[i], light.lightDir);
gl.uniform1i( obj.viewpointLoc[i], light.viewpoint);
gl.uniform1i( obj.finiteLoc[i], light.finite);
}
for (i=subscene.lights.length; i < obj.nlights; i++) {
gl.uniform3f( obj.ambientLoc[i], 0,0,0);
gl.uniform3f( obj.specularLoc[i], 0,0,0);
gl.uniform3f( obj.diffuseLoc[i], 0,0,0);
}
}
if (fixed_size) {
gl.uniform2f( obj.textScaleLoc, 0.75/this.vp.width, 0.75/this.vp.height);
}
gl.enableVertexAttribArray( this.posLoc );
enabled.posLoc = true;
var nc = obj.colorCount;
count = obj.vertexCount;
if (type === "spheres") {
subscene = this.getObj(subsceneid);
var scale = subscene.par3d.scale,
scount = count, indices;
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.enableVertexAttribArray(obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.disableVertexAttribArray( this.colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(scale[0], scale[1], scale[2]);
sphereNorm.multRight(this.normMatrix);
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(sphereNorm.getAsArray()) );
if (nc == 1) {
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
}
if (has_texture) {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,
4*this.sphere.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (depth_sort)
indices = this.depthSort(obj);
for (i = 0; i < scount; i++) {
sphereMV = new CanvasMatrix4();
if (depth_sort) {
baseofs = indices[i]*obj.vOffsets.stride;
} else {
baseofs = i*obj.vOffsets.stride;
}
ofs = baseofs + obj.vOffsets.radofs;
sscale = obj.values[ofs];
sphereMV.scale(sscale/scale[0], sscale/scale[1], sscale/scale[2]);
sphereMV.translate(obj.values[baseofs],
obj.values[baseofs+1],
obj.values[baseofs+2]);
sphereMV.multRight(this.mvMatrix);
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(sphereMV.getAsArray()) );
if (nc > 1) {
ofs = baseofs + obj.vOffsets.cofs;
gl.vertexAttrib4f( this.colLoc, obj.values[ofs],
obj.values[ofs+1],
obj.values[ofs+2],
obj.values[ofs+3] );
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.sphere.ibuf);
gl.drawElements(gl.TRIANGLES, this.sphere.sphereCount, gl.UNSIGNED_SHORT, 0);
}
this.disableArrays(obj, enabled);
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
return;
} else {
if (obj.colorCount === 1) {
gl.disableVertexAttribArray( this.colLoc );
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
} else {
gl.enableVertexAttribArray( this.colLoc );
enabled.colLoc = true;
gl.vertexAttribPointer(this.colLoc, 4, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.cofs);
}
}
if (is_lit && obj.vOffsets.nofs > 0) {
gl.enableVertexAttribArray( obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nofs);
}
if (has_texture || type === "text") {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (fixed_quads) {
gl.enableVertexAttribArray( obj.ofsLoc );
enabled.ofsLoc = true;
gl.vertexAttribPointer(obj.ofsLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.oofs);
}
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.enableVertexAttribArray( obj.userAttribLocations[attr] );
gl.vertexAttribPointer( obj.userAttribLocations[attr], obj.userAttribSizes[attr],
gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.userAttribOffsets[attr]);
}
}
if (typeof obj.userUniforms !== "undefined") {
for (attr in obj.userUniformLocations) {
var loc = obj.userUniformLocations[attr];
if (loc !== null) {
var uniform = obj.userUniforms[attr];
if (typeof uniform.length === "undefined")
gl.uniform1f(loc, uniform);
else if (typeof uniform[0].length === "undefined") {
uniform = new Float32Array(uniform);
switch(uniform.length) {
case 2: gl.uniform2fv(loc, uniform); break;
case 3: gl.uniform3fv(loc, uniform); break;
case 4: gl.uniform4fv(loc, uniform); break;
default: console.warn("bad uniform length");
}
} else if (uniform.length == 4 && uniform[0].length == 4)
gl.uniformMatrix4fv(loc, false, new Float32Array(uniform.getAsArray()));
else
console.warn("unsupported uniform matrix");
}
}
}
for (pass = 0; pass < obj.passes; pass++) {
pmode = obj.pmode[pass];
if (pmode === "culled")
continue;
mode = fat_lines && (is_lines || pmode == "lines") ? "TRIANGLES" : this.mode4type[type];
if (depth_sort && pmode == "filled") {// Don't try depthsorting on wireframe or points
var faces = this.depthSort(obj),
nfaces = faces.length,
frowsize = Math.floor(obj.f[pass].length/nfaces);
if (type !== "spheres") {
var f = obj.index_uint ? new Uint32Array(obj.f[pass].length) : new Uint16Array(obj.f[pass].length);
for (i=0; i<nfaces; i++) {
for (j=0; j<frowsize; j++) {
f[frowsize*i + j] = obj.f[pass][frowsize*faces[i] + j];
}
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.DYNAMIC_DRAW);
}
}
if (is_twosided)
gl.uniform1i(obj.frontLoc, pass !== 0);
if (type !== "spheres") 
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
if (type === "sprites" || type === "text" || type === "quads") {
count = count * 6/4;
} else if (type === "surface") {
count = obj.f[pass].length;
}
count = obj.f[pass].length;
if (!is_lines && pmode === "lines" && !fat_lines) {
mode = "LINES";
} else if (pmode === "points") {
mode = "POINTS";
}
if ((is_lines || pmode === "lines") && fat_lines) {
gl.enableVertexAttribArray(obj.pointLoc);
enabled.pointLoc = true;
gl.vertexAttribPointer(obj.pointLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.pointofs);
gl.enableVertexAttribArray(obj.nextLoc );
enabled.nextLoc = true;
gl.vertexAttribPointer(obj.nextLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nextofs);
gl.uniform1f(obj.aspectLoc, this.vp.width/this.vp.height);
gl.uniform1f(obj.lwdLoc, this.getMaterial(id, "lwd")/this.vp.height);
}
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*obj.vOffsets.stride,  4*obj.vOffsets.vofs);
gl.drawElements(gl[mode], count, obj.index_uint ? gl.UNSIGNED_INT : gl.UNSIGNED_SHORT, 0);
this.disableArrays(obj, enabled);
}
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
};
/**
* Draw the background for a subscene
* @param { number } id - id of background object
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawBackground = function(id, subsceneid) {
var gl = this.gl || this.initGL(),
obj = this.getObj(id),
bg, i;
if (!obj.initialized)
this.initObj(id);
if (obj.colors.length) {
bg = obj.colors[0];
gl.clearColor(bg[0], bg[1], bg[2], bg[3]);
gl.depthMask(true);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
}
if (typeof obj.quad !== "undefined") {
this.prMatrix.makeIdentity();
this.mvMatrix.makeIdentity();
gl.disable(gl.BLEND);
gl.disable(gl.DEPTH_TEST);
gl.depthMask(false);
for (i=0; i < obj.quad.length; i++)
this.drawObj(obj.quad[i], subsceneid);
}
};
/**
* Draw a subscene
* @param { number } subsceneid - id of subscene
* @param { boolean } opaquePass - is this the opaque drawing pass?
*/
rglwidgetClass.prototype.drawSubscene = function(subsceneid, opaquePass) {
var gl = this.gl || this.initGL(),
sub = this.getObj(subsceneid),
objects = this.scene.objects,
subids = sub.objects,
subscene_has_faces = false,
subscene_needs_sorting = false,
flags, i, obj;
if (sub.par3d.skipRedraw)
return;
for (i=0; i < subids.length; i++) {
obj = objects[subids[i]];
flags = obj.flags;
if (typeof flags !== "undefined") {
subscene_has_faces |= (flags & this.f_is_lit)
& !(flags & this.f_fixed_quads);
obj.is_transparent = (flags & this.f_is_transparent) || obj.someHidden;
subscene_needs_sorting |= (flags & this.f_depth_sort) || obj.is_transparent;
}
}
this.setViewport(subsceneid);
if (typeof sub.backgroundId !== "undefined" && opaquePass)
this.drawBackground(sub.backgroundId, subsceneid);
if (subids.length) {
this.setprMatrix(subsceneid);
this.setmvMatrix(subsceneid);
if (subscene_has_faces) {
this.setnormMatrix(subsceneid);
if ((sub.flags & this.f_sprites_3d) &&
typeof sub.spriteNormmat === "undefined") {
sub.spriteNormmat = new CanvasMatrix4(this.normMatrix);
}
}
if (subscene_needs_sorting)
this.setprmvMatrix();
var clipids = sub.clipplanes;
if (typeof clipids === "undefined") {
console.warn("bad clipids");
}
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < clipids.length; i++)
this.drawObj(clipids[i], subsceneid);
}
subids = sub.opaque.concat(sub.transparent);
if (opaquePass) {
gl.enable(gl.DEPTH_TEST);
gl.depthMask(true);
gl.disable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (!this.getObj(subids[i]).is_transparent) 
this.drawObj(subids[i], subsceneid);
}
} else {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (this.getObj(subids[i]).is_transparent)
this.drawObj(subids[i], subsceneid);
}
}
subids = sub.subscenes;
for (i = 0; i < subids.length; i++) {
this.drawSubscene(subids[i], opaquePass);
}
}
};
/**
* Respond to brush change
*/
rglwidgetClass.prototype.selectionChanged = function() {
var i, j, k, id, subid = this.select.subscene, subscene,
objids, obj,
p1 = this.select.region.p1, p2 = this.select.region.p2,
filter, selection = [], handle, keys, xmin, x, xmax, ymin, y, ymax, z, v,
someHidden;
if (!subid)
return;
subscene = this.getObj(subid);
objids = subscene.objects;
filter = this.scene.crosstalk.filter;
this.setmvMatrix(subid);
this.setprMatrix(subid);
this.setprmvMatrix();
xmin = Math.min(p1.x, p2.x);
xmax = Math.max(p1.x, p2.x);
ymin = Math.min(p1.y, p2.y);
ymax = Math.max(p1.y, p2.y);
for (i = 0; i < objids.length; i++) {
id = objids[i];
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
keys = this.scene.crosstalk.key[j];
obj = this.getObj(id);
someHidden = false;
for (k = 0; k < keys.length; k++) {
if (filter && filter.indexOf(keys[k]) < 0) {
someHidden = true;
continue;
}
v = [].concat(obj.vertices[k]).concat(1.0);
v = this.multVM(v, this.prmvMatrix);
x = v[0]/v[3];
y = v[1]/v[3];
z = v[2]/v[3];
if (xmin <= x && x <= xmax && ymin <= y && y <= ymax && -1.0 <= z && z <= 1.0) {
selection.push(keys[k]);
} else
someHidden = true;
}
obj.someHidden = someHidden && (filter || selection.length);
obj.initialized = false;
/* Who should we notify?  Only shared data in the current subscene, or everyone? */
if (!this.equalArrays(selection, this.scene.crosstalk.selection)) {
handle = this.scene.crosstalk.sel_handle[j];
handle.set(selection, {rglSubsceneId: this.select.subscene});
}
}
}
};
/**
* Respond to selection or filter change from crosstalk
* @param { Object } event - crosstalk event
* @param { boolean } filter - filter or selection?
*/
rglwidgetClass.prototype.selection = function(event, filter) {
var i, j, ids, obj, keys, crosstalk = this.scene.crosstalk,
selection, someHidden;
// Record the message and find out if this event makes some objects have mixed values:
crosstalk = this.scene.crosstalk;
if (filter) {
filter = crosstalk.filter = event.value;
selection = crosstalk.selection;
} else {  
selection = crosstalk.selection = event.value;
filter = crosstalk.filter;
}
ids = crosstalk.id;
for (i = 0; i < ids.length ; i++) {
obj = this.getObj(ids[i]);
obj.initialized = false;
keys = crosstalk.key[i];
someHidden = false;
for (j = 0; j < keys.length && !someHidden; j++) {
if ((filter && filter.indexOf(keys[j]) < 0) ||
(selection.length && selection.indexOf(keys[j]) < 0))
someHidden = true;
}
obj.someHidden = someHidden;
}
this.drawScene();
};
/**
* Clear the selection brush
* @param { number } except - Subscene that should ignore this request
*/
rglwidgetClass.prototype.clearBrush = function(except) {
if (this.select.subscene != except) {
this.select.state = "inactive";
this.delFromSubscene(this.scene.brushId, this.select.subscene);
}
this.drawScene();
};
/**
* Compute mouse coordinates relative to current canvas
* @returns { Object }
* @param { Object } event - event object from mouse click
*/
rglwidgetClass.prototype.relMouseCoords = function(event) {
var totalOffsetX = 0,
totalOffsetY = 0,
currentElement = this.canvas;
do {
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
currentElement = currentElement.offsetParent;
}
while(currentElement);
var canvasX = event.pageX - totalOffsetX,
canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY};
};
/**
* Set mouse handlers for the scene
*/
rglwidgetClass.prototype.setMouseHandlers = function() {
var self = this, activeSubscene, handler,
handlers = {}, drag = 0;
handlers.rotBase = 0;
this.screenToVector = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
radius = Math.max(width, height)/2.0,
cx = width/2.0,
cy = height/2.0,
px = (x-cx)/radius,
py = (y-cy)/radius,
plen = Math.sqrt(px*px+py*py);
if (plen > 1.e-6) {
px = px/plen;
py = py/plen;
}
var angle = (Math.SQRT2 - plen)/Math.SQRT2*Math.PI/2,
z = Math.sin(angle),
zlen = Math.sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
};
handlers.trackballdown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.rotBase = this.screenToVector(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.trackballmove = function(x,y) {
var rotCurrent = this.screenToVector(x,y),
rotBase = handlers.rotBase,
dot = rotBase[0]*rotCurrent[0] +
rotBase[1]*rotCurrent[1] +
rotBase[2]*rotCurrent[2],
angle = Math.acos( dot/this.vlen(rotBase)/this.vlen(rotCurrent) )*180.0/Math.PI,
axis = this.xprod(rotBase, rotCurrent),
objects = this.scene.objects,
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
l = activeModel.par3d.listeners,
i;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
}
this.drawScene();
};
handlers.trackballend = 0;
this.clamp = function(x, lo, hi) {
return Math.max(lo, Math.min(x, hi));
};
this.screenToPolar = function(x,y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
r = Math.min(width, height)/2,
dx = this.clamp(x - width/2, -r, r),
dy = this.clamp(y - height/2, -r, r);
return [Math.asin(dx/r), Math.asin(-dy/r)];
};
handlers.polardown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.dragBase = this.screenToPolar(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
activeSub.camBase = [-Math.atan2(activeSub.saveMat.m13, activeSub.saveMat.m11),
Math.atan2(activeSub.saveMat.m32, activeSub.saveMat.m22)];
}
};
handlers.polarmove = function(x,y) {
var dragCurrent = this.screenToPolar(x,y),
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
objects = this.scene.objects,
l = activeModel.par3d.listeners,
i, changepos = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
for (j=0; j<2; j++)
changepos[j] = -(dragCurrent[j] - handlers.dragBase[j]);
activeSub.par3d.userMatrix.makeIdentity();
activeSub.par3d.userMatrix.rotate(changepos[0]*180/Math.PI, 0,-1,0);
activeSub.par3d.userMatrix.multRight(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(changepos[1]*180/Math.PI, -1,0,0);
}
this.drawScene();
};
handlers.polarend = 0;
handlers.axisdown = function(x,y) {
handlers.rotBase = this.screenToVector(x, this.canvas.height/2);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.axismove = function(x,y) {
var rotCurrent = this.screenToVector(x, this.canvas.height/2),
rotBase = handlers.rotBase,
angle = (rotCurrent[0] - rotBase[0])*180/Math.PI,
rotMat = new CanvasMatrix4();
rotMat.rotate(angle, handlers.axis[0], handlers.axis[1], handlers.axis[2]);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(activeSub.saveMat);
activeSub.par3d.userMatrix.multLeft(rotMat);
}
this.drawScene();
};
handlers.axisend = 0;
handlers.y0zoom = 0;
handlers.zoom0 = 0;
handlers.zoomdown = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
handlers.y0zoom = y;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.zoom0 = Math.log(activeSub.par3d.zoom);
}
};
handlers.zoommove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.zoom = Math.exp(activeSub.zoom0 + (y-handlers.y0zoom)/this.canvas.height);
}
this.drawScene();
};
handlers.zoomend = 0;
handlers.y0fov = 0;
handlers.fovdown = function(x, y) {
handlers.y0fov = y;
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.fov0 = activeSub.par3d.FOV;
}
};
handlers.fovmove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.FOV = Math.max(1, Math.min(179, activeSub.fov0 +
180*(y-handlers.y0fov)/this.canvas.height));
}
this.drawScene();
};
handlers.fovend = 0;
handlers.selectingdown = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height, 
p = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
this.select.region = {p1: p, p2: p};
if (this.select.subscene && this.select.subscene != activeSubscene)
this.delFromSubscene(this.scene.brushId, this.select.subscene);
this.select.subscene = activeSubscene;
this.addToSubscene(this.scene.brushId, activeSubscene);
this.select.state = "changing";
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingmove = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height;
if (this.select.state === "inactive") 
return;
this.select.region.p2 = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingend = 0;
this.canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1:
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ["left", "middle", "right"][ev.which-1];
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height-coords.y;
activeSubscene = self.whichSubscene(coords);
var sub = self.getObj(activeSubscene), f;
handler = sub.par3d.mouseMode[drag];
switch (handler) {
case "xAxis":
handler = "axis";
handlers.axis = [1.0, 0.0, 0.0];
break;
case "yAxis":
handler = "axis";
handlers.axis = [0.0, 1.0, 0.0];
break;
case "zAxis":
handler = "axis";
handlers.axis = [0.0, 0.0, 1.0];
break;
}
f = handlers[handler + "down"];
if (f) {
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
ev.preventDefault();
} else
console.warn("Mouse handler '" + handler + "' is not implemented.");
};
this.canvas.onmouseup = function ( ev ){
if ( drag === 0 ) return;
var f = handlers[handler + "end"];
if (f) {
f.call(self);
ev.preventDefault();
}
drag = 0;
};
this.canvas.onmouseout = this.canvas.onmouseup;
this.canvas.onmousemove = function ( ev ) {
if ( drag === 0 ) return;
var f = handlers[handler + "move"];
if (f) {
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height - coords.y;
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
}
};
handlers.wheelHandler = function(ev) {
var del = 1.02, i;
if (ev.shiftKey) del = 1.002;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
if (typeof activeSubscene === "undefined")
activeSubscene = self.scene.rootSubscene;
var activeSub = self.getObj(activeSubscene),
activeProjection = self.getObj(self.useid(activeSub.id, "projection")),
l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = self.getObj(l[i]);
activeSub.par3d.zoom *= ds;
}
self.drawScene();
ev.preventDefault();
};
this.canvas.addEventListener("DOMMouseScroll", handlers.wheelHandler, false);
this.canvas.addEventListener("mousewheel", handlers.wheelHandler, false);
};
/**
* Find a particular subscene by inheritance
* @returns { number } id of subscene to use
* @param { number } subsceneid - child subscene
* @param { string } type - type of inheritance:  "projection" or "model"
*/
rglwidgetClass.prototype.useid = function(subsceneid, type) {
var sub = this.getObj(subsceneid);
if (sub.embeddings[type] === "inherit")
return(this.useid(sub.parent, type));
else
return subsceneid;
};
/**
* Check whether point is in viewport of subscene
* @returns {boolean}
* @param { Object } coords - screen coordinates of point
* @param { number } subsceneid - subscene to check
*/
rglwidgetClass.prototype.inViewport = function(coords, subsceneid) {
var viewport = this.getObj(subsceneid).par3d.viewport,
x0 = coords.x - viewport.x*this.canvas.width,
y0 = coords.y - viewport.y*this.canvas.height;
return 0 <= x0 && x0 <= viewport.width*this.canvas.width &&
0 <= y0 && y0 <= viewport.height*this.canvas.height;
};
/**
* Find which subscene contains a point
* @returns { number } subscene id
* @param { Object } coords - coordinates of point
*/
rglwidgetClass.prototype.whichSubscene = function(coords) {
var self = this,
recurse = function(subsceneid) {
var subscenes = self.getChildSubscenes(subsceneid), i, id;
for (i=0; i < subscenes.length; i++) {
id = recurse(subscenes[i]);
if (typeof(id) !== "undefined")
return(id);
}
if (self.inViewport(coords, subsceneid))
return(subsceneid);
else
return undefined;
},
rootid = this.scene.rootSubscene,
result = recurse(rootid);
if (typeof(result) === "undefined")
result = rootid;
return result;
};
/**
* Translate from window coordinates to viewport coordinates
* @returns { Object } translated coordinates
* @param { number } subsceneid - which subscene to use?
* @param { Object } coords - point to translate
*/
rglwidgetClass.prototype.translateCoords = function(subsceneid, coords) {
var viewport = this.getObj(subsceneid).par3d.viewport;
return {x: coords.x - viewport.x*this.canvas.width,
y: coords.y - viewport.y*this.canvas.height};
};
/**
* Initialize the sphere object
*/
rglwidgetClass.prototype.initSphere = function() {
var verts = this.scene.sphereVerts,
reuse = verts.reuse, result;
if (typeof reuse !== "undefined") {
var prev = document.getElementById(reuse).rglinstance.sphere;
result = {values: prev.values, vOffsets: prev.vOffsets, it: prev.it};
} else
result = {values: new Float32Array(this.flatten(this.cbind(this.transpose(verts.vb),
this.transpose(verts.texcoords)))),
it: new Uint16Array(this.flatten(this.transpose(verts.it))),
vOffsets: {vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1,
tofs:3, nextofs:-1, pointofs:-1, stride:5}};
result.sphereCount = result.it.length;
this.sphere = result;
};
/**
* Set the vertices in the selection box object
*/
rglwidgetClass.prototype.initSelection = function(id) {
if (typeof this.select.region === "undefined")
return;
var obj = this.getObj(id),
width = this.canvas.width,
height = this.canvas.height, 
p1 = this.select.region.p1,
p2 = this.select.region.p2;
obj.vertices = [[p1.x, p1.y, 0.0],
[p2.x, p1.y, 0.0],
[p2.x, p2.y, 0.0],
[p1.x, p2.y, 0.0],
[p1.x, p1.y, 0.0]];
};
/**
* Do the gl part of initializing the sphere
*/
rglwidgetClass.prototype.initSphereGL = function() {
var gl = this.gl || this.initGL(), sphere = this.sphere;
if (gl.isContextLost()) return;
sphere.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphere.buf);
gl.bufferData(gl.ARRAY_BUFFER, sphere.values, gl.STATIC_DRAW);
sphere.ibuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphere.ibuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, sphere.it, gl.STATIC_DRAW);
return;
};
/**
* Initialize the DOM object
* @param { Object } el - the DOM object
* @param { Object } x - the scene data sent by JSON from R
*/
rglwidgetClass.prototype.initialize = function(el, x) {
this.textureCanvas = document.createElement("canvas");
this.textureCanvas.style.display = "block";
this.scene = x;
this.normMatrix = new CanvasMatrix4();
this.saveMat = {};
this.distance = null;
this.posLoc = 0;
this.colLoc = 1;
if (el) {
el.rglinstance = this;
this.el = el;
this.webGLoptions = el.rglinstance.scene.webGLoptions;
this.initCanvas();
}
if (typeof Shiny !== "undefined") {
var self = this;
Shiny.addCustomMessageHandler("shinyGetPar3d",
function(message) {
var i, param, 
subscene = self.getObj(message.subscene),
parameters = [].concat(message.parameters),
result = {tag: message.tag, subscene: message.subscene};
if (typeof subscene !== "undefined") {
for (i = 0; i < parameters.length; i++) {
param = parameters[i];
result[param] = subscene.par3d[param];
};
} else {
console.log("subscene "+message.subscene+" undefined.")
}
Shiny.setInputValue("par3d:shinyPar3d", result, {priority: "event"});
});
Shiny.addCustomMessageHandler("shinySetPar3d",
function(message) {
var param = message.parameter, 
subscene = self.getObj(message.subscene);
if (typeof subscene !== "undefined") {
subscene.par3d[param] = message.value;
subscene.initialized = false;
self.drawScene();
} else {
console.log("subscene "+message.subscene+" undefined.")
}
})
}
};
/**
* Restart the WebGL canvas
*/
rglwidgetClass.prototype.restartCanvas = function() {
var newcanvas = document.createElement("canvas"),
self = this;
newcanvas.width = this.el.width;
newcanvas.height = this.el.height;
newcanvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
newcanvas.addEventListener("webglcontextlost",
this.onContextLost, false);
while (this.el.firstChild) {
this.el.removeChild(this.el.firstChild);
}
this.el.appendChild(newcanvas);
this.canvas = newcanvas;
this.setMouseHandlers();
if (this.gl) 
Object.keys(this.scene.objects).forEach(function(key){
self.getObj(parseInt(key, 10)).texture = undefined; 
});
this.gl = null;
};
/**
* Initialize the WebGL canvas
*/
rglwidgetClass.prototype.initCanvas = function() {
this.restartCanvas();
var objs = this.scene.objects,
self = this;
Object.keys(objs).forEach(function(key){
var id = parseInt(key, 10),
obj = self.getObj(id);
if (typeof obj.reuse !== "undefined")
self.copyObj(id, obj.reuse);
});
Object.keys(objs).forEach(function(key){
self.initSubscene(parseInt(key, 10));
});
this.setMouseHandlers();
this.initSphere();
this.onContextRestored = function(event) {
self.initGL();
self.drawScene();
};
this.onContextLost = function(event) {
if (!self.drawing)
this.gl = null;
event.preventDefault();
};
this.initGL0();
this.lazyLoadScene = function() {
if (typeof self.slide === "undefined")
self.slide = self.getSlide();
if (self.isInBrowserViewport()) {
if (!self.gl || self.gl.isContextLost())
self.initGL();
self.drawScene();
}
};
window.addEventListener("DOMContentLoaded", this.lazyLoadScene, false);
window.addEventListener("load", this.lazyLoadScene, false);
window.addEventListener("resize", this.lazyLoadScene, false);
window.addEventListener("scroll", this.lazyLoadScene, false);
this.slide = this.getSlide();
if (this.slide) {
if (typeof this.slide.rgl === "undefined")
this.slide.rgl = [this];
else
this.slide.rgl.push(this);
if (this.scene.context.rmarkdown) 
if (this.scene.context.rmarkdown === "ioslides_presentation") {
this.slide.setAttribute("slideenter", "this.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window);})");
} else if (this.scene.context.rmarkdown === "slidy_presentation") {
// This method would also work in ioslides, but it gets triggered
// something like 5 times per slide for every slide change, so
// you'd need a quicker function than lazyLoadScene.
var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver,
observer = new MutationObserver(function(mutations) {
mutations.forEach(function(mutation) {
self.slide.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window); });});});
observer.observe(this.slide, { attributes: true, attributeFilter:["class"] });
}
}
};
/**
* Start the writeWebGL scene. This is only used by writeWebGL; rglwidget has
no debug element and does the drawing in rglwidget.js.
*/
rglwidgetClass.prototype.start = function() {
if (typeof this.prefix !== "undefined") {
this.debugelement = document.getElementById(this.prefix + "debug");
this.debug("");
}
this.drag = 0;
this.drawScene();
};
/**
* Display a debug message
* @param { string } msg - The message to display
* @param { Object } [img] - Image to insert before message
*/
rglwidgetClass.prototype.debug = function(msg, img) {
if (typeof this.debugelement !== "undefined" && this.debugelement !== null) {
this.debugelement.innerHTML = msg;
if (typeof img !== "undefined") {
this.debugelement.insertBefore(img, this.debugelement.firstChild);
}
} else if (msg !== "")
alert(msg);
};
/**
* Get the snapshot image of this scene
* @returns { Object } The img DOM element
*/
rglwidgetClass.prototype.getSnapshot = function() {
var img;
if (typeof this.scene.snapshot !== "undefined") {
img = document.createElement("img");
img.src = this.scene.snapshot;
img.alt = "Snapshot";
}
return img;
};
/**
* Initial test for WebGL
*/
rglwidgetClass.prototype.initGL0 = function() {
if (!window.WebGLRenderingContext){
alert("Your browser does not support WebGL. See http://get.webgl.org");
return;
}
};
/**
* If we are in an ioslides or slidy presentation, get the
* DOM element of the current slide
* @returns { Object }
*/
rglwidgetClass.prototype.getSlide = function() {
var result = this.el, done = false;
while (result && !done && this.scene.context.rmarkdown) {
switch(this.scene.context.rmarkdown) {
case "ioslides_presentation":
if (result.tagName === "SLIDE") return result;
break;
case "slidy_presentation":
if (result.tagName === "DIV" && result.classList.contains("slide"))
return result;
break;
default: return null;
}
result = result.parentElement;
}
return null;
};
/**
* Is this scene visible in the browser?
* @returns { boolean }
*/
rglwidgetClass.prototype.isInBrowserViewport = function() {
var rect = this.canvas.getBoundingClientRect(),
windHeight = (window.innerHeight || document.documentElement.clientHeight),
windWidth = (window.innerWidth || document.documentElement.clientWidth);
if (this.scene.context && this.scene.context.rmarkdown !== null) {
if (this.slide)
return (this.scene.context.rmarkdown === "ioslides_presentation" &&
this.slide.classList.contains("current")) ||
(this.scene.context.rmarkdown === "slidy_presentation" &&
!this.slide.classList.contains("hidden"));
}
return (
rect.top >= -windHeight &&
rect.left >= -windWidth &&
rect.bottom <= 2*windHeight &&
rect.right <= 2*windWidth);
};
/**
* Initialize WebGL
* @returns { Object } the WebGL context
*/
rglwidgetClass.prototype.initGL = function() {
var self = this;
if (this.gl) {
if (!this.drawing && this.gl.isContextLost())
this.restartCanvas();
else
return this.gl;
}
// if (!this.isInBrowserViewport()) return; Return what??? At this point we know this.gl is null.
this.canvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
this.canvas.addEventListener("webglcontextlost",
this.onContextLost, false);
this.gl = this.canvas.getContext("webgl", this.webGLoptions) ||
this.canvas.getContext("experimental-webgl", this.webGLoptions);
this.index_uint = this.gl.getExtension("OES_element_index_uint");
var save = this.startDrawing();
this.initSphereGL();
Object.keys(this.scene.objects).forEach(function(key){
self.initObj(parseInt(key, 10));
});
this.stopDrawing(save);
return this.gl;
};
/**
* Resize the display to match element
* @param { Object } el - DOM element to match
*/
rglwidgetClass.prototype.resize = function(el) {
this.canvas.width = el.width;
this.canvas.height = el.height;
};
/**
* Draw the whole scene
*/
rglwidgetClass.prototype.drawScene = function() {
var gl = this.gl || this.initGL(),
wasDrawing = this.startDrawing();
if (!wasDrawing) {
if (this.select.state !== "inactive")
this.selectionChanged();
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1,1,1,1);
gl.depthMask(true); // Must be true before clearing depth buffer
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.drawSubscene(this.scene.rootSubscene, true);
this.drawSubscene(this.scene.rootSubscene, false);
}
this.stopDrawing(wasDrawing);
};
/**
* Change the displayed subset
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The subset control data.
*/
rglwidgetClass.prototype.subsetSetter = function(el, control) {
if (typeof control.subscenes === "undefined" ||
control.subscenes === null)
control.subscenes = this.scene.rootSubscene;
var value = Math.round(control.value),
subscenes = [].concat(control.subscenes),
fullset = [].concat(control.fullset),
i, j, entries, subsceneid,
adds = [], deletes = [],
ismissing = function(x) {
return fullset.indexOf(x) < 0;
},
tointeger = function(x) {
return parseInt(x, 10);
};
if (isNaN(value))
value = control.value = 0;
if (control.accumulate)
for (i=0; i <= value; i++)
adds = adds.concat(control.subsets[i]);
else
adds = adds.concat(control.subsets[value]);
deletes = fullset.filter(function(x) { return adds.indexOf(x) < 0; });
for (i = 0; i < subscenes.length; i++) {
subsceneid = subscenes[i];
if (typeof this.getObj(subsceneid) === "undefined")
this.alertOnce("typeof object is undefined");
for (j = 0; j < adds.length; j++)
this.addToSubscene(adds[j], subsceneid);
for (j = 0; j < deletes.length; j++)
this.delFromSubscene(deletes[j], subsceneid);
}
};
/**
* Change the requested property
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The property setter control data.
*/
rglwidgetClass.prototype.propertySetter = function(el, control)  {
var value = control.value,
values = [].concat(control.values),
svals = [].concat(control.param),
direct = values[0] === null,
entries = [].concat(control.entries),
ncol = entries.length,
nrow = values.length/ncol,
properties = this.repeatToLen(control.properties, ncol),
objids = this.repeatToLen(control.objids, ncol),
property, objid = objids[0],
obj = this.getObj(objid),
propvals, i, v1, v2, p, entry, gl, needsBinding,
newprop, newid,
getPropvals = function() {
if (property === "userMatrix")
return obj.par3d.userMatrix.getAsArray();
else if (property === "scale" || property === "FOV" || property === "zoom")
return [].concat(obj.par3d[property]);
else
return [].concat(obj[property]);
};
putPropvals = function(newvals) {
if (newvals.length == 1)
newvals = newvals[0];
if (property === "userMatrix")
obj.par3d.userMatrix.load(newvals);
else if (property === "scale" || property === "FOV" || property === "zoom")
obj.par3d[property] = newvals;
else
obj[property] = newvals;
};
if (direct && typeof value === "undefined")
return;
if (control.interp) {
values = values.slice(0, ncol).concat(values).
concat(values.slice(ncol*(nrow-1), ncol*nrow));
svals = [-Infinity].concat(svals).concat(Infinity);
for (i = 1; i < svals.length; i++) {
if (value <= svals[i]) {
if (svals[i] === Infinity)
p = 1;
else
p = (svals[i] - value)/(svals[i] - svals[i-1]);
break;
}
}
} else if (!direct) {
value = Math.round(value);
}
for (j=0; j<entries.length; j++) {
entry = entries[j];
newprop = properties[j];
newid = objids[j];
if (newprop !== property || newid != objid) {
if (typeof property !== "undefined")
putPropvals(propvals);
property = newprop;
objid = newid;
obj = this.getObj(objid);
propvals = getPropvals();
}
if (control.interp) {
v1 = values[ncol*(i-1) + j];
v2 = values[ncol*i + j];
this.setElement(propvals, entry, p*v1 + (1-p)*v2);
} else if (!direct) {
this.setElement(propvals, entry, values[ncol*value + j]);
} else {
this.setElement(propvals, entry, value[j]);
}
}
putPropvals(propvals);
needsBinding = [];
for (j=0; j < entries.length; j++) {
if (properties[j] === "values" &&
needsBinding.indexOf(objids[j]) === -1) {
needsBinding.push(objids[j]);
}
}
for (j=0; j < needsBinding.length; j++) {
gl = this.gl || this.initGL();
obj = this.getObj(needsBinding[j]);
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertices
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The vertext setter control data.
*/
rglwidgetClass.prototype.vertexSetter = function(el, control)  {
var svals = [].concat(control.param),
j, k, p, a, propvals, stride, ofs, obj, entry,
attrib,
ofss    = {x:"vofs", y:"vofs", z:"vofs",
red:"cofs", green:"cofs", blue:"cofs",
alpha:"cofs", radii:"radofs",
nx:"nofs", ny:"nofs", nz:"nofs",
ox:"oofs", oy:"oofs", oz:"oofs",
ts:"tofs", tt:"tofs"},
pos     = {x:0, y:1, z:2,
red:0, green:1, blue:2,
alpha:3,radii:0,
nx:0, ny:1, nz:2,
ox:0, oy:1, oz:2,
ts:0, tt:1},
values = control.values,
direct = values === null,
ncol,
interp = control.interp,
vertices = [].concat(control.vertices),
attributes = [].concat(control.attributes),
value = control.value, newval, aliases, alias;
ncol = Math.max(vertices.length, attributes.length);
if (!ncol)
return;
vertices = this.repeatToLen(vertices, ncol);
attributes = this.repeatToLen(attributes, ncol);
if (direct)
interp = false;
/* JSON doesn't pass Infinity */
svals[0] = -Infinity;
svals[svals.length - 1] = Infinity;
for (j = 1; j < svals.length; j++) {
if (value <= svals[j]) {
if (interp) {
if (svals[j] === Infinity)
p = 1;
else
p = (svals[j] - value)/(svals[j] - svals[j-1]);
} else {
if (svals[j] - value > value - svals[j-1])
j = j - 1;
}
break;
}
}
obj = this.getObj(control.objid);
// First, make sure color attributes vary in original
if (typeof obj.vOffsets !== "undefined") {
varies = true;
for (k = 0; k < ncol; k++) {
attrib = attributes[k];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0) {
switch(attrib) {
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(control.objid);
}
propvals = obj.values;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
for (k=0; k<ncol; k++) {
if (direct) {
newval = value;
} else if (interp) {
newval = p*values[j-1][k] + (1-p)*values[j][k];
} else {
newval = values[j][k];
}       
attrib = attributes[k];
vertex = vertices[k];
alias = aliases[vertex];
if (obj.type === "planes" || obj.type === "clipplanes") {
ofs = ["nx", "ny", "nz", "offset"].indexOf(attrib);
if (ofs >= 0) {
if (ofs < 3) {
if (obj.normals[vertex][ofs] != newval) {  // Assume no aliases here...
obj.normals[vertex][ofs] = newval;
obj.initialized = false;
}
} else {
if (obj.offsets[vertex][0] != newval) {
obj.offsets[vertex][0] = newval;
obj.initialized = false;
}
}
continue;
}
}
// Not a plane setting...
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0)
this.alertOnce("Attribute '"+attrib+"' not found in object "+control.objid);
else {
stride = obj.vOffsets.stride;
ofs = ofs + pos[attrib];
entry = vertex*stride + ofs;
propvals[entry] = newval;
if (typeof alias !== "undefined")
for (a = 0; a < alias.length; a++)
propvals[alias[a]*stride + ofs] = newval;
}
}
if (typeof obj.buf !== "undefined") {
var gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, propvals, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertex properties by age
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The age setter control data.
*/
rglwidgetClass.prototype.ageSetter = function(el, control) {
var objids = [].concat(control.objids),
nobjs = objids.length,
time = control.value,
births = [].concat(control.births),
ages = [].concat(control.ages),
steps = births.length,
j = Array(steps),
p = Array(steps),
i, k, age, j0, propvals, stride, ofs, objid, obj,
attrib, dim, varies, alias, aliases, a, d,
attribs = ["colors", "alpha", "radii", "vertices",
"normals", "origins", "texcoords",
"x", "y", "z",
"red", "green", "blue"],
ofss    = ["cofs", "cofs", "radofs", "vofs",
"nofs", "oofs", "tofs",
"vofs", "vofs", "vofs",
"cofs", "cofs", "cofs"],
dims    = [3,1,1,3,
3,2,2,
1,1,1,
1,1,1],
pos     = [0,3,0,0,
0,0,0,
0,1,2,
0,1,2];
/* Infinity doesn't make it through JSON */
ages[0] = -Infinity;
ages[ages.length-1] = Infinity;
for (i = 0; i < steps; i++) {
if (births[i] !== null) {  // NA in R becomes null
age = time - births[i];
for (j0 = 1; age > ages[j0]; j0++);
if (ages[j0] == Infinity)
p[i] = 1;
else if (ages[j0] > ages[j0-1])
p[i] = (ages[j0] - age)/(ages[j0] - ages[j0-1]);
else
p[i] = 0;
j[i] = j0;
}
}
// First, make sure color attributes vary in original
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
varies = true;
if (typeof obj.vOffsets === "undefined")
continue;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs < 0) {
switch(attribs[k]) {
case "colors":
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(objid);
}
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
if (typeof obj.vOffsets === "undefined")
continue;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
propvals = obj.values;
stride = obj.vOffsets.stride;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs >= 0) {
dim = dims[k];
ofs = ofs + pos[k];
for (i = 0; i < steps; i++) {
alias = aliases[i];
if (births[i] !== null) {
for (d=0; d < dim; d++) {
propvals[i*stride + ofs + d] = p[i]*attrib[dim*(j[i]-1) + d] + (1-p[i])*attrib[dim*j[i] + d];
if (typeof alias !== "undefined")
for (a=0; a < alias.length; a++)
propvals[alias[a]*stride + ofs + d] = propvals[i*stride + ofs + d];
}
}
}
} else
this.alertOnce("\'"+attribs[k]+"\' property not found in object "+objid);
}
}
obj.values = propvals;
if (typeof obj.buf !== "undefined") {
gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
}
};
/**
* Bridge to old style control
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The bridge control data.
*/
rglwidgetClass.prototype.oldBridge = function(el, control) {
var attrname, global = window[control.prefix + "rgl"];
if (global)
for (attrname in global)
this[attrname] = global[attrname];
window[control.prefix + "rgl"] = this;
};
/**
* Set up a player control
* @param { Object } el - The player control element
* @param { Object } control - The player data.
*/
rglwidgetClass.prototype.Player = function(el, control) {
var
self = this,
components = [].concat(control.components),
buttonLabels = [].concat(control.buttonLabels),
Tick = function() { /* "this" will be a timer */
var i,
nominal = this.value,
slider = this.Slider,
labels = this.outputLabels,
output = this.Output,
step;
if (typeof slider !== "undefined" && nominal != slider.value)
slider.value = nominal;
if (typeof output !== "undefined") {
step = Math.round((nominal - output.sliderMin)/output.sliderStep);
if (labels !== null) {
output.innerHTML = labels[step];
} else {
step = step*output.sliderStep + output.sliderMin;
output.innerHTML = step.toPrecision(output.outputPrecision);
}
}
for (i=0; i < this.actions.length; i++) {
this.actions[i].value = nominal;
}
self.applyControls(el, this.actions, false);
self.drawScene();
},
OnSliderInput = function() { /* "this" will be the slider */
this.rgltimer.value = Number(this.value);
this.rgltimer.Tick();
},
addSlider = function(min, max, step, value) {
var slider = document.createElement("input");
slider.type = "range";
slider.min = min;
slider.max = max;
slider.step = step;
slider.value = value;
slider.oninput = OnSliderInput;
slider.sliderActions = control.actions;
slider.sliderScene = this;
slider.className = "rgl-slider";
slider.id = el.id + "-slider";
el.rgltimer.Slider = slider;
slider.rgltimer = el.rgltimer;
el.appendChild(slider);
},
addLabel = function(labels, min, step, precision) {
var output = document.createElement("output");
output.sliderMin = min;
output.sliderStep = step;
output.outputPrecision = precision;
output.className = "rgl-label";
output.id = el.id + "-label";
el.rgltimer.Output = output;
el.rgltimer.outputLabels = labels;
el.appendChild(output);
},
addButton = function(which, label, active) {
var button = document.createElement("input"),
onclicks = {Reverse: function() { this.rgltimer.reverse();},
Play: function() { this.rgltimer.play();
this.value = this.rgltimer.enabled ? this.inactiveValue : this.activeValue; },
Slower: function() { this.rgltimer.slower(); },
Faster: function() { this.rgltimer.faster(); },
Reset: function() { this.rgltimer.reset(); },
Step:  function() { this.rgltimer.step(); }
};
button.rgltimer = el.rgltimer;
button.type = "button";
button.value = label;
button.activeValue = label;
button.inactiveValue = active;
if (which === "Play")
button.rgltimer.PlayButton = button;
button.onclick = onclicks[which];
button.className = "rgl-button";
button.id = el.id + "-" + which;
el.appendChild(button);
};
if (typeof control.reinit !== "undefined" && control.reinit !== null) {
control.actions.reinit = control.reinit;
}
el.rgltimer = new rgltimerClass(Tick, control.start, control.interval, control.stop,
control.step, control.value, control.rate, control.loop, control.actions);
for (var i=0; i < components.length; i++) {
switch(components[i]) {
case "Slider": addSlider(control.start, control.stop,
control.step, control.value);
break;
case "Label": addLabel(control.labels, control.start,
control.step, control.precision);
break;
default:
addButton(components[i], buttonLabels[i], control.pause);
}
}
el.rgltimer.Tick();
};
/**
* Apply all registered controls
* @param { Object } el - DOM element of the control
* @param { Object } x - List of actions to apply
* @param { boolean } [draw=true] - Whether to redraw after applying
*/
rglwidgetClass.prototype.applyControls = function(el, x, draw) {
var self = this, reinit = x.reinit, i, control, type;
for (i = 0; i < x.length; i++) {
control = x[i];
type = control.type;
self[type](el, control);
}
if (typeof reinit !== "undefined" && reinit !== null) {
reinit = [].concat(reinit);
for (i = 0; i < reinit.length; i++)
self.getObj(reinit[i]).initialized = false;
}
if (typeof draw === "undefined" || draw)
self.drawScene();
};
/**
* Handler for scene change
* @param { Object } message - What sort of scene change to do?
*/
rglwidgetClass.prototype.sceneChangeHandler = function(message) {
var self = document.getElementById(message.elementId).rglinstance,
objs = message.objects, mat = message.material,
root = message.rootSubscene,
initSubs = message.initSubscenes,
redraw = message.redrawScene,
skipRedraw = message.skipRedraw,
deletes, subs, allsubs = [], i,j;
if (typeof message.delete !== "undefined") {
deletes = [].concat(message.delete);
if (typeof message.delfromSubscenes !== "undefined")
subs = [].concat(message.delfromSubscenes);
else
subs = [];
for (i = 0; i < deletes.length; i++) {
for (j = 0; j < subs.length; j++) {
self.delFromSubscene(deletes[i], subs[j]);
}
delete self.scene.objects[deletes[i]];
}
}
if (typeof objs !== "undefined") {
Object.keys(objs).forEach(function(key){
key = parseInt(key, 10);
self.scene.objects[key] = objs[key];
self.initObj(key);
var obj = self.getObj(key),
subs = [].concat(obj.inSubscenes), k;
allsubs = allsubs.concat(subs);
for (k = 0; k < subs.length; k++)
self.addToSubscene(key, subs[k]);
});
}
if (typeof mat !== "undefined") {
self.scene.material = mat;
}
if (typeof root !== "undefined") {
self.scene.rootSubscene = root;
}
if (typeof initSubs !== "undefined")
allsubs = allsubs.concat(initSubs);
allsubs = self.unique(allsubs);
for (i = 0; i < allsubs.length; i++) {
self.initSubscene(allsubs[i]);
}
if (typeof skipRedraw !== "undefined") {
root = self.getObj(self.scene.rootSubscene);
root.par3d.skipRedraw = skipRedraw;
}
if (redraw)
self.drawScene();
};
/**
* Set mouse mode for a subscene
* @param { string } mode - name of mode
* @param { number } button - button number (1 to 3)
* @param { number } subscene - subscene id number
* @param { number } stayActive - if truthy, don't clear brush
*/
rglwidgetClass.prototype.setMouseMode = function(mode, button, subscene, stayActive) {
var sub = this.getObj(subscene),
which = ["left", "right", "middle"][button - 1];
if (!stayActive && sub.par3d.mouseMode[which] === "selecting")
this.clearBrush(null);
sub.par3d.mouseMode[which] = mode;
};
/**
* The class of an rgl timer object
* @class
*/
/**
* Construct an rgltimerClass object
* @constructor
* @param { function } Tick - action when timer fires
* @param { number } startTime - nominal start time in seconds
* @param { number } interval - seconds between updates
* @param { number } stopTime - nominal stop time in seconds
* @param { number } stepSize - nominal step size
* @param { number } value - current nominal time
* @param { number } rate - nominal units per second
* @param { string } loop - "none", "cycle" or "oscillate"
* @param { Object } actions - list of actions
*/
rgltimerClass = function(Tick, startTime, interval, stopTime, stepSize, value, rate, loop, actions) {
this.enabled = false;
this.timerId = 0;
/** nominal start time in seconds */
this.startTime = startTime;   
/** current nominal time */      
this.value = value;
/** seconds between updates */                 
this.interval = interval;
/** nominal stop time */           
this.stopTime = stopTime;
/** nominal step size */           
this.stepSize = stepSize;
/** nominal units per second */           
this.rate = rate;
/** "none", "cycle", or "oscillate" */                   
this.loop = loop;
/** real world start time */                   
this.realStart = undefined;
/** multiplier for fast-forward or reverse */         
this.multiplier = 1;                
this.actions = actions;
this.Tick = Tick;
};
/**
* Start playing timer object
*/
rgltimerClass.prototype.play = function() {
if (this.enabled) {
this.enabled = false;
window.clearInterval(this.timerId);
this.timerId = 0;
return;
}
var tick = function(self) {
var now = new Date();
self.value = self.multiplier*self.rate*(now - self.realStart)/1000 + self.startTime;
self.forceToRange();
if (typeof self.Tick !== "undefined") {
self.Tick(self.value);
}
};
this.realStart = new Date() - 1000*(this.value - this.startTime)/this.rate/this.multiplier;
this.timerId = window.setInterval(tick, 1000*this.interval, this);
this.enabled = true;
};
/**
* Force value into legal range
*/
rgltimerClass.prototype.forceToRange = function() {
if (this.value > this.stopTime + this.stepSize/2 || this.value < this.startTime - this.stepSize/2) {
if (!this.loop) {
this.reset();
} else {
var cycle = this.stopTime - this.startTime + this.stepSize,
newval = (this.value - this.startTime) % cycle + this.startTime;
if (newval < this.startTime) {
newval += cycle;
}
this.realStart += (this.value - newval)*1000/this.multiplier/this.rate;
this.value = newval;
}
}
};
/**
* Reset to start values
*/
rgltimerClass.prototype.reset = function() {
this.value = this.startTime;
this.newmultiplier(1);
if (typeof this.Tick !== "undefined") {
this.Tick(this.value);
}
if (this.enabled)
this.play();  /* really pause... */
if (typeof this.PlayButton !== "undefined")
this.PlayButton.value = "Play";
};
/**
* Increase the multiplier to play faster
*/
rgltimerClass.prototype.faster = function() {
this.newmultiplier(Math.SQRT2*this.multiplier);
};
/**
* Decrease the multiplier to play slower
*/
rgltimerClass.prototype.slower = function() {
this.newmultiplier(this.multiplier/Math.SQRT2);
};
/**
* Change sign of multiplier to reverse direction
*/
rgltimerClass.prototype.reverse = function() {
this.newmultiplier(-this.multiplier);
};
/**
* Set multiplier for play speed
* @param { number } newmult - new value
*/
rgltimerClass.prototype.newmultiplier = function(newmult) {
if (newmult != this.multiplier) {
this.realStart += 1000*(this.value - this.startTime)/this.rate*(1/this.multiplier - 1/newmult);
this.multiplier = newmult;
}
};
/**
* Take one step
*/
rgltimerClass.prototype.step = function() {
this.value += this.rate*this.multiplier;
this.forceToRange();
if (typeof this.Tick !== "undefined")
this.Tick(this.value);
};</script>
<div id="Plot_Actn3div" class="rglWebGL">

</div>
<script type="text/javascript">
var Plot_Actn3div = document.getElementById("Plot_Actn3div"),
Plot_Actn3rgl = new rglwidgetClass();
Plot_Actn3div.width = 865;
Plot_Actn3div.height = 577;
Plot_Actn3rgl.initialize(Plot_Actn3div,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"9":{"id":9,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"colors":[[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1]],"centers":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"ignoreExtent":false,"flags":4096},"11":{"id":11,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-14.17491,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-14.17491,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"12":{"id":12,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-3.389705,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 2 (13.4% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-3.389705,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"13":{"id":13,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-14.17491,0.5466444]],"colors":[[0,0,0,1]],"texts":[["PC 3 (9.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-14.17491,0.5466444]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"14":{"id":14,"type":"text","material":{"lit":false},"vertices":[[-3.404011,7.3955,8.475314]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Actn3"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,7.3955,8.475314]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"16":{"id":16,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"colors":[[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1]],"centers":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"ignoreExtent":false,"flags":4096},"18":{"id":18,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-5.134417,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-5.134417,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"19":{"id":19,"type":"text","material":{"lit":false},"vertices":[[-14.93983,2.558834,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 4 (9% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,2.558834,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"20":{"id":20,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-5.134417,0.3665397]],"colors":[[0,0,0,1]],"texts":[["PC 5 (8.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-5.134417,0.3665397]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"21":{"id":21,"type":"text","material":{"lit":false},"vertices":[[-3.404011,10.25208,7.73216]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Actn3"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,10.25208,7.73216]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{"fog":true},"colors":[[0.2980392,0.2980392,0.2980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"15":{"id":15,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"22":{"id":22,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"10":{"id":10,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4],["NA","NA",6]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[30,31,32,33,34,35,36]},"17":{"id":17,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-2,"NA"],["NA",0,"NA"],["NA",2,"NA"],["NA",4,"NA"],["NA",6,"NA"],["NA",8,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[38,39,40,41,42,43,44]},"7":{"id":7,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,64.58675],"modelMatrix":[[0.8844001,0,0,3.010507],[0,0.3235345,1.209157,0.4357074],[0,-0.8889037,0.4400972,-67.84045],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-232.8278],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8844001,0.9459515,1.286758],"viewport":{"x":0,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-11.44438,4.664966,-5.374692,6.467981],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[15,10,9,11,12,13,14,5,30,31,32,33,34,35,36],"parent":1,"subscenes":[],"flags":6736},"8":{"id":8,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":8,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,57.38601],"modelMatrix":[[0.7857988,0,0,2.674867],[0,0.4029968,1.156475,-1.455096],[0,-1.107225,0.4209225,-54.70708],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-206.8699],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.7857988,1.178284,1.230695],"viewport":{"x":0.5,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-3.186686,8.304354,-5.134297,5.867376],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[22,17,16,18,19,20,21,5,38,39,40,41,42,43,44],"parent":1,"subscenes":[],"flags":6736},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.863703],"modelMatrix":[[1,0,0,0],[0,0.3420202,0.9396926,0],[0,-0.9396926,0.3420202,-3.863703],[0,0,0,1]],"projMatrix":[[2.488034,0,0,0],[0,3.732051,0,0],[0,0,-3.863703,-13.9282],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,5,7,8],"subscenes":[7,8],"flags":6736},"30":{"id":30,"type":"lines","material":{"lit":false},"vertices":[[-10,-11.68602,-5.552332],[5,-11.68602,-5.552332],[-10,-11.68602,-5.552332],[-10,-12.10083,-5.857281],[-5,-11.68602,-5.552332],[-5,-12.10083,-5.857281],[0,-11.68602,-5.552332],[0,-12.10083,-5.857281],[5,-11.68602,-5.552332],[5,-12.10083,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-2.5,-11.68602,-5.552332],[-10,-11.89342,-5.704807],[-5,-11.89342,-5.704807],[0,-11.89342,-5.704807],[5,-11.89342,-5.704807]],"ignoreExtent":true,"origId":10,"flags":64},"31":{"id":31,"type":"text","material":{"lit":false},"vertices":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":10,"flags":2064},"32":{"id":32,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-10,-5.552332],[-12.27772,0,-5.552332],[-12.27772,-10,-5.552332],[-12.7214,-10,-5.857281],[-12.27772,-5,-5.552332],[-12.7214,-5,-5.857281],[-12.27772,0,-5.552332],[-12.7214,0,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-5,-5.552332],[-12.49956,-10,-5.704807],[-12.49956,-5,-5.704807],[-12.49956,0,-5.704807]],"ignoreExtent":true,"origId":10,"flags":64},"33":{"id":33,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":10,"flags":2064},"34":{"id":34,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-4],[-12.27772,-11.68602,6],[-12.27772,-11.68602,-4],[-12.7214,-12.10083,-4],[-12.27772,-11.68602,-2],[-12.7214,-12.10083,-2],[-12.27772,-11.68602,0],[-12.7214,-12.10083,0],[-12.27772,-11.68602,2],[-12.7214,-12.10083,2],[-12.27772,-11.68602,4],[-12.7214,-12.10083,4],[-12.27772,-11.68602,6],[-12.7214,-12.10083,6]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-11.68602,1],[-12.49956,-11.89342,-4],[-12.49956,-11.89342,-2],[-12.49956,-11.89342,0],[-12.49956,-11.89342,2],[-12.49956,-11.89342,4],[-12.49956,-11.89342,6]],"ignoreExtent":true,"origId":10,"flags":64},"35":{"id":35,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":10,"flags":2064},"36":{"id":36,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-5.552332],[-12.27772,4.906606,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[5.469697,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[5.469697,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[5.469697,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,4.906606,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,-5.552332],[5.469697,4.906606,6.645621]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.389705,-5.552332],[-12.27772,-3.389705,6.645621],[-12.27772,-11.68602,0.5466444],[-12.27772,4.906606,0.5466444],[-3.40401,-11.68602,-5.552332],[-3.40401,-11.68602,6.645621],[-3.40401,4.906606,-5.552332],[-3.40401,4.906606,6.645621],[5.469697,-3.389705,-5.552332],[5.469697,-3.389705,6.645621],[5.469697,-11.68602,0.5466444],[5.469697,4.906606,0.5466444]],"ignoreExtent":true,"origId":10,"flags":64},"38":{"id":38,"type":"lines","material":{"lit":false},"vertices":[[-10,-3.359051,-5.299322],[5,-3.359051,-5.299322],[-10,-3.359051,-5.299322],[-10,-3.654946,-5.582615],[-5,-3.359051,-5.299322],[-5,-3.654946,-5.582615],[0,-3.359051,-5.299322],[0,-3.654946,-5.582615],[5,-3.359051,-5.299322],[5,-3.654946,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-2.5,-3.359051,-5.299322],[-10,-3.506999,-5.440969],[-5,-3.506999,-5.440969],[0,-3.506999,-5.440969],[5,-3.506999,-5.440969]],"ignoreExtent":true,"origId":17,"flags":64},"39":{"id":39,"type":"text","material":{"lit":false},"vertices":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":17,"flags":2064},"40":{"id":40,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-2,-5.299322],[-12.27772,8,-5.299322],[-12.27772,-2,-5.299322],[-12.7214,-2,-5.582615],[-12.27772,0,-5.299322],[-12.7214,0,-5.582615],[-12.27772,2,-5.299322],[-12.7214,2,-5.582615],[-12.27772,4,-5.299322],[-12.7214,4,-5.582615],[-12.27772,6,-5.299322],[-12.7214,6,-5.582615],[-12.27772,8,-5.299322],[-12.7214,8,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-12.27772,3,-5.299322],[-12.49956,-2,-5.440969],[-12.49956,0,-5.440969],[-12.49956,2,-5.440969],[-12.49956,4,-5.440969],[-12.49956,6,-5.440969],[-12.49956,8,-5.440969]],"ignoreExtent":true,"origId":17,"flags":64},"41":{"id":41,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-2"],["0"],["2"],["4"],["6"],["8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":17,"flags":2064},"42":{"id":42,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-4],[-12.27772,-3.359051,4],[-12.27772,-3.359051,-4],[-12.7214,-3.654946,-4],[-12.27772,-3.359051,-2],[-12.7214,-3.654946,-2],[-12.27772,-3.359051,0],[-12.7214,-3.654946,0],[-12.27772,-3.359051,2],[-12.7214,-3.654946,2],[-12.27772,-3.359051,4],[-12.7214,-3.654946,4]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.359051,0],[-12.49956,-3.506999,-4],[-12.49956,-3.506999,-2],[-12.49956,-3.506999,0],[-12.49956,-3.506999,2],[-12.49956,-3.506999,4]],"ignoreExtent":true,"origId":17,"flags":64},"43":{"id":43,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":17,"flags":2064},"44":{"id":44,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-5.299322],[-12.27772,8.476719,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[5.469697,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[5.469697,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[5.469697,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,8.476719,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,-5.299322],[5.469697,8.476719,6.032402]],"colors":[[0,0,0,1]],"centers":[[-12.27772,2.558834,-5.299322],[-12.27772,2.558834,6.032402],[-12.27772,-3.359051,0.3665397],[-12.27772,8.476719,0.3665397],[-3.40401,-3.359051,-5.299322],[-3.40401,-3.359051,6.032402],[-3.40401,8.476719,-5.299322],[-3.40401,8.476719,6.032402],[5.469697,2.558834,-5.299322],[5.469697,2.558834,6.032402],[5.469697,-3.359051,0.3665397],[5.469697,8.476719,0.3665397]],"ignoreExtent":true,"origId":17,"flags":64}},"width":865,"height":577,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1],[0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]]},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Plot_Actn3rgl.prefix = "Plot_Actn3";
</script>
<p id="Plot_Actn3debug">
You must enable Javascript to view this page properly.
</p>
<script>Plot_Actn3rgl.start();</script>
</div>
<div id="sex" class="section level3">
<h3>Sex</h3>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Category
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #E41A1C; text-align: center;">
F
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
2
</td>
<td style="background-color: #377EB8; border-bottom: 2px solid grey; text-align: center;">
M
</td>
</tr>
</tbody>
</table>
<div id="Plot_Sexdiv" class="rglWebGL">

</div>
<script type="text/javascript">
var Plot_Sexdiv = document.getElementById("Plot_Sexdiv"),
Plot_Sexrgl = new rglwidgetClass();
Plot_Sexdiv.width = 865;
Plot_Sexdiv.height = 577;
Plot_Sexrgl.initialize(Plot_Sexdiv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"47":{"id":47,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"colors":[[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1]],"centers":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"ignoreExtent":false,"flags":4096},"49":{"id":49,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-14.17491,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-14.17491,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"50":{"id":50,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-3.389705,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 2 (13.4% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-3.389705,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"51":{"id":51,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-14.17491,0.5466444]],"colors":[[0,0,0,1]],"texts":[["PC 3 (9.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-14.17491,0.5466444]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"52":{"id":52,"type":"text","material":{"lit":false},"vertices":[[-3.404011,7.3955,8.475314]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Sex"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,7.3955,8.475314]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"54":{"id":54,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"colors":[[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1]],"centers":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"ignoreExtent":false,"flags":4096},"56":{"id":56,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-5.134417,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-5.134417,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"57":{"id":57,"type":"text","material":{"lit":false},"vertices":[[-14.93983,2.558834,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 4 (9% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,2.558834,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"58":{"id":58,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-5.134417,0.3665397]],"colors":[[0,0,0,1]],"texts":[["PC 5 (8.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-5.134417,0.3665397]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"59":{"id":59,"type":"text","material":{"lit":false},"vertices":[[-3.404011,10.25208,7.73216]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Sex"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,10.25208,7.73216]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"reuse":"Plot_Actn3div"},"6":{"id":6,"reuse":"Plot_Actn3div"},"53":{"id":53,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"60":{"id":60,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"48":{"id":48,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4],["NA","NA",6]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[68,69,70,71,72,73,74]},"55":{"id":55,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-2,"NA"],["NA",0,"NA"],["NA",2,"NA"],["NA",4,"NA"],["NA",6,"NA"],["NA",8,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[76,77,78,79,80,81,82]},"45":{"id":45,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":45,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,64.58675],"modelMatrix":[[0.8844001,0,0,3.010507],[0,0.3235345,1.209157,0.4357074],[0,-0.8889037,0.4400972,-67.84045],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-232.8278],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8844001,0.9459515,1.286758],"viewport":{"x":0,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-11.44438,4.664966,-5.374692,6.467981],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[53,48,47,49,50,51,52,5,68,69,70,71,72,73,74],"parent":1,"subscenes":[],"flags":6736},"46":{"id":46,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":46,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,57.38601],"modelMatrix":[[0.7857988,0,0,2.674867],[0,0.4029968,1.156475,-1.455096],[0,-1.107225,0.4209225,-54.70708],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-206.8699],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.7857988,1.178284,1.230695],"viewport":{"x":0.5,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-3.186686,8.304354,-5.134297,5.867376],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[60,55,54,56,57,58,59,5,76,77,78,79,80,81,82],"parent":1,"subscenes":[],"flags":6736},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.863703],"modelMatrix":[[1,0,0,0],[0,0.3420202,0.9396926,0],[0,-0.9396926,0.3420202,-3.863703],[0,0,0,1]],"projMatrix":[[2.488034,0,0,0],[0,3.732051,0,0],[0,0,-3.863703,-13.9282],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,5,45,46],"subscenes":[45,46],"flags":6736},"68":{"id":68,"type":"lines","material":{"lit":false},"vertices":[[-10,-11.68602,-5.552332],[5,-11.68602,-5.552332],[-10,-11.68602,-5.552332],[-10,-12.10083,-5.857281],[-5,-11.68602,-5.552332],[-5,-12.10083,-5.857281],[0,-11.68602,-5.552332],[0,-12.10083,-5.857281],[5,-11.68602,-5.552332],[5,-12.10083,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-2.5,-11.68602,-5.552332],[-10,-11.89342,-5.704807],[-5,-11.89342,-5.704807],[0,-11.89342,-5.704807],[5,-11.89342,-5.704807]],"ignoreExtent":true,"origId":48,"flags":64},"69":{"id":69,"type":"text","material":{"lit":false},"vertices":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":48,"flags":2064},"70":{"id":70,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-10,-5.552332],[-12.27772,0,-5.552332],[-12.27772,-10,-5.552332],[-12.7214,-10,-5.857281],[-12.27772,-5,-5.552332],[-12.7214,-5,-5.857281],[-12.27772,0,-5.552332],[-12.7214,0,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-5,-5.552332],[-12.49956,-10,-5.704807],[-12.49956,-5,-5.704807],[-12.49956,0,-5.704807]],"ignoreExtent":true,"origId":48,"flags":64},"71":{"id":71,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":48,"flags":2064},"72":{"id":72,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-4],[-12.27772,-11.68602,6],[-12.27772,-11.68602,-4],[-12.7214,-12.10083,-4],[-12.27772,-11.68602,-2],[-12.7214,-12.10083,-2],[-12.27772,-11.68602,0],[-12.7214,-12.10083,0],[-12.27772,-11.68602,2],[-12.7214,-12.10083,2],[-12.27772,-11.68602,4],[-12.7214,-12.10083,4],[-12.27772,-11.68602,6],[-12.7214,-12.10083,6]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-11.68602,1],[-12.49956,-11.89342,-4],[-12.49956,-11.89342,-2],[-12.49956,-11.89342,0],[-12.49956,-11.89342,2],[-12.49956,-11.89342,4],[-12.49956,-11.89342,6]],"ignoreExtent":true,"origId":48,"flags":64},"73":{"id":73,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":48,"flags":2064},"74":{"id":74,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-5.552332],[-12.27772,4.906606,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[5.469697,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[5.469697,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[5.469697,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,4.906606,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,-5.552332],[5.469697,4.906606,6.645621]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.389705,-5.552332],[-12.27772,-3.389705,6.645621],[-12.27772,-11.68602,0.5466444],[-12.27772,4.906606,0.5466444],[-3.40401,-11.68602,-5.552332],[-3.40401,-11.68602,6.645621],[-3.40401,4.906606,-5.552332],[-3.40401,4.906606,6.645621],[5.469697,-3.389705,-5.552332],[5.469697,-3.389705,6.645621],[5.469697,-11.68602,0.5466444],[5.469697,4.906606,0.5466444]],"ignoreExtent":true,"origId":48,"flags":64},"76":{"id":76,"type":"lines","material":{"lit":false},"vertices":[[-10,-3.359051,-5.299322],[5,-3.359051,-5.299322],[-10,-3.359051,-5.299322],[-10,-3.654946,-5.582615],[-5,-3.359051,-5.299322],[-5,-3.654946,-5.582615],[0,-3.359051,-5.299322],[0,-3.654946,-5.582615],[5,-3.359051,-5.299322],[5,-3.654946,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-2.5,-3.359051,-5.299322],[-10,-3.506999,-5.440969],[-5,-3.506999,-5.440969],[0,-3.506999,-5.440969],[5,-3.506999,-5.440969]],"ignoreExtent":true,"origId":55,"flags":64},"77":{"id":77,"type":"text","material":{"lit":false},"vertices":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":55,"flags":2064},"78":{"id":78,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-2,-5.299322],[-12.27772,8,-5.299322],[-12.27772,-2,-5.299322],[-12.7214,-2,-5.582615],[-12.27772,0,-5.299322],[-12.7214,0,-5.582615],[-12.27772,2,-5.299322],[-12.7214,2,-5.582615],[-12.27772,4,-5.299322],[-12.7214,4,-5.582615],[-12.27772,6,-5.299322],[-12.7214,6,-5.582615],[-12.27772,8,-5.299322],[-12.7214,8,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-12.27772,3,-5.299322],[-12.49956,-2,-5.440969],[-12.49956,0,-5.440969],[-12.49956,2,-5.440969],[-12.49956,4,-5.440969],[-12.49956,6,-5.440969],[-12.49956,8,-5.440969]],"ignoreExtent":true,"origId":55,"flags":64},"79":{"id":79,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-2"],["0"],["2"],["4"],["6"],["8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":55,"flags":2064},"80":{"id":80,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-4],[-12.27772,-3.359051,4],[-12.27772,-3.359051,-4],[-12.7214,-3.654946,-4],[-12.27772,-3.359051,-2],[-12.7214,-3.654946,-2],[-12.27772,-3.359051,0],[-12.7214,-3.654946,0],[-12.27772,-3.359051,2],[-12.7214,-3.654946,2],[-12.27772,-3.359051,4],[-12.7214,-3.654946,4]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.359051,0],[-12.49956,-3.506999,-4],[-12.49956,-3.506999,-2],[-12.49956,-3.506999,0],[-12.49956,-3.506999,2],[-12.49956,-3.506999,4]],"ignoreExtent":true,"origId":55,"flags":64},"81":{"id":81,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":55,"flags":2064},"82":{"id":82,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-5.299322],[-12.27772,8.476719,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[5.469697,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[5.469697,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[5.469697,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,8.476719,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,-5.299322],[5.469697,8.476719,6.032402]],"colors":[[0,0,0,1]],"centers":[[-12.27772,2.558834,-5.299322],[-12.27772,2.558834,6.032402],[-12.27772,-3.359051,0.3665397],[-12.27772,8.476719,0.3665397],[-3.40401,-3.359051,-5.299322],[-3.40401,-3.359051,6.032402],[-3.40401,8.476719,-5.299322],[-3.40401,8.476719,6.032402],[5.469697,2.558834,-5.299322],[5.469697,2.558834,6.032402],[5.469697,-3.359051,0.3665397],[5.469697,8.476719,0.3665397]],"ignoreExtent":true,"origId":55,"flags":64}},"width":865,"height":577,"sphereVerts":{"reuse":"Plot_Actn3div"},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Plot_Sexrgl.prefix = "Plot_Sex";
</script>
<p id="Plot_Sexdebug">
You must enable Javascript to view this page properly.
</p>
<script>Plot_Sexrgl.start();</script>
</div>
<div id="genotype" class="section level3">
<h3>Genotype</h3>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Category
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #E41A1C; text-align: center;">
KO
</td>
</tr>
<tr>
<td style="text-align: left;">
2
</td>
<td style="background-color: #377EB8; text-align: center;">
RR
</td>
</tr>
<tr>
<td style="text-align: left;">
3
</td>
<td style="background-color: #4DAF4A; text-align: center;">
WT
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
4
</td>
<td style="background-color: #984EA3; border-bottom: 2px solid grey; text-align: center;">
XX
</td>
</tr>
</tbody>
</table>
<div id="Plot_Genotypediv" class="rglWebGL">

</div>
<script type="text/javascript">
var Plot_Genotypediv = document.getElementById("Plot_Genotypediv"),
Plot_Genotypergl = new rglwidgetClass();
Plot_Genotypediv.width = 865;
Plot_Genotypediv.height = 577;
Plot_Genotypergl.initialize(Plot_Genotypediv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"85":{"id":85,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"colors":[[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.5960785,0.3058824,0.6392157,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1]],"centers":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"ignoreExtent":false,"flags":4096},"87":{"id":87,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-14.17491,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-14.17491,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"88":{"id":88,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-3.389705,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 2 (13.4% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-3.389705,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"89":{"id":89,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-14.17491,0.5466444]],"colors":[[0,0,0,1]],"texts":[["PC 3 (9.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-14.17491,0.5466444]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"90":{"id":90,"type":"text","material":{"lit":false},"vertices":[[-3.404011,7.3955,8.475314]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Genotype"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,7.3955,8.475314]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"92":{"id":92,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"colors":[[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.5960785,0.3058824,0.6392157,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.8941177,0.1019608,0.1098039,1],[0.3019608,0.6862745,0.2901961,1],[0.3019608,0.6862745,0.2901961,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.5960785,0.3058824,0.6392157,1]],"centers":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"ignoreExtent":false,"flags":4096},"94":{"id":94,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-5.134417,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-5.134417,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"95":{"id":95,"type":"text","material":{"lit":false},"vertices":[[-14.93983,2.558834,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 4 (9% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,2.558834,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"96":{"id":96,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-5.134417,0.3665397]],"colors":[[0,0,0,1]],"texts":[["PC 5 (8.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-5.134417,0.3665397]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"97":{"id":97,"type":"text","material":{"lit":false},"vertices":[[-3.404011,10.25208,7.73216]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Genotype"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,10.25208,7.73216]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"reuse":"Plot_Actn3div"},"6":{"id":6,"reuse":"Plot_Actn3div"},"91":{"id":91,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"98":{"id":98,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"86":{"id":86,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4],["NA","NA",6]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[106,107,108,109,110,111,112]},"93":{"id":93,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-2,"NA"],["NA",0,"NA"],["NA",2,"NA"],["NA",4,"NA"],["NA",6,"NA"],["NA",8,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[114,115,116,117,118,119,120]},"83":{"id":83,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":83,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,64.58675],"modelMatrix":[[0.8844001,0,0,3.010507],[0,0.3235345,1.209157,0.4357074],[0,-0.8889037,0.4400972,-67.84045],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-232.8278],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8844001,0.9459515,1.286758],"viewport":{"x":0,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-11.44438,4.664966,-5.374692,6.467981],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[91,86,85,87,88,89,90,5,106,107,108,109,110,111,112],"parent":1,"subscenes":[],"flags":6736},"84":{"id":84,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":84,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,57.38601],"modelMatrix":[[0.7857988,0,0,2.674867],[0,0.4029968,1.156475,-1.455096],[0,-1.107225,0.4209225,-54.70708],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-206.8699],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.7857988,1.178284,1.230695],"viewport":{"x":0.5,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-3.186686,8.304354,-5.134297,5.867376],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[98,93,92,94,95,96,97,5,114,115,116,117,118,119,120],"parent":1,"subscenes":[],"flags":6736},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.863703],"modelMatrix":[[1,0,0,0],[0,0.3420202,0.9396926,0],[0,-0.9396926,0.3420202,-3.863703],[0,0,0,1]],"projMatrix":[[2.488034,0,0,0],[0,3.732051,0,0],[0,0,-3.863703,-13.9282],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,5,83,84],"subscenes":[83,84],"flags":6736},"106":{"id":106,"type":"lines","material":{"lit":false},"vertices":[[-10,-11.68602,-5.552332],[5,-11.68602,-5.552332],[-10,-11.68602,-5.552332],[-10,-12.10083,-5.857281],[-5,-11.68602,-5.552332],[-5,-12.10083,-5.857281],[0,-11.68602,-5.552332],[0,-12.10083,-5.857281],[5,-11.68602,-5.552332],[5,-12.10083,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-2.5,-11.68602,-5.552332],[-10,-11.89342,-5.704807],[-5,-11.89342,-5.704807],[0,-11.89342,-5.704807],[5,-11.89342,-5.704807]],"ignoreExtent":true,"origId":86,"flags":64},"107":{"id":107,"type":"text","material":{"lit":false},"vertices":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":86,"flags":2064},"108":{"id":108,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-10,-5.552332],[-12.27772,0,-5.552332],[-12.27772,-10,-5.552332],[-12.7214,-10,-5.857281],[-12.27772,-5,-5.552332],[-12.7214,-5,-5.857281],[-12.27772,0,-5.552332],[-12.7214,0,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-5,-5.552332],[-12.49956,-10,-5.704807],[-12.49956,-5,-5.704807],[-12.49956,0,-5.704807]],"ignoreExtent":true,"origId":86,"flags":64},"109":{"id":109,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":86,"flags":2064},"110":{"id":110,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-4],[-12.27772,-11.68602,6],[-12.27772,-11.68602,-4],[-12.7214,-12.10083,-4],[-12.27772,-11.68602,-2],[-12.7214,-12.10083,-2],[-12.27772,-11.68602,0],[-12.7214,-12.10083,0],[-12.27772,-11.68602,2],[-12.7214,-12.10083,2],[-12.27772,-11.68602,4],[-12.7214,-12.10083,4],[-12.27772,-11.68602,6],[-12.7214,-12.10083,6]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-11.68602,1],[-12.49956,-11.89342,-4],[-12.49956,-11.89342,-2],[-12.49956,-11.89342,0],[-12.49956,-11.89342,2],[-12.49956,-11.89342,4],[-12.49956,-11.89342,6]],"ignoreExtent":true,"origId":86,"flags":64},"111":{"id":111,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":86,"flags":2064},"112":{"id":112,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-5.552332],[-12.27772,4.906606,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[5.469697,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[5.469697,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[5.469697,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,4.906606,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,-5.552332],[5.469697,4.906606,6.645621]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.389705,-5.552332],[-12.27772,-3.389705,6.645621],[-12.27772,-11.68602,0.5466444],[-12.27772,4.906606,0.5466444],[-3.40401,-11.68602,-5.552332],[-3.40401,-11.68602,6.645621],[-3.40401,4.906606,-5.552332],[-3.40401,4.906606,6.645621],[5.469697,-3.389705,-5.552332],[5.469697,-3.389705,6.645621],[5.469697,-11.68602,0.5466444],[5.469697,4.906606,0.5466444]],"ignoreExtent":true,"origId":86,"flags":64},"114":{"id":114,"type":"lines","material":{"lit":false},"vertices":[[-10,-3.359051,-5.299322],[5,-3.359051,-5.299322],[-10,-3.359051,-5.299322],[-10,-3.654946,-5.582615],[-5,-3.359051,-5.299322],[-5,-3.654946,-5.582615],[0,-3.359051,-5.299322],[0,-3.654946,-5.582615],[5,-3.359051,-5.299322],[5,-3.654946,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-2.5,-3.359051,-5.299322],[-10,-3.506999,-5.440969],[-5,-3.506999,-5.440969],[0,-3.506999,-5.440969],[5,-3.506999,-5.440969]],"ignoreExtent":true,"origId":93,"flags":64},"115":{"id":115,"type":"text","material":{"lit":false},"vertices":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":93,"flags":2064},"116":{"id":116,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-2,-5.299322],[-12.27772,8,-5.299322],[-12.27772,-2,-5.299322],[-12.7214,-2,-5.582615],[-12.27772,0,-5.299322],[-12.7214,0,-5.582615],[-12.27772,2,-5.299322],[-12.7214,2,-5.582615],[-12.27772,4,-5.299322],[-12.7214,4,-5.582615],[-12.27772,6,-5.299322],[-12.7214,6,-5.582615],[-12.27772,8,-5.299322],[-12.7214,8,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-12.27772,3,-5.299322],[-12.49956,-2,-5.440969],[-12.49956,0,-5.440969],[-12.49956,2,-5.440969],[-12.49956,4,-5.440969],[-12.49956,6,-5.440969],[-12.49956,8,-5.440969]],"ignoreExtent":true,"origId":93,"flags":64},"117":{"id":117,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-2"],["0"],["2"],["4"],["6"],["8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":93,"flags":2064},"118":{"id":118,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-4],[-12.27772,-3.359051,4],[-12.27772,-3.359051,-4],[-12.7214,-3.654946,-4],[-12.27772,-3.359051,-2],[-12.7214,-3.654946,-2],[-12.27772,-3.359051,0],[-12.7214,-3.654946,0],[-12.27772,-3.359051,2],[-12.7214,-3.654946,2],[-12.27772,-3.359051,4],[-12.7214,-3.654946,4]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.359051,0],[-12.49956,-3.506999,-4],[-12.49956,-3.506999,-2],[-12.49956,-3.506999,0],[-12.49956,-3.506999,2],[-12.49956,-3.506999,4]],"ignoreExtent":true,"origId":93,"flags":64},"119":{"id":119,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":93,"flags":2064},"120":{"id":120,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-5.299322],[-12.27772,8.476719,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[5.469697,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[5.469697,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[5.469697,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,8.476719,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,-5.299322],[5.469697,8.476719,6.032402]],"colors":[[0,0,0,1]],"centers":[[-12.27772,2.558834,-5.299322],[-12.27772,2.558834,6.032402],[-12.27772,-3.359051,0.3665397],[-12.27772,8.476719,0.3665397],[-3.40401,-3.359051,-5.299322],[-3.40401,-3.359051,6.032402],[-3.40401,8.476719,-5.299322],[-3.40401,8.476719,6.032402],[5.469697,2.558834,-5.299322],[5.469697,2.558834,6.032402],[5.469697,-3.359051,0.3665397],[5.469697,8.476719,0.3665397]],"ignoreExtent":true,"origId":93,"flags":64}},"width":865,"height":577,"sphereVerts":{"reuse":"Plot_Actn3div"},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Plot_Genotypergl.prefix = "Plot_Genotype";
</script>
<p id="Plot_Genotypedebug">
You must enable Javascript to view this page properly.
</p>
<script>Plot_Genotypergl.start();</script>
</div>
<div id="model" class="section level3">
<h3>Model</h3>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Category
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #E41A1C; text-align: center;">
A3NBL6
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
2
</td>
<td style="background-color: #377EB8; border-bottom: 2px solid grey; text-align: center;">
R577X
</td>
</tr>
</tbody>
</table>
<div id="Plot_Modeldiv" class="rglWebGL">

</div>
<script type="text/javascript">
var Plot_Modeldiv = document.getElementById("Plot_Modeldiv"),
Plot_Modelrgl = new rglwidgetClass();
Plot_Modeldiv.width = 865;
Plot_Modeldiv.height = 577;
Plot_Modelrgl.initialize(Plot_Modeldiv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"123":{"id":123,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"colors":[[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1]],"centers":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"ignoreExtent":false,"flags":4096},"125":{"id":125,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-14.17491,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-14.17491,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"126":{"id":126,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-3.389705,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 2 (13.4% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-3.389705,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"127":{"id":127,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-14.17491,0.5466444]],"colors":[[0,0,0,1]],"texts":[["PC 3 (9.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-14.17491,0.5466444]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"128":{"id":128,"type":"text","material":{"lit":false},"vertices":[[-3.404011,7.3955,8.475314]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Model"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,7.3955,8.475314]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"130":{"id":130,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"colors":[[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1]],"centers":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"ignoreExtent":false,"flags":4096},"132":{"id":132,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-5.134417,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-5.134417,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"133":{"id":133,"type":"text","material":{"lit":false},"vertices":[[-14.93983,2.558834,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 4 (9% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,2.558834,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"134":{"id":134,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-5.134417,0.3665397]],"colors":[[0,0,0,1]],"texts":[["PC 5 (8.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-5.134417,0.3665397]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"135":{"id":135,"type":"text","material":{"lit":false},"vertices":[[-3.404011,10.25208,7.73216]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Model"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,10.25208,7.73216]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"reuse":"Plot_Actn3div"},"6":{"id":6,"reuse":"Plot_Actn3div"},"129":{"id":129,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"136":{"id":136,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"124":{"id":124,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4],["NA","NA",6]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[144,145,146,147,148,149,150]},"131":{"id":131,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-2,"NA"],["NA",0,"NA"],["NA",2,"NA"],["NA",4,"NA"],["NA",6,"NA"],["NA",8,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[152,153,154,155,156,157,158]},"121":{"id":121,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":121,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,64.58675],"modelMatrix":[[0.8844001,0,0,3.010507],[0,0.3235345,1.209157,0.4357074],[0,-0.8889037,0.4400972,-67.84045],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-232.8278],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8844001,0.9459515,1.286758],"viewport":{"x":0,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-11.44438,4.664966,-5.374692,6.467981],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[129,124,123,125,126,127,128,5,144,145,146,147,148,149,150],"parent":1,"subscenes":[],"flags":6736},"122":{"id":122,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":122,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,57.38601],"modelMatrix":[[0.7857988,0,0,2.674867],[0,0.4029968,1.156475,-1.455096],[0,-1.107225,0.4209225,-54.70708],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-206.8699],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.7857988,1.178284,1.230695],"viewport":{"x":0.5,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-3.186686,8.304354,-5.134297,5.867376],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[136,131,130,132,133,134,135,5,152,153,154,155,156,157,158],"parent":1,"subscenes":[],"flags":6736},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.863703],"modelMatrix":[[1,0,0,0],[0,0.3420202,0.9396926,0],[0,-0.9396926,0.3420202,-3.863703],[0,0,0,1]],"projMatrix":[[2.488034,0,0,0],[0,3.732051,0,0],[0,0,-3.863703,-13.9282],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,5,121,122],"subscenes":[121,122],"flags":6736},"144":{"id":144,"type":"lines","material":{"lit":false},"vertices":[[-10,-11.68602,-5.552332],[5,-11.68602,-5.552332],[-10,-11.68602,-5.552332],[-10,-12.10083,-5.857281],[-5,-11.68602,-5.552332],[-5,-12.10083,-5.857281],[0,-11.68602,-5.552332],[0,-12.10083,-5.857281],[5,-11.68602,-5.552332],[5,-12.10083,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-2.5,-11.68602,-5.552332],[-10,-11.89342,-5.704807],[-5,-11.89342,-5.704807],[0,-11.89342,-5.704807],[5,-11.89342,-5.704807]],"ignoreExtent":true,"origId":124,"flags":64},"145":{"id":145,"type":"text","material":{"lit":false},"vertices":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":124,"flags":2064},"146":{"id":146,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-10,-5.552332],[-12.27772,0,-5.552332],[-12.27772,-10,-5.552332],[-12.7214,-10,-5.857281],[-12.27772,-5,-5.552332],[-12.7214,-5,-5.857281],[-12.27772,0,-5.552332],[-12.7214,0,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-5,-5.552332],[-12.49956,-10,-5.704807],[-12.49956,-5,-5.704807],[-12.49956,0,-5.704807]],"ignoreExtent":true,"origId":124,"flags":64},"147":{"id":147,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":124,"flags":2064},"148":{"id":148,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-4],[-12.27772,-11.68602,6],[-12.27772,-11.68602,-4],[-12.7214,-12.10083,-4],[-12.27772,-11.68602,-2],[-12.7214,-12.10083,-2],[-12.27772,-11.68602,0],[-12.7214,-12.10083,0],[-12.27772,-11.68602,2],[-12.7214,-12.10083,2],[-12.27772,-11.68602,4],[-12.7214,-12.10083,4],[-12.27772,-11.68602,6],[-12.7214,-12.10083,6]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-11.68602,1],[-12.49956,-11.89342,-4],[-12.49956,-11.89342,-2],[-12.49956,-11.89342,0],[-12.49956,-11.89342,2],[-12.49956,-11.89342,4],[-12.49956,-11.89342,6]],"ignoreExtent":true,"origId":124,"flags":64},"149":{"id":149,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":124,"flags":2064},"150":{"id":150,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-5.552332],[-12.27772,4.906606,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[5.469697,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[5.469697,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[5.469697,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,4.906606,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,-5.552332],[5.469697,4.906606,6.645621]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.389705,-5.552332],[-12.27772,-3.389705,6.645621],[-12.27772,-11.68602,0.5466444],[-12.27772,4.906606,0.5466444],[-3.40401,-11.68602,-5.552332],[-3.40401,-11.68602,6.645621],[-3.40401,4.906606,-5.552332],[-3.40401,4.906606,6.645621],[5.469697,-3.389705,-5.552332],[5.469697,-3.389705,6.645621],[5.469697,-11.68602,0.5466444],[5.469697,4.906606,0.5466444]],"ignoreExtent":true,"origId":124,"flags":64},"152":{"id":152,"type":"lines","material":{"lit":false},"vertices":[[-10,-3.359051,-5.299322],[5,-3.359051,-5.299322],[-10,-3.359051,-5.299322],[-10,-3.654946,-5.582615],[-5,-3.359051,-5.299322],[-5,-3.654946,-5.582615],[0,-3.359051,-5.299322],[0,-3.654946,-5.582615],[5,-3.359051,-5.299322],[5,-3.654946,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-2.5,-3.359051,-5.299322],[-10,-3.506999,-5.440969],[-5,-3.506999,-5.440969],[0,-3.506999,-5.440969],[5,-3.506999,-5.440969]],"ignoreExtent":true,"origId":131,"flags":64},"153":{"id":153,"type":"text","material":{"lit":false},"vertices":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":131,"flags":2064},"154":{"id":154,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-2,-5.299322],[-12.27772,8,-5.299322],[-12.27772,-2,-5.299322],[-12.7214,-2,-5.582615],[-12.27772,0,-5.299322],[-12.7214,0,-5.582615],[-12.27772,2,-5.299322],[-12.7214,2,-5.582615],[-12.27772,4,-5.299322],[-12.7214,4,-5.582615],[-12.27772,6,-5.299322],[-12.7214,6,-5.582615],[-12.27772,8,-5.299322],[-12.7214,8,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-12.27772,3,-5.299322],[-12.49956,-2,-5.440969],[-12.49956,0,-5.440969],[-12.49956,2,-5.440969],[-12.49956,4,-5.440969],[-12.49956,6,-5.440969],[-12.49956,8,-5.440969]],"ignoreExtent":true,"origId":131,"flags":64},"155":{"id":155,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-2"],["0"],["2"],["4"],["6"],["8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":131,"flags":2064},"156":{"id":156,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-4],[-12.27772,-3.359051,4],[-12.27772,-3.359051,-4],[-12.7214,-3.654946,-4],[-12.27772,-3.359051,-2],[-12.7214,-3.654946,-2],[-12.27772,-3.359051,0],[-12.7214,-3.654946,0],[-12.27772,-3.359051,2],[-12.7214,-3.654946,2],[-12.27772,-3.359051,4],[-12.7214,-3.654946,4]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.359051,0],[-12.49956,-3.506999,-4],[-12.49956,-3.506999,-2],[-12.49956,-3.506999,0],[-12.49956,-3.506999,2],[-12.49956,-3.506999,4]],"ignoreExtent":true,"origId":131,"flags":64},"157":{"id":157,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":131,"flags":2064},"158":{"id":158,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-5.299322],[-12.27772,8.476719,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[5.469697,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[5.469697,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[5.469697,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,8.476719,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,-5.299322],[5.469697,8.476719,6.032402]],"colors":[[0,0,0,1]],"centers":[[-12.27772,2.558834,-5.299322],[-12.27772,2.558834,6.032402],[-12.27772,-3.359051,0.3665397],[-12.27772,8.476719,0.3665397],[-3.40401,-3.359051,-5.299322],[-3.40401,-3.359051,6.032402],[-3.40401,8.476719,-5.299322],[-3.40401,8.476719,6.032402],[5.469697,2.558834,-5.299322],[5.469697,2.558834,6.032402],[5.469697,-3.359051,0.3665397],[5.469697,8.476719,0.3665397]],"ignoreExtent":true,"origId":131,"flags":64}},"width":865,"height":577,"sphereVerts":{"reuse":"Plot_Actn3div"},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Plot_Modelrgl.prefix = "Plot_Model";
</script>
<p id="Plot_Modeldebug">
You must enable Javascript to view this page properly.
</p>
<script>Plot_Modelrgl.start();</script>
</div>
<div id="intervention" class="section level3">
<h3>Intervention</h3>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Category
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #E41A1C; text-align: center;">
In situ muscle physiology
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
2
</td>
<td style="background-color: #377EB8; border-bottom: 2px solid grey; text-align: center;">
None
</td>
</tr>
</tbody>
</table>
<div id="Plot_Interventiondiv" class="rglWebGL">

</div>
<script type="text/javascript">
var Plot_Interventiondiv = document.getElementById("Plot_Interventiondiv"),
Plot_Interventionrgl = new rglwidgetClass();
Plot_Interventiondiv.width = 865;
Plot_Interventiondiv.height = 577;
Plot_Interventionrgl.initialize(Plot_Interventiondiv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"161":{"id":161,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"colors":[[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1]],"centers":[[1.607323,-2.685822,1.764544],[-2.244958,-0.3903048,0.4210018],[-3.116439,0.3528664,4.753027],[1.962121,-1.766333,2.396528],[0.09306877,0.2135478,1.527298],[1.615995,-2.194191,1.687225],[1.818055,-1.604924,0.8851519],[-1.475655,0.3831674,1.337478],[0.6451769,-1.713313,-0.1062378],[1.502708,-0.9268634,1.139069],[-6.456502,-1.259562,-2.056093],[2.139126,2.566649,3.7525],[-4.54879,-1.184106,0.382538],[-2.457982,3.870332,0.3575286],[-11.52453,-11.44438,-5.374692],[-6.702492,4.622247,-0.245641],[-8.594385,3.582505,0.9904208],[2.579883,-2.77569,-0.1837194],[2.378757,-0.08115969,-2.074807],[-12.01926,3.495718,-1.072573],[-2.278901,-2.320394,1.148074],[1.022998,2.289081,1.058638],[5.203732,0.3811779,-0.1101196],[-6.250704,1.358114,-1.558378],[3.284433,1.996225,0.632811],[3.564908,1.228417,0.1961374],[3.507187,1.440904,-3.379595],[3.442699,1.137038,-3.369951],[-4.094015,4.664966,-0.1195762],[5.211239,-1.380217,-1.345978],[-0.2200372,0.6364465,-0.2247457],[2.217967,2.966639,-1.81734],[0.2270319,3.494966,-2.51107],[2.289137,-2.127038,1.101344],[2.28326,-2.688394,1.754169],[-1.68761,-4.957519,6.467981],[2.792761,-1.595475,-0.5479044],[0.6529763,1.044913,2.964046],[2.597371,-2.366016,0.07776257],[1.269966,-1.013194,-1.216243],[-1.90069,-0.6860282,-1.56707],[-3.471603,0.1063119,2.918308],[2.718685,-0.08270009,1.734845],[1.235496,-0.835042,2.423232],[-3.945714,0.7488652,-1.943051],[1.918709,1.007644,0.2851845],[1.945932,3.047261,-2.274328],[4.719062,-0.472068,-2.204108],[3.942862,0.1279954,-1.98401],[4.704169,0.5095542,-3.444689],[5.198409,-1.556775,-3.388789],[0.6970662,2.833953,-0.03613042]],"ignoreExtent":false,"flags":4096},"163":{"id":163,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-14.17491,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-14.17491,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"164":{"id":164,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-3.389705,-7.382026]],"colors":[[0,0,0,1]],"texts":[["PC 2 (13.4% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-3.389705,-7.382026]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"165":{"id":165,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-14.17491,0.5466444]],"colors":[[0,0,0,1]],"texts":[["PC 3 (9.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-14.17491,0.5466444]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"166":{"id":166,"type":"text","material":{"lit":false},"vertices":[[-3.404011,7.3955,8.475314]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Intervention"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,7.3955,8.475314]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"168":{"id":168,"type":"points","material":{"lit":false,"size":6},"vertices":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"colors":[[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.8941177,0.1019608,0.1098039,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1],[0.2156863,0.4941176,0.7215686,1]],"centers":[[1.607323,-0.8135399,1.310388],[-2.244958,-3.186686,1.116529],[-3.116439,-1.205415,-1.03265],[1.962121,-2.581061,0.3812871],[0.09306877,-1.810086,0.07174386],[1.615995,-1.122628,-1.766482],[1.818055,-1.35246,-0.8254691],[-1.475655,-1.952853,-0.1276296],[0.6451769,-1.016745,-0.3261352],[1.502708,-0.6762858,-0.6026136],[-6.456502,-1.791416,4.134353],[2.139126,3.62156,5.134149],[-4.54879,0.3307936,-4.151148],[-2.457982,1.045052,5.867376],[-11.52453,3.996728,-0.8416476],[-6.702492,0.7338659,-0.5131292],[-8.594385,-0.8330601,-1.020923],[2.579883,-2.223451,1.243536],[2.378757,-1.552055,-1.097871],[-12.01926,-2.452983,-0.1267854],[-2.278901,-2.527308,-0.9475076],[1.022998,0.7722586,-0.6784711],[5.203732,-0.1402634,-3.243692],[-6.250704,1.056457,-0.2520747],[3.284433,0.6228502,-1.31017],[3.564908,-0.2305587,-2.737247],[3.507187,0.5014112,0.7873147],[3.442699,0.6906869,1.434815],[-4.094015,4.53576,-5.134297],[5.211239,3.878962,-4.391832],[-0.2200372,-0.702975,-0.2975063],[2.217967,0.1616699,0.3064482],[0.2270319,-0.5223539,-3.061178],[2.289137,-0.6406496,-0.863495],[2.28326,-0.05661578,-0.2227555],[-1.68761,-0.2014008,-0.3667457],[2.792761,-1.74027,1.973171],[0.6529763,-1.806877,-1.270439],[2.597371,0.0980731,0.6073259],[1.269966,-2.066438,0.1613473],[-1.90069,-1.698957,3.064104],[-3.471603,3.671364,0.2563829],[2.718685,4.600325,3.514711],[1.235496,8.304354,1.320545],[-3.945714,0.6265419,2.271787],[1.918709,-1.438343,0.372606],[1.945932,-0.8781615,0.8279493],[4.719062,0.03560666,0.1876229],[3.942862,-0.4376078,0.3400934],[4.704169,1.115883,0.2235682],[5.198409,0.1739115,1.115798],[0.6970662,-0.9146096,-0.8150576]],"ignoreExtent":false,"flags":4096},"170":{"id":170,"type":"text","material":{"lit":false},"vertices":[[-3.404011,-5.134417,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 1 (30.8% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,-5.134417,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"171":{"id":171,"type":"text","material":{"lit":false},"vertices":[[-14.93983,2.558834,-6.999081]],"colors":[[0,0,0,1]],"texts":[["PC 4 (9% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,2.558834,-6.999081]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"172":{"id":172,"type":"text","material":{"lit":false},"vertices":[[-14.93983,-5.134417,0.3665397]],"colors":[[0,0,0,1]],"texts":[["PC 5 (8.2% var.)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-14.93983,-5.134417,0.3665397]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"173":{"id":173,"type":"text","material":{"lit":false},"vertices":[[-3.404011,10.25208,7.73216]],"colors":[[0,0,0,1]],"texts":[["PCA coloured by Intervention"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-3.404011,10.25208,7.73216]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"reuse":"Plot_Actn3div"},"6":{"id":6,"reuse":"Plot_Actn3div"},"167":{"id":167,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"174":{"id":174,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"162":{"id":162,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4],["NA","NA",6]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[182,183,184,185,186,187,188]},"169":{"id":169,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],["NA",-2,"NA"],["NA",0,"NA"],["NA",2,"NA"],["NA",4,"NA"],["NA",6,"NA"],["NA",8,"NA"],["NA","NA",-4],["NA","NA",-2],["NA","NA",0],["NA","NA",2],["NA","NA",4]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[190,191,192,193,194,195,196]},"159":{"id":159,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":159,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,64.58675],"modelMatrix":[[0.8844001,0,0,3.010507],[0,0.3235345,1.209157,0.4357074],[0,-0.8889037,0.4400972,-67.84045],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-232.8278],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8844001,0.9459515,1.286758],"viewport":{"x":0,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-11.44438,4.664966,-5.374692,6.467981],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[167,162,161,163,164,165,166,5,182,183,184,185,186,187,188],"parent":1,"subscenes":[],"flags":6736},"160":{"id":160,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":160,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,57.38601],"modelMatrix":[[0.7857988,0,0,2.674867],[0,0.4029968,1.156475,-1.455096],[0,-1.107225,0.4209225,-54.70708],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,2.799038,0,0],[0,0,-3.863703,-206.8699],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.7857988,1.178284,1.230695],"viewport":{"x":0.5,"y":0,"width":0.5,"height":1},"zoom":1,"bbox":[-12.01926,5.211239,-3.186686,8.304354,-5.134297,5.867376],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"inherit"},"objects":[174,169,168,170,171,172,173,5,190,191,192,193,194,195,196],"parent":1,"subscenes":[],"flags":6736},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,3.863703],"modelMatrix":[[1,0,0,0],[0,0.3420202,0.9396926,0],[0,-0.9396926,0.3420202,-3.863703],[0,0,0,1]],"projMatrix":[[2.488034,0,0,0],[0,3.732051,0,0],[0,0,-3.863703,-13.9282],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38,3.402823e+38,-3.402823e+38],"windowRect":[100,100,964,676],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[6,5,159,160],"subscenes":[159,160],"flags":6736},"182":{"id":182,"type":"lines","material":{"lit":false},"vertices":[[-10,-11.68602,-5.552332],[5,-11.68602,-5.552332],[-10,-11.68602,-5.552332],[-10,-12.10083,-5.857281],[-5,-11.68602,-5.552332],[-5,-12.10083,-5.857281],[0,-11.68602,-5.552332],[0,-12.10083,-5.857281],[5,-11.68602,-5.552332],[5,-12.10083,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-2.5,-11.68602,-5.552332],[-10,-11.89342,-5.704807],[-5,-11.89342,-5.704807],[0,-11.89342,-5.704807],[5,-11.89342,-5.704807]],"ignoreExtent":true,"origId":162,"flags":64},"183":{"id":183,"type":"text","material":{"lit":false},"vertices":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-12.93046,-6.467179],[-5,-12.93046,-6.467179],[0,-12.93046,-6.467179],[5,-12.93046,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":162,"flags":2064},"184":{"id":184,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-10,-5.552332],[-12.27772,0,-5.552332],[-12.27772,-10,-5.552332],[-12.7214,-10,-5.857281],[-12.27772,-5,-5.552332],[-12.7214,-5,-5.857281],[-12.27772,0,-5.552332],[-12.7214,0,-5.857281]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-5,-5.552332],[-12.49956,-10,-5.704807],[-12.49956,-5,-5.704807],[-12.49956,0,-5.704807]],"ignoreExtent":true,"origId":162,"flags":64},"185":{"id":185,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-10,-6.467179],[-13.60877,-5,-6.467179],[-13.60877,0,-6.467179]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":162,"flags":2064},"186":{"id":186,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-4],[-12.27772,-11.68602,6],[-12.27772,-11.68602,-4],[-12.7214,-12.10083,-4],[-12.27772,-11.68602,-2],[-12.7214,-12.10083,-2],[-12.27772,-11.68602,0],[-12.7214,-12.10083,0],[-12.27772,-11.68602,2],[-12.7214,-12.10083,2],[-12.27772,-11.68602,4],[-12.7214,-12.10083,4],[-12.27772,-11.68602,6],[-12.7214,-12.10083,6]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-11.68602,1],[-12.49956,-11.89342,-4],[-12.49956,-11.89342,-2],[-12.49956,-11.89342,0],[-12.49956,-11.89342,2],[-12.49956,-11.89342,4],[-12.49956,-11.89342,6]],"ignoreExtent":true,"origId":162,"flags":64},"187":{"id":187,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"],["6"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-12.93046,-4],[-13.60877,-12.93046,-2],[-13.60877,-12.93046,0],[-13.60877,-12.93046,2],[-13.60877,-12.93046,4],[-13.60877,-12.93046,6]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":162,"flags":2064},"188":{"id":188,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-11.68602,-5.552332],[-12.27772,4.906606,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[-12.27772,-11.68602,-5.552332],[5.469697,-11.68602,-5.552332],[-12.27772,-11.68602,6.645621],[5.469697,-11.68602,6.645621],[-12.27772,4.906606,-5.552332],[5.469697,4.906606,-5.552332],[-12.27772,4.906606,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,4.906606,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,6.645621],[5.469697,-11.68602,-5.552332],[5.469697,-11.68602,6.645621],[5.469697,4.906606,-5.552332],[5.469697,4.906606,6.645621]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.389705,-5.552332],[-12.27772,-3.389705,6.645621],[-12.27772,-11.68602,0.5466444],[-12.27772,4.906606,0.5466444],[-3.40401,-11.68602,-5.552332],[-3.40401,-11.68602,6.645621],[-3.40401,4.906606,-5.552332],[-3.40401,4.906606,6.645621],[5.469697,-3.389705,-5.552332],[5.469697,-3.389705,6.645621],[5.469697,-11.68602,0.5466444],[5.469697,4.906606,0.5466444]],"ignoreExtent":true,"origId":162,"flags":64},"190":{"id":190,"type":"lines","material":{"lit":false},"vertices":[[-10,-3.359051,-5.299322],[5,-3.359051,-5.299322],[-10,-3.359051,-5.299322],[-10,-3.654946,-5.582615],[-5,-3.359051,-5.299322],[-5,-3.654946,-5.582615],[0,-3.359051,-5.299322],[0,-3.654946,-5.582615],[5,-3.359051,-5.299322],[5,-3.654946,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-2.5,-3.359051,-5.299322],[-10,-3.506999,-5.440969],[-5,-3.506999,-5.440969],[0,-3.506999,-5.440969],[5,-3.506999,-5.440969]],"ignoreExtent":true,"origId":169,"flags":64},"191":{"id":191,"type":"text","material":{"lit":false},"vertices":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-10"],["-5"],["0"],["5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-10,-4.246734,-6.149201],[-5,-4.246734,-6.149201],[0,-4.246734,-6.149201],[5,-4.246734,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":169,"flags":2064},"192":{"id":192,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-2,-5.299322],[-12.27772,8,-5.299322],[-12.27772,-2,-5.299322],[-12.7214,-2,-5.582615],[-12.27772,0,-5.299322],[-12.7214,0,-5.582615],[-12.27772,2,-5.299322],[-12.7214,2,-5.582615],[-12.27772,4,-5.299322],[-12.7214,4,-5.582615],[-12.27772,6,-5.299322],[-12.7214,6,-5.582615],[-12.27772,8,-5.299322],[-12.7214,8,-5.582615]],"colors":[[0,0,0,1]],"centers":[[-12.27772,3,-5.299322],[-12.49956,-2,-5.440969],[-12.49956,0,-5.440969],[-12.49956,2,-5.440969],[-12.49956,4,-5.440969],[-12.49956,6,-5.440969],[-12.49956,8,-5.440969]],"ignoreExtent":true,"origId":169,"flags":64},"193":{"id":193,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"colors":[[0,0,0,1]],"texts":[["-2"],["0"],["2"],["4"],["6"],["8"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-2,-6.149201],[-13.60877,0,-6.149201],[-13.60877,2,-6.149201],[-13.60877,4,-6.149201],[-13.60877,6,-6.149201],[-13.60877,8,-6.149201]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":169,"flags":2064},"194":{"id":194,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-4],[-12.27772,-3.359051,4],[-12.27772,-3.359051,-4],[-12.7214,-3.654946,-4],[-12.27772,-3.359051,-2],[-12.7214,-3.654946,-2],[-12.27772,-3.359051,0],[-12.7214,-3.654946,0],[-12.27772,-3.359051,2],[-12.7214,-3.654946,2],[-12.27772,-3.359051,4],[-12.7214,-3.654946,4]],"colors":[[0,0,0,1]],"centers":[[-12.27772,-3.359051,0],[-12.49956,-3.506999,-4],[-12.49956,-3.506999,-2],[-12.49956,-3.506999,0],[-12.49956,-3.506999,2],[-12.49956,-3.506999,4]],"ignoreExtent":true,"origId":169,"flags":64},"195":{"id":195,"type":"text","material":{"lit":false},"vertices":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"colors":[[0,0,0,1]],"texts":[["-4"],["-2"],["0"],["2"],["4"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-13.60877,-4.246734,-4],[-13.60877,-4.246734,-2],[-13.60877,-4.246734,0],[-13.60877,-4.246734,2],[-13.60877,-4.246734,4]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":169,"flags":2064},"196":{"id":196,"type":"lines","material":{"lit":false},"vertices":[[-12.27772,-3.359051,-5.299322],[-12.27772,8.476719,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[-12.27772,-3.359051,-5.299322],[5.469697,-3.359051,-5.299322],[-12.27772,-3.359051,6.032402],[5.469697,-3.359051,6.032402],[-12.27772,8.476719,-5.299322],[5.469697,8.476719,-5.299322],[-12.27772,8.476719,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,8.476719,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,6.032402],[5.469697,-3.359051,-5.299322],[5.469697,-3.359051,6.032402],[5.469697,8.476719,-5.299322],[5.469697,8.476719,6.032402]],"colors":[[0,0,0,1]],"centers":[[-12.27772,2.558834,-5.299322],[-12.27772,2.558834,6.032402],[-12.27772,-3.359051,0.3665397],[-12.27772,8.476719,0.3665397],[-3.40401,-3.359051,-5.299322],[-3.40401,-3.359051,6.032402],[-3.40401,8.476719,-5.299322],[-3.40401,8.476719,6.032402],[5.469697,2.558834,-5.299322],[5.469697,2.558834,6.032402],[5.469697,-3.359051,0.3665397],[5.469697,8.476719,0.3665397]],"ignoreExtent":true,"origId":169,"flags":64}},"width":865,"height":577,"sphereVerts":{"reuse":"Plot_Actn3div"},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Plot_Interventionrgl.prefix = "Plot_Intervention";
</script>
<p id="Plot_Interventiondebug">
You must enable Javascript to view this page properly.
</p>
<script>Plot_Interventionrgl.start();</script>
</div>
<div id="sex-effect-biplot" class="section level3">
<h3>Sex effect biplot</h3>
<p>We observe an apparent delineation by sex along PCs 1 and 5, and can plot this with the loadings for further investigation.</p>
<pre class="r"><code>plotGrouping &lt;- &quot;Sex&quot;
plotColours &lt;- generateColourKey(plotGrouping)
colScale &lt;-
  scale_colour_manual(name = &quot;Category&quot;, values = plotColours)
ggbiplot(
  PCA,
  choices = c(1, 5),
  labels = PCAlabels$ID..,
  groups = PCAlabels[, plotGrouping],
  ellipse = TRUE,
) + colScale</code></pre>
<p><img src="figure/Full-blood-count-analysis.Rmd/Biplot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="statistical-modelling" class="section level2">
<h2>Statistical modelling</h2>
<p>Testing the effects of the experimental factors is done by estimating parameters for a linear mixed effects model, as below.</p>
<pre class="r"><code>#Define which parameters should be tested
testParameters &lt;- dependentVariables

#Define the model to test
specifiedModel &lt;-
  &quot;~Intervention+Actn3+Model+Sex+(Model:Actn3)+(Sex:Actn3)&quot;
numberOfModelParameters &lt;- 7

#Define our threshold for significance (highlights p values later)
sigThreshold &lt;- 0.05

#Define function to estimate a model for a given parameter
calculateModel &lt;-
  function(modelDataset = data,
           modelToTest = specifiedModel,
           parameter = dependentVariables[1]) {
    lmm &lt;-
      lme(
        fixed = as.formula(paste(parameter,
                                 modelToTest,
                                 sep = &quot;&quot;)),
        random =  ~ 1 | Date.collected,
        method = &quot;REML&quot;,
        data = modelDataset
      )
    return(lmm)
  }

#Set numerical display options, then show results
options(digits = 5, scipen = 15)

#Set up data frame to store model results
modelResults &lt;-
  data.frame(
    matrix(
      vector(),
      numberOfModelParameters,
      length(testParameters),
      dimnames = list(c(), testParameters)
    ),
    stringsAsFactors = F
  )

#Evaluate the model for each parameter to be tested and store the results
for (i in seq_along(testParameters)) {
  parameterResult &lt;-
    data.frame(anova.lme(calculateModel(parameter = testParameters[i])), type = &quot;marginal&quot;)
  modelResults[, testParameters[i]] &lt;-
    round(parameterResult[, &quot;p.value&quot;], 5)
}
rownames(modelResults) &lt;- rownames(parameterResult)

#Drop the intercept row of the results table
modelResults &lt;- modelResults[!rownames(modelResults) == &quot;(Intercept)&quot;, ]
#Transpose for readability
modelResults &lt;- as.data.frame(t(modelResults))</code></pre>
<div id="coefficient-p-values" class="section level3">
<h3>Coefficient p values</h3>
<div id="htmlwidget-ed4b673b3453e49de144" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed4b673b3453e49de144">{"x":{"filter":"none","data":[["WBCB","WBCP","RBC","HGB","CalcHGB","HCT","MCV","MCH","MCHC","CHCM","CH","CHDW","RDW","HDW","PLT","MPV","PDW","MPC","MPM","PCT","Large.PLT","X.NEUT","X.LYM","X.MONO","X.EOS","X.BASO","X.LUC","AbsNeut","AbsLymph","AbsMono","AbsEos","AbsBaso","AbsLUC","X.PMN","X.MN","LobIndex","MPXI","X.RETIC","MCVg","CHCMg","CHg","R_C_RDW","R_C_HDW","MCVr","CHCMr","CHr","RDWr","HDWr","IRF_H","IRF_M.H","X.HYPO","Baso.PHA","RBC.PHA","X.RBC.Frag"],["<span>0.49996<\/span>                                      ","<span>0.47423<\/span>                                      ","<span>0.33720<\/span>                                      ","<span>0.92646<\/span>                                      ","<span>0.26953<\/span>                                      ","<span>0.09306<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00604<\/span>","<span style=\"color: red; font-weight: bold\">0.04823<\/span>","<span style=\"color: red; font-weight: bold\">0.00128<\/span>","<span>0.05345<\/span>                                      ","<span>0.93534<\/span>                                      ","<span>0.58191<\/span>                                      ","<span>0.78921<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00845<\/span>","<span style=\"color: red; font-weight: bold\">0.02576<\/span>","<span>0.05027<\/span>                                      ","<span>0.10731<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.01830<\/span>","<span>0.66935<\/span>                                      ","<span>0.22661<\/span>                                      ","<span>0.14088<\/span>                                      ","<span>0.26573<\/span>                                      ","<span>0.21033<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.01179<\/span>","<span>0.29431<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00843<\/span>","<span>0.50292<\/span>                                      ","<span>0.79214<\/span>                                      ","<span>0.40259<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00799<\/span>","<span>0.55080<\/span>                                      ","<span>0.10028<\/span>                                      ","<span>0.73113<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00653<\/span>","<span style=\"color: red; font-weight: bold\">0.00256<\/span>","<span>0.13396<\/span>                                      ","<span>0.14977<\/span>                                      ","<span>0.77361<\/span>                                      ","<span>0.31138<\/span>                                      ","<span>0.56978<\/span>                                      ","<span>0.41204<\/span>                                      ","<span>0.41239<\/span>                                      ","<span>0.79481<\/span>                                      ","<span>0.23557<\/span>                                      ","<span>0.62433<\/span>                                      ","<span>0.35219<\/span>                                      ","<span>0.69087<\/span>                                      ","<span>0.48141<\/span>                                      ","<span>0.78964<\/span>                                      ","<span>0.31770<\/span>                                      ","<span>0.97421<\/span>                                      ","<span>0.48757<\/span>                                      ","<span>0.17198<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02738<\/span>"],["<span>0.94217<\/span>                                      ","<span>0.91278<\/span>                                      ","<span>0.98745<\/span>                                      ","<span>0.93090<\/span>                                      ","<span>0.71818<\/span>                                      ","<span>0.96291<\/span>                                      ","<span>0.86118<\/span>                                      ","<span>0.77863<\/span>                                      ","<span>0.97659<\/span>                                      ","<span>0.37588<\/span>                                      ","<span>0.06136<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.01975<\/span>","<span>0.35864<\/span>                                      ","<span>0.58037<\/span>                                      ","<span>0.49380<\/span>                                      ","<span>0.46614<\/span>                                      ","<span>0.68710<\/span>                                      ","<span>0.11792<\/span>                                      ","<span>0.07154<\/span>                                      ","<span>0.23089<\/span>                                      ","<span>0.27870<\/span>                                      ","<span>0.25516<\/span>                                      ","<span>0.30436<\/span>                                      ","<span>0.62394<\/span>                                      ","<span>0.51319<\/span>                                      ","<span>0.53149<\/span>                                      ","<span>0.11088<\/span>                                      ","<span>0.33726<\/span>                                      ","<span>0.89563<\/span>                                      ","<span>0.54045<\/span>                                      ","<span>0.57369<\/span>                                      ","<span>0.64060<\/span>                                      ","<span>0.21344<\/span>                                      ","<span>0.54178<\/span>                                      ","<span>0.62299<\/span>                                      ","<span>0.56647<\/span>                                      ","<span>0.32660<\/span>                                      ","<span>0.56341<\/span>                                      ","<span>0.18613<\/span>                                      ","<span>0.12417<\/span>                                      ","<span>0.13894<\/span>                                      ","<span>0.19799<\/span>                                      ","<span>0.19426<\/span>                                      ","<span>0.15465<\/span>                                      ","<span>0.12007<\/span>                                      ","<span>0.10427<\/span>                                      ","<span>0.21877<\/span>                                      ","<span>0.60971<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.03799<\/span>","<span>0.30854<\/span>                                      ","<span>0.07731<\/span>                                      ","<span>0.93394<\/span>                                      ","<span>0.85261<\/span>                                      ","<span>0.77823<\/span>                                      "],["<span>0.26895<\/span>                                      ","<span>0.24975<\/span>                                      ","<span>0.36714<\/span>                                      ","<span>0.11994<\/span>                                      ","<span>0.25794<\/span>                                      ","<span>0.14855<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02338<\/span>","<span>0.61528<\/span>                                      ","<span>0.22861<\/span>                                      ","<span>0.12617<\/span>                                      ","<span>0.67592<\/span>                                      ","<span>0.54454<\/span>                                      ","<span>0.22211<\/span>                                      ","<span>0.19622<\/span>                                      ","<span>0.42612<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.04071<\/span>","<span>0.11226<\/span>                                      ","<span>0.06792<\/span>                                      ","<span>0.11929<\/span>                                      ","<span>0.07121<\/span>                                      ","<span>0.09803<\/span>                                      ","<span>0.71234<\/span>                                      ","<span>0.94254<\/span>                                      ","<span>0.76244<\/span>                                      ","<span>0.17605<\/span>                                      ","<span>0.24545<\/span>                                      ","<span>0.46662<\/span>                                      ","<span>0.79386<\/span>                                      ","<span>0.31528<\/span>                                      ","<span>0.79716<\/span>                                      ","<span>0.06720<\/span>                                      ","<span>0.20374<\/span>                                      ","<span>0.76552<\/span>                                      ","<span>0.05236<\/span>                                      ","<span>0.08612<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.03482<\/span>","<span>0.23291<\/span>                                      ","<span>0.16322<\/span>                                      ","<span>0.25456<\/span>                                      ","<span>0.50534<\/span>                                      ","<span>0.36244<\/span>                                      ","<span>0.56948<\/span>                                      ","<span>0.98321<\/span>                                      ","<span>0.27743<\/span>                                      ","<span>0.46759<\/span>                                      ","<span>0.35584<\/span>                                      ","<span>0.99012<\/span>                                      ","<span>0.42464<\/span>                                      ","<span>0.65976<\/span>                                      ","<span>0.18803<\/span>                                      ","<span>0.33261<\/span>                                      ","<span>0.26873<\/span>                                      ","<span>0.54485<\/span>                                      ","<span>0.94079<\/span>                                      "],["<span>0.71389<\/span>                                      ","<span>0.57900<\/span>                                      ","<span>0.39217<\/span>                                      ","<span>0.68093<\/span>                                      ","<span>0.99011<\/span>                                      ","<span>0.56838<\/span>                                      ","<span>0.69985<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00182<\/span>","<span>0.05933<\/span>                                      ","<span>0.22492<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00154<\/span>","<span style=\"color: red; font-weight: bold\">0.00222<\/span>","<span>0.65097<\/span>                                      ","<span>0.11175<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.04040<\/span>","<span style=\"color: red; font-weight: bold\">0.02101<\/span>","<span>0.11990<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00257<\/span>","<span>0.86292<\/span>                                      ","<span>0.41257<\/span>                                      ","<span>0.09670<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00378<\/span>","<span style=\"color: red; font-weight: bold\">0.00498<\/span>","<span>0.19377<\/span>                                      ","<span>0.88923<\/span>                                      ","<span>0.24052<\/span>                                      ","<span>0.76902<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00004<\/span>","<span>0.90605<\/span>                                      ","<span>0.12174<\/span>                                      ","<span>0.75380<\/span>                                      ","<span>0.32011<\/span>                                      ","<span>0.60096<\/span>                                      ","<span>0.42137<\/span>                                      ","<span>0.55741<\/span>                                      ","<span>0.39604<\/span>                                      ","<span>0.08809<\/span>                                      ","<span>0.51794<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.04376<\/span>","<span>0.05867<\/span>                                      ","<span>0.07631<\/span>                                      ","<span>0.08652<\/span>                                      ","<span>0.29913<\/span>                                      ","<span>0.06764<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.04498<\/span>","<span>0.09080<\/span>                                      ","<span>0.40514<\/span>                                      ","<span>0.49322<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.04203<\/span>","<span>0.77303<\/span>                                      ","<span>0.13857<\/span>                                      ","<span>0.70559<\/span>                                      ","<span>0.25129<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.00670<\/span>"],["<span>0.57838<\/span>                                      ","<span>0.45124<\/span>                                      ","<span>0.52472<\/span>                                      ","<span>0.25377<\/span>                                      ","<span>0.42340<\/span>                                      ","<span>0.43896<\/span>                                      ","<span>0.35086<\/span>                                      ","<span>0.48711<\/span>                                      ","<span>0.86792<\/span>                                      ","<span>0.46353<\/span>                                      ","<span>0.81279<\/span>                                      ","<span>0.47816<\/span>                                      ","<span>0.66956<\/span>                                      ","<span>0.87113<\/span>                                      ","<span>0.21172<\/span>                                      ","<span>0.83705<\/span>                                      ","<span>0.60969<\/span>                                      ","<span>0.92077<\/span>                                      ","<span>0.28444<\/span>                                      ","<span>0.13657<\/span>                                      ","<span>0.24985<\/span>                                      ","<span>0.84073<\/span>                                      ","<span>0.31582<\/span>                                      ","<span>0.64450<\/span>                                      ","<span>0.08153<\/span>                                      ","<span>0.65401<\/span>                                      ","<span>0.70643<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02853<\/span>","<span>0.79960<\/span>                                      ","<span>0.98384<\/span>                                      ","<span>0.15116<\/span>                                      ","<span>0.87624<\/span>                                      ","<span>0.93689<\/span>                                      ","<span>0.97969<\/span>                                      ","<span>0.86776<\/span>                                      ","<span>0.17344<\/span>                                      ","<span>0.74391<\/span>                                      ","<span>0.38735<\/span>                                      ","<span>0.07415<\/span>                                      ","<span>0.05231<\/span>                                      ","<span>0.06471<\/span>                                      ","<span>0.09203<\/span>                                      ","<span>0.12580<\/span>                                      ","<span>0.08809<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02949<\/span>","<span style=\"color: red; font-weight: bold\">0.04052<\/span>","<span>0.05992<\/span>                                      ","<span>0.30566<\/span>                                      ","<span>0.66928<\/span>                                      ","<span>0.49515<\/span>                                      ","<span>0.61177<\/span>                                      ","<span>0.57952<\/span>                                      ","<span>0.40642<\/span>                                      ","<span>0.36656<\/span>                                      "],["<span>0.06388<\/span>                                      ","<span>0.05892<\/span>                                      ","<span>0.49843<\/span>                                      ","<span>0.75709<\/span>                                      ","<span>0.63213<\/span>                                      ","<span>0.70602<\/span>                                      ","<span>0.52343<\/span>                                      ","<span>0.35113<\/span>                                      ","<span>0.71048<\/span>                                      ","<span>0.73800<\/span>                                      ","<span>0.45140<\/span>                                      ","<span>0.25154<\/span>                                      ","<span>0.57722<\/span>                                      ","<span>0.52236<\/span>                                      ","<span>0.97020<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.03563<\/span>","<span>0.08729<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02784<\/span>","<span>0.53293<\/span>                                      ","<span>0.15929<\/span>                                      ","<span>0.08012<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.01189<\/span>","<span style=\"color: red; font-weight: bold\">0.04264<\/span>","<span>0.42094<\/span>                                      ","<span>0.09332<\/span>                                      ","<span>0.30200<\/span>                                      ","<span>0.97729<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.01079<\/span>","<span style=\"color: red; font-weight: bold\">0.04933<\/span>","<span>0.54375<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.02262<\/span>","<span>0.27175<\/span>                                      ","<span>0.48595<\/span>                                      ","<span>0.11909<\/span>                                      ","<span>0.20153<\/span>                                      ","<span>0.08192<\/span>                                      ","<span>0.62897<\/span>                                      ","<span>0.70551<\/span>                                      ","<span>0.66243<\/span>                                      ","<span>0.43581<\/span>                                      ","<span>0.51238<\/span>                                      ","<span>0.51835<\/span>                                      ","<span>0.52465<\/span>                                      ","<span>0.61169<\/span>                                      ","<span>0.54486<\/span>                                      ","<span>0.58133<\/span>                                      ","<span>0.82637<\/span>                                      ","<span>0.68558<\/span>                                      ","<span>0.11933<\/span>                                      ","<span>0.21569<\/span>                                      ","<span style=\"color: red; font-weight: bold\">0.03169<\/span>","<span>0.06239<\/span>                                      ","<span>0.60738<\/span>                                      ","<span>0.36075<\/span>                                      "]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Intervention<\/th>\n      <th>Actn3<\/th>\n      <th>Model<\/th>\n      <th>Sex<\/th>\n      <th>Actn3:Model<\/th>\n      <th>Actn3:Sex<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.0 (2019-04-26)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS release 6.7 (Final)

Matrix products: default
BLAS:   /usr/local/installed/R/3.6.0/lib64/R/lib/libRblas.so
LAPACK: /usr/local/installed/R/3.6.0/lib64/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] nlme_3.1-141        DT_0.9              formattable_0.2.0.1
 [4] condformat_0.8.0    kableExtra_1.1.0    ggbiplot_0.55      
 [7] scales_1.0.0        plyr_1.8.4          ggplot2_3.2.1      
[10] RColorBrewer_1.1-2  readxl_1.3.1        rglwidget_0.2.1    
[13] rgl_0.100.26        knitr_1.25         

loaded via a namespace (and not attached):
 [1] tidyselect_0.2.5        xfun_0.10              
 [3] purrr_0.3.2             lattice_0.20-38        
 [5] colorspace_1.4-1        vctrs_0.2.0            
 [7] viridisLite_0.3.0       miniUI_0.1.1.1         
 [9] htmltools_0.4.0         yaml_2.2.0             
[11] rlang_0.4.0             manipulateWidget_0.10.0
[13] later_0.8.0             pillar_1.4.2           
[15] glue_1.3.1              withr_2.1.2            
[17] stringr_1.4.0           munsell_0.5.0          
[19] gtable_0.3.0            workflowr_1.4.0        
[21] cellranger_1.1.0        rvest_0.3.4            
[23] htmlwidgets_1.5         evaluate_0.14          
[25] labeling_0.3            httpuv_1.5.1           
[27] crosstalk_1.0.0         htmlTable_1.13.2       
[29] Rcpp_1.0.2              xtable_1.8-4           
[31] readr_1.3.1             checkmate_1.9.4        
[33] promises_1.0.1          backports_1.1.5        
[35] webshot_0.5.1           jsonlite_1.6           
[37] mime_0.7                fs_1.3.1               
[39] hms_0.5.0               digest_0.6.21          
[41] stringi_1.4.3           dplyr_0.8.3            
[43] shiny_1.3.2             rprojroot_1.3-2        
[45] tools_3.6.0             magrittr_1.5           
[47] lazyeval_0.2.2          tibble_2.1.3           
[49] crayon_1.3.4            whisker_0.3-2          
[51] pkgconfig_2.0.3         zeallot_0.1.0          
[53] xml2_1.2.2              httr_1.4.1             
[55] rstudioapi_0.10         assertthat_0.2.1       
[57] rmarkdown_1.14          R6_2.4.0               
[59] git2r_0.26.1            compiler_3.6.0         </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
