<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Harrison Wood" />


<title>Transcriptional effects of Actn3 genotype on response to Dexamethasone treatment</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.9/datatables.js"></script>
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">harrison-wood-resume</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/harrisonwood/harrison-wood-resume">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Transcriptional effects of Actn3 genotype on response to Dexamethasone treatment</h1>
<h4 class="author">Harrison Wood</h4>
<h4 class="date">9/19/2019</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-10-08
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>harrison-wood-resume/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.4.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20191008code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20191008)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20191008code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20191008)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomharrisonwoodharrisonwoodresumetree79272274970c260673e281eaf6ba23b2a7fc966dtargetblank7927227a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/harrisonwood/harrison-wood-resume/tree/79272274970c260673e281eaf6ba23b2a7fc966d" target="_blank">7927227</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomharrisonwoodharrisonwoodresumetree79272274970c260673e281eaf6ba23b2a7fc966dtargetblank7927227a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rproj.user/

Untracked files:
    Untracked:  code/common-functions.R
    Untracked:  data/Dexamethasone-study/
    Untracked:  data/Summary-blood-data.xlsx
    Untracked:  output/Dexamethasone-study/
    Untracked:  public/

Unstaged changes:
    Modified:   Workflowr-initialisation-script.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/harrisonwood/harrison-wood-resume/blob/79272274970c260673e281eaf6ba23b2a7fc966d/analysis/Dexamethasone-study.Rmd" target="_blank">7927227</a>
</td>
<td>
harrisonwood
</td>
<td>
2019-10-08
</td>
<td>
Publish site for interview
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<div id="loading-data" class="section level2">
<h2>Loading data</h2>
<p>First we load the shared functions between this and other RNA-seq analyses in the repository. We also define the project name, then load and label its data.</p>
<pre class="r"><code>#Load core RNA-seq analysis functions
source(&quot;./code/common-functions.R&quot;)

#Define the project name to set up the output folder
projectName&lt;-&quot;Dexamethasone-study&quot;
dir.create(paste(&quot;./output&quot;,projectName,sep=&quot;/&quot;))

#Read the raw gene count files stored in the project folder
countData &lt;- loadGeneCounts(paste(&quot;./data&quot;,projectName,sep=&quot;/&quot;))

#Extract sample names
sampleNames &lt;- colnames(countData)</code></pre>
<p>We can inspect the overall structure of the data for the first 100 genes in the table. <div id="htmlwidget-1dd09e18dd9f56c1c39b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1dd09e18dd9f56c1c39b">{"x":{"filter":"none","data":[["Xkr4","Rp1","Sox17","Mrpl15","Lypla1","Tcea1","Rgs20","Atp6v1h","Oprk1","Npbwr1","Rb1cc1","Fam150a","St18","Pcmtd1","Sntg1","Rrs1","Adhfe1","2610203C22Rik","3110035E14Rik","Mybl1","Vcpip1","1700034P13Rik","Sgk3","Mcmdc2","Snhg6","Snord87","Ppp1r42","Cops5","Cspp1","Arfgef1","Cpa6","Mir467e","Prex2","A830018L16Rik","Gm17644","Sulf1","Slco5a1","Prdm14","Ncoa2","Tram1","Lactb2","Xkr9","Gm5523","Eya1","Msc","Trpa1","Kcnb2","Terf1","Sbspon","4930444P10Rik","Rpl7","Rdh10","Stau2","Ube2w","Tceb1","D030040B21Rik","Tmem70","Ly96","Jph1","Gdap1","Pi15","Crispld1","Crisp4","Defb44-ps","Defb18","Defb41","Gm15386","Tfap2d","Tfap2b","Pkhd1","4930486I03Rik","Mir206","Mir133b","Il17a","Il17f","Mcm3","6720483E21Rik","Paqr8","Efhc1","Tram2","Tmem14a","Gsta3","Gm4956","Khdc1a","Khdc1c","Khdc1b","Kcnq5","Rims1","4933415F23Rik","Mir30a","Mir30c-2","Ogfrl1","B3gat2","Smap1","1110058L19Rik","Fam135a","Col9a1","Col19a1","Lmbrd1","Bai3"],["0","8","177","2543","5416","1022","3","299","0","0","6272","0","0","6883","0","550","2032","16","0","18","830","1","385","0","81","0","4","2771","245","8191","0","0","888","2","0","776","2406","0","1924","850","1339","0","4","1540","23","0","2","117","26","0","4521","132","2702","384","1485","0","1263","11","25978","773","81","118","0","0","0","0","0","0","1","0","0","0","0","0","0","79","0","65","20","66","24","23","2","0","0","0","1262","0","15","0","0","446","0","635","200","1139","4","134","2494","1"],["0","4","166","1931","5006","1039","1","255","0","0","6116","0","0","6751","0","506","1979","22","2","19","865","2","382","2","53","1","7","2297","219","7322","0","0","800","2","0","666","2387","0","1823","779","1310","0","8","1255","20","0","3","126","9","0","4462","102","2464","399","1344","0","962","11","24663","808","102","88","0","0","0","0","0","0","0","0","0","0","0","0","0","121","0","23","11","78","21","32","1","0","0","0","1300","4","33","0","0","449","0","499","183","1099","12","122","2366","0"],["1","9","173","1981","5257","1086","0","345","0","0","5939","0","0","6981","0","525","1836","14","4","20","862","1","387","1","89","1","8","2700","227","7948","0","0","728","0","0","794","2379","0","1729","787","1213","1","9","1232","24","0","0","146","15","0","4431","105","2715","382","1440","0","1147","11","23846","1033","74","103","0","0","0","0","0","0","0","2","0","0","0","0","0","112","0","42","13","62","24","17","0","0","0","0","1111","0","12","0","0","497","0","493","187","947","9","127","2534","4"],["1","18","386","2262","5384","1136","4","439","0","0","6270","0","0","7232","1","542","2119","8","0","17","861","1","483","2","62","0","2","2896","250","8325","0","0","1708","12","0","1211","2841","0","1910","731","1273","0","7","1450","23","0","3","175","23","0","5683","86","3036","355","1434","0","1209","16","26525","552","345","149","0","0","0","0","0","0","0","1","0","0","0","0","0","119","1","52","13","61","27","36","3","0","0","0","1170","1","124","0","0","561","0","659","202","1058","9","133","2734","2"],["0","14","446","2492","5457","1009","1","446","0","0","6160","0","0","6520","0","501","1456","10","1","16","856","1","475","2","97","1","16","2855","292","8252","0","0","1682","7","0","1116","2035","0","1632","748","1196","0","8","899","36","0","0","179","33","0","4892","97","3123","380","1471","0","1502","29","19015","648","304","157","0","0","0","0","0","0","0","1","0","0","0","0","2","98","1","47","11","75","27","185","0","0","0","0","780","0","33","0","0","534","0","580","278","972","3","157","2489","2"],["0","2","237","1471","4573","881","2","285","0","0","4752","0","0","4809","0","297","892","8","0","5","583","0","342","0","71","0","15","2293","168","6621","0","0","1049","9","0","821","1776","0","1190","703","984","0","11","941","21","0","1","105","15","0","4072","70","2256","339","1210","0","1006","13","17931","699","338","72","0","0","0","0","0","0","0","2","0","0","0","0","0","58","0","25","8","63","23","62","1","0","0","0","798","1","34","0","0","504","0","465","128","636","4","99","1895","0"],["0","9","461","2647","6036","1011","1","402","0","0","5302","0","0","7105","0","552","1707","15","2","11","880","1","495","1","137","0","7","2979","191","7896","0","0","1359","6","0","973","2924","0","1446","688","1271","0","8","1222","18","0","1","157","23","0","6457","77","3404","376","1642","0","1939","23","23380","1051","140","75","0","0","0","0","0","0","0","1","0","0","0","0","0","139","2","41","10","65","28","136","2","0","0","0","1086","1","57","0","0","478","0","567","355","932","3","112","2918","2"],["1","12","168","2002","4230","953","2","375","0","0","4869","0","1","5733","1","470","1396","14","3","13","758","1","348","0","107","0","1","2551","186","6676","0","0","660","7","0","644","1875","0","1483","631","999","0","9","1814","20","0","0","122","13","0","5108","81","2412","360","1310","0","999","16","19157","1349","99","81","0","0","0","0","0","0","0","0","0","0","0","0","2","99","0","37","13","66","22","40","1","0","0","0","957","1","10","0","1","447","0","541","171","1016","20","108","1939","0"],["0","5","152","1496","3843","945","1","233","0","0","4761","0","0","5305","0","438","1248","11","4","13","666","0","266","0","71","0","2","1924","194","5968","0","0","657","2","0","582","1687","1","1260","623","965","0","6","1160","13","0","0","81","16","0","3847","72","1902","344","1175","0","736","10","16569","1134","79","91","0","0","0","0","0","0","0","3","0","0","0","0","0","87","1","46","13","81","18","26","0","0","0","0","802","1","13","0","0","434","0","420","125","926","25","94","1784","1"],["5","7","186","1887","4179","1020","4","336","0","0","4380","0","0","5805","0","518","1222","13","0","10","631","1","343","0","99","0","14","2180","247","6201","0","0","658","6","0","708","1912","0","1296","719","1038","0","6","1478","18","0","0","122","23","0","4622","103","2344","335","1157","0","922","4","15843","1244","53","67","0","0","0","0","0","0","0","1","0","0","0","0","4","96","1","45","15","85","17","26","0","1","0","0","1040","2","22","0","1","405","0","421","163","946","29","78","1877","6"],["4","4","392","2096","4364","940","1","281","0","0","4428","0","0","5362","0","406","1401","3","3","17","651","2","416","2","100","0","4","2147","198","6007","0","0","1049","4","0","801","1764","0","1498","554","966","0","9","1224","14","0","0","132","20","0","4409","73","2107","283","1205","0","877","16","21161","1265","316","88","0","0","0","0","0","0","0","4","0","0","0","0","1","114","0","28","13","74","19","14","0","0","0","0","1243","0","53","0","0","453","0","572","157","879","37","90","2026","2"],["3","12","489","2515","5153","1054","8","459","0","0","5617","0","0","5965","2","525","1119","21","2","12","805","1","520","0","126","0","15","2898","253","6737","1","0","1695","23","0","1709","2079","0","1593","875","1233","0","8","1102","42","0","1","205","22","0","6223","90","3029","367","1385","0","1435","36","17272","1589","412","138","0","0","0","0","0","0","0","0","0","0","0","0","0","132","0","56","13","81","28","207","2","0","0","0","982","2","27","0","0","453","0","677","279","935","19","123","2386","4"],["0","11","393","2112","4246","875","2","400","0","0","5164","0","0","5533","0","424","1573","26","0","13","710","1","436","0","126","0","9","2755","194","7249","0","0","1423","18","0","802","1794","0","1476","643","912","0","6","1293","10","0","0","161","15","0","5084","71","2343","339","1313","0","1177","15","17853","1266","330","63","0","0","0","0","0","0","0","0","0","0","0","0","0","95","0","29","14","65","23","91","0","0","0","0","713","3","26","0","0","430","0","602","200","1002","37","124","2064","3"],["2","6","415","2204","4606","1018","0","382","0","0","5094","0","0","5782","0","457","1775","18","1","15","833","1","403","1","143","0","4","2915","205","7319","0","0","1290","8","0","919","1904","0","1585","608","955","0","3","1507","10","0","1","175","19","0","5866","95","2363","332","1503","0","1143","16","21561","1258","320","94","0","0","0","0","0","0","0","1","0","0","0","0","0","104","0","37","12","58","39","28","1","1","0","0","1216","0","83","0","1","476","0","640","199","1021","32","93","2172","0"],["1","4","475","3069","5941","1163","5","449","0","0","6069","0","0","7713","0","495","1628","14","1","14","943","3","585","1","203","1","6","3495","216","8585","0","0","1490","3","0","1249","2667","0","1639","808","1106","0","6","1234","25","0","3","196","22","1","7921","137","3902","419","1737","0","1838","34","22972","1515","213","123","0","0","0","0","0","0","0","1","0","0","0","0","0","132","1","45","6","74","40","145","4","0","0","0","953","0","21","0","2","575","0","672","348","1104","19","112","2762","0"],["0","6","161","2089","4367","784","2","252","0","0","4668","0","2","5237","0","551","1339","10","0","6","600","0","295","0","85","0","4","2161","184","6017","0","0","770","3","0","525","1603","0","1161","478","1123","0","10","646","16","0","1","101","8","0","3385","94","2511","299","1097","0","1152","11","16336","544","29","90","0","0","0","0","0","0","0","0","0","0","0","0","0","73","1","33","8","67","19","58","1","0","0","0","561","1","1","0","0","299","0","494","182","796","4","111","2006","3"],["1","7","155","2105","4767","727","2","235","0","0","4294","0","0","5250","0","395","1080","8","0","18","644","0","259","0","80","0","4","2086","158","5964","0","0","1004","1","0","462","1905","0","1251","497","921","0","4","640","20","0","1","121","15","0","3171","60","1736","306","1290","0","808","8","16097","666","49","80","0","0","0","0","0","0","1","0","0","0","0","0","0","67","1","28","13","69","12","20","1","0","0","0","841","2","6","0","0","319","2","318","171","774","4","104","1954","0"],["0","4","168","1937","4633","720","2","262","0","0","4816","0","0","5969","0","427","1672","14","0","10","605","1","248","0","68","0","2","2545","184","6272","0","0","891","4","0","572","2092","0","1256","535","918","0","9","670","17","0","0","117","18","0","4222","93","2373","279","1318","0","1035","13","16893","601","44","81","0","0","0","0","0","0","1","2","0","0","0","0","0","75","0","34","12","54","36","75","0","0","0","0","709","3","17","0","0","428","0","394","179","916","6","123","1813","3"],["0","2","201","2582","6059","1296","1","359","0","0","6684","0","1","6975","0","562","1561","20","0","13","800","1","412","0","111","0","6","3062","287","8958","0","0","964","5","0","612","2431","0","1624","794","1378","0","13","1123","26","0","0","156","14","0","5731","123","3128","421","1600","0","1405","17","21994","341","60","88","0","0","0","0","0","0","0","1","0","0","0","0","0","79","0","37","14","100","20","47","0","0","0","0","726","1","79","0","0","433","2","579","189","1119","2","122","2701","2"],["0","4","170","2504","5179","1036","1","332","0","0","5559","0","0","6108","0","547","1623","14","1","13","748","0","402","0","119","0","2","2785","233","7560","0","0","818","1","0","484","1716","0","1510","595","1049","0","14","831","32","0","2","126","21","0","4667","109","2327","361","1455","0","1080","16","18791","226","59","60","0","0","0","0","0","0","0","1","0","0","0","0","0","56","1","40","14","70","19","28","0","0","0","0","613","2","53","0","1","314","0","453","232","916","7","99","2275","1"],["0","3","196","3241","6544","1277","5","445","0","0","7480","0","0","7540","0","614","1453","26","4","14","947","2","563","4","154","0","4","3899","297","10119","0","0","936","3","0","683","3535","0","1792","862","1533","0","22","1223","28","0","0","172","16","0","7959","145","4622","550","1978","0","2053","14","29064","398","46","90","0","0","0","0","0","0","0","3","0","0","1","0","0","137","1","58","14","133","24","44","0","0","0","0","937","0","39","0","0","530","0","712","310","1224","3","125","3236","1"],["1","3","194","1870","4503","927","2","267","0","0","4571","0","0","5675","0","461","1344","14","1","9","659","0","315","0","117","0","5","2565","210","6548","0","0","857","1","0","655","1463","0","1447","592","899","0","9","1285","27","0","0","93","18","0","4950","77","2135","347","1340","0","974","14","18338","1070","62","96","0","0","0","0","0","0","0","1","0","0","0","0","0","92","0","40","16","46","18","22","0","1","0","0","1040","0","3","0","0","491","0","534","189","1073","25","83","1878","0"],["0","9","179","2086","4794","949","2","436","0","0","5263","0","0","6938","0","541","1312","19","1","21","734","2","298","1","115","1","10","2719","286","6926","0","0","1107","9","0","772","2521","0","1448","703","989","1","6","921","8","0","2","137","14","0","5595","125","2940","360","1423","1","1143","9","16471","1205","46","79","0","0","0","0","0","0","0","6","0","0","0","0","0","123","4","45","13","81","30","216","1","0","0","0","786","2","5","0","0","511","1","464","186","958","27","70","1904","3"],["0","8","235","2316","5012","983","2","382","0","0","5599","0","0","6492","0","509","1741","23","0","24","801","2","426","0","141","0","10","3212","250","6192","0","0","916","5","0","898","2439","0","1639","814","1104","0","15","1176","22","0","2","149","16","0","6519","124","2861","407","1496","0","1169","19","21368","1779","64","108","0","0","0","0","0","0","1","0","0","0","0","0","2","184","2","52","26","69","37","119","2","0","0","0","948","1","3","0","0","548","0","642","260","1091","42","95","2309","4"],["4","3","158","2305","4480","1054","0","441","0","0","5995","0","0","6206","0","614","1881","20","1","17","804","8","393","1","164","0","3","3052","242","7262","0","0","778","6","0","567","1599","0","1635","625","1023","0","12","1397","19","0","1","182","15","0","6147","104","2776","391","1339","0","1408","18","21661","667","65","41","0","0","0","0","0","0","0","1","0","0","2","0","0","106","1","39","11","68","20","78","0","0","0","0","740","6","31","0","0","369","0","657","164","1235","37","141","2347","0"],["0","3","145","1895","3940","938","1","370","0","0","5530","0","0","5556","0","483","1189","21","0","18","602","2","343","1","123","0","3","2229","208","6144","0","0","600","3","0","448","1377","0","1268","580","903","0","10","1249","12","0","1","173","19","0","4748","102","2140","350","1181","0","1039","15","17763","532","45","66","0","0","0","0","0","0","0","0","0","0","0","0","0","62","0","27","11","57","21","36","1","0","0","0","828","0","37","0","0","357","0","508","141","1051","11","101","1841","0"],["2","0","156","1666","4182","1250","0","372","0","0","6841","0","1","6446","0","538","1596","14","3","17","709","0","388","1","131","0","1","2549","225","7856","0","0","793","1","0","488","1501","0","1441","643","992","0","9","1471","14","0","0","178","15","0","5593","92","2253","365","1331","0","1051","18","19191","641","64","63","0","0","0","0","0","0","0","3","0","0","0","1","0","88","1","35","9","62","20","14","0","1","0","0","780","2","58","0","0","397","0","514","142","1163","15","127","1964","0"],["0","6","220","2171","4993","1253","4","415","0","0","6556","0","1","6772","0","537","1728","22","2","20","714","0","410","0","173","0","3","2972","231","8279","0","0","834","2","0","571","1739","0","1781","691","1113","0","9","1402","27","0","2","164","27","0","6264","143","2585","423","1573","0","1308","10","21082","674","100","86","0","0","0","0","0","0","0","1","0","0","0","0","0","93","0","36","12","76","17","20","1","0","0","1","961","3","64","0","0","452","0","570","189","1286","18","135","2286","2"],["1","2","374","2269","5316","1037","6","603","0","0","5358","0","0","5269","0","374","1607","24","1","14","709","2","456","0","192","0","2","3778","146","8596","0","0","1385","6","0","911","2256","0","1330","696","909","0","11","1119","23","0","2","147","21","0","7621","95","2582","406","1994","0","1650","18","18165","674","302","86","0","0","0","0","0","0","0","0","0","0","0","0","0","105","0","41","5","79","38","48","2","0","0","0","568","3","35","0","0","437","0","597","434","907","9","128","2366","3"],["0","1","122","1286","4505","1009","0","392","0","0","5660","0","0","5552","0","269","1112","9","2","23","682","1","403","0","109","0","2","2645","152","7306","0","0","789","5","0","395","1666","0","943","609","873","0","6","744","20","0","0","118","9","0","4893","96","2078","431","1622","0","1315","11","13233","354","58","77","0","0","0","0","0","0","0","0","0","0","0","0","2","41","0","25","14","49","18","18","1","0","0","0","488","3","21","0","0","315","0","392","264","925","5","67","1878","0"],["0","1","136","1556","4032","905","1","393","0","0","4065","0","0","4449","0","375","1100","21","0","8","619","0","344","0","121","0","2","2854","136","5917","0","0","660","1","0","395","1530","1","1013","491","710","0","6","649","19","0","0","97","21","0","5320","76","1669","393","1466","0","971","25","13454","252","67","62","0","0","0","0","0","0","0","1","0","0","0","0","0","75","0","27","22","43","18","29","0","0","0","0","364","0","28","0","0","240","0","327","282","776","4","87","1580","0"],["0","6","118","1552","3529","585","0","386","0","0","2922","0","0","4196","0","255","893","30","0","14","569","1","266","0","129","0","5","2321","137","4014","1","0","665","1","0","444","1725","0","879","453","637","0","13","478","9","0","1","76","15","0","5788","103","1682","263","1266","0","1187","15","9141","1223","61","58","0","0","0","0","0","0","0","4","0","0","0","0","0","149","0","34","20","31","41","141","2","0","0","0","411","2","5","0","0","278","0","307","354","684","39","53","1397","0"],["1","0","173","2620","5028","1106","2","546","0","0","5507","0","0","5835","0","411","1087","28","0","13","772","0","482","1","214","0","2","3573","165","7620","0","0","763","7","0","654","2085","0","1295","677","1044","0","11","1144","25","0","0","158","26","0","9309","117","2519","473","2024","0","1933","20","19198","877","43","74","0","0","0","0","0","0","0","2","0","0","0","0","0","128","0","55","11","78","26","57","0","0","0","0","729","1","26","0","0","345","0","613","446","1118","12","73","2346","1"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ML171540<\/th>\n      <th>ML171541<\/th>\n      <th>ML171542<\/th>\n      <th>ML171543<\/th>\n      <th>ML171545<\/th>\n      <th>ML171546<\/th>\n      <th>ML171547<\/th>\n      <th>ML171548<\/th>\n      <th>ML171549<\/th>\n      <th>ML171550<\/th>\n      <th>ML171551<\/th>\n      <th>ML171552<\/th>\n      <th>ML171553<\/th>\n      <th>ML171554<\/th>\n      <th>ML171555<\/th>\n      <th>ML171556<\/th>\n      <th>ML171557<\/th>\n      <th>ML171558<\/th>\n      <th>ML171559<\/th>\n      <th>ML171562<\/th>\n      <th>ML171563<\/th>\n      <th>ML171564<\/th>\n      <th>ML171566<\/th>\n      <th>ML171567<\/th>\n      <th>ML171568<\/th>\n      <th>ML171569<\/th>\n      <th>ML171570<\/th>\n      <th>ML171571<\/th>\n      <th>ML171650<\/th>\n      <th>ML171651<\/th>\n      <th>ML171652<\/th>\n      <th>ML171653<\/th>\n      <th>ML171654<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script></p>
</div>
<div id="defining-the-experimental-design" class="section level2">
<h2>Defining the experimental design</h2>
<p>We then load the sample descriptors and define the factors of the experimental design.</p>
<p>In this study, mice with either <em>Wild type</em> (<strong>WT</strong>) or <em>Actn3 KO</em> (<strong>KO</strong>) genotypes were treated with either <em>Dexamethasone</em> (<strong>DEX</strong>) or <em>Saline</em> (<strong>SAL</strong>) injections. Samples were taken either <em>3 hours</em> (<strong>3H</strong>) or <em>24 hours</em> (<strong>24H</strong>) post injection.</p>
<pre class="r"><code>#Load sample information table
sampleInfo &lt;- read.delim(file = paste(&quot;./data&quot;,projectName,&quot;sampleinfo.txt&quot;, sep = &quot;/&quot;))

#Get the experimental factors in the study design
experimentalFactors &lt;- colnames(sampleInfo[-1])
#Join sample factors to get the grouping for each sample
sampleGroups &lt;- do.call(paste, c(sampleInfo[,experimentalFactors], sep = &quot;_&quot;))
#Get the list of groups in the study
groups&lt;-sort(unique(sampleGroups))
#Define sample groups as a factor
sampleGroups&lt;-factor(sampleGroups,levels=groups)

#Give each group a unique identifying colour for plots
groupColours &lt;-
  c(
    &quot;#ffcf6b&quot;,
    &quot;#bd8102&quot;,
    &quot;#fb6a7b&quot;,
    &quot;#b90017&quot;,
    &quot;#82ef65&quot;,
    &quot;#21a400&quot;,
    &quot;#6b8cde&quot;,
    &quot;#06319c&quot;
  )
names(groupColours) &lt;- groups

#Give each sample a colour on the basis of grouping
sampleColours &lt;-
  factor(groupColours[sampleGroups], levels = groupColours)

#Show sample information and experimental grouping
as.datatable(formattable(sampleInfo))</code></pre>
<div id="htmlwidget-ed4b673b3453e49de144" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ed4b673b3453e49de144">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33"],["ML171540","ML171541","ML171542","ML171543","ML171545","ML171546","ML171547","ML171548","ML171549","ML171550","ML171551","ML171552","ML171553","ML171554","ML171555","ML171556","ML171557","ML171558","ML171559","ML171562","ML171563","ML171564","ML171566","ML171567","ML171568","ML171569","ML171570","ML171571","ML171650","ML171651","ML171652","ML171653","ML171654"],["KO","KO","KO","KO","KO","KO","KO","WT","WT","WT","WT","WT","WT","WT","WT","KO","KO","KO","KO","KO","KO","WT","WT","WT","WT","WT","WT","WT","KO","KO","KO","WT","WT"],["SAL","SAL","SAL","DEX","DEX","DEX","DEX","SAL","SAL","SAL","DEX","DEX","DEX","DEX","DEX","SAL","SAL","SAL","DEX","DEX","DEX","SAL","SAL","SAL","DEX","DEX","DEX","DEX","DEX","DEX","DEX","SAL","DEX"],["3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","3H ","24H","24H","24H","24H","24H","24H","24H","24H","24H","24H","24H","24H","24H","3H ","24H","24H","24H","24H"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Name<\/th>\n      <th>Genotype<\/th>\n      <th>Treatment<\/th>\n      <th>Time<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script>
Throughout the analysis, sample groupings are coloured according to the following scheme:
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #ffcf6b; text-align: center;">
KO_DEX_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
2
</td>
<td style="background-color: #bd8102; text-align: center;">
KO_DEX_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
3
</td>
<td style="background-color: #fb6a7b; text-align: center;">
KO_SAL_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
4
</td>
<td style="background-color: #b90017; text-align: center;">
KO_SAL_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
5
</td>
<td style="background-color: #82ef65; text-align: center;">
WT_DEX_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
6
</td>
<td style="background-color: #21a400; text-align: center;">
WT_DEX_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
7
</td>
<td style="background-color: #6b8cde; text-align: center;">
WT_SAL_24H
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
8
</td>
<td style="background-color: #06319c; border-bottom: 2px solid grey; text-align: center;">
WT_SAL_3H
</td>
</tr>
</tbody>
</table>
</div>
<div id="sample-preprocessing" class="section level2">
<h2>Sample preprocessing</h2>
<p>We now begin processing the data by transforming values to a counts per million measure and filtering out very lowly expressed genes. Genes were retained if at least 2 samples had at least 0.5 CPM detected.</p>
<pre class="r"><code>#Convert raw gene counts to counts per million, and select undetected genes
CPMdata &lt;- cpm(countData)
lowCPMValues &lt;- CPMdata &gt; 0.5
#Select only genes detected in at least 2 samples
filteredGeneIDs &lt;- rowSums(lowCPMValues) &gt;=2

#We then store this filtered gene count data in a DGElist object from the edgeR package
y &lt;- DGEList(countData[filteredGeneIDs,])</code></pre>
</div>
<div id="gene-annotation" class="section level2">
<h2>Gene annotation</h2>
<p>We then annotate the gene list with gene symbols, Entrez IDs, and gene name information populated from the Bioconductor annotation data package. To make subsequent analysis simpler to interpret, we also use these annotations to exclude mitochondrial, ribosomal, and pseudogenes from the dataset.</p>
<pre class="r"><code>#Select gene annotations from the org.Mm.eg.db database
annotations &lt;-
  biomaRt::select(
    org.Mm.eg.db,
    keytype = &quot;SYMBOL&quot;,
    keys = rownames(y),
    columns = c(&quot;ENTREZID&quot;, &quot;SYMBOL&quot;, &quot;GENENAME&quot;),
    multiVals = &quot;first&quot;
  )</code></pre>
<pre><code>&#39;select()&#39; returned 1:many mapping between keys and columns</code></pre>
<pre class="r"><code>#Match these annotations to genes in our dataset
annotations &lt;-
  annotations[match(rownames(y), annotations$SYMBOL), ]
y$genes &lt;- annotations

#Exclude unwanted genes
excludeUnwantedGenes &lt;- TRUE
if (excludeUnwantedGenes) {
  #Select mitochondrial, ribosomal, and pseudogenes
  mitochondrialGenes &lt;- grep(&quot;mitochondrial&quot;, y$genes$GENENAME)
  ribosomalGenes &lt;- grep(&quot;ribosomal&quot;, y$genes$GENENAME)
  pseudoGenes &lt;- grep(&quot;pseudogene&quot;, y$genes$GENENAME)
  unwantedGenes &lt;-
    unique(c(mitochondrialGenes, ribosomalGenes, pseudoGenes))
  #Filter these from the dataset
  y &lt;- y[-unwantedGenes,]
}</code></pre>
<p>Of an initial 23422 genes, 12711 are retained for further analysis.</p>
</div>
</div>
<div id="quality-control" class="section level1">
<h1>Quality control</h1>
<div id="checking-sequencing-efficacy" class="section level2">
<h2>Checking sequencing efficacy</h2>
<p>Library sizes across samples do not exhibit an obvious bias in grouping. <img src="figure/Dexamethasone-study.Rmd/Library-sizes-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Visualising the distribution of gene counts in each sample compared to the median value (horizontal blue line) we can see a similar distribution between groups with no clear outliers. <img src="figure/Dexamethasone-study.Rmd/Count-distribution-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The sequence quality appears to be consistently good.</p>
</div>
<div id="an-unbiased-assessment-of-sample-similarity" class="section level2">
<h2>An unbiased assessment of sample similarity</h2>
<p>We then graph samples in a multidimensional scaling plot to assess similarity within groupings and the general structure of the data.</p>
<pre class="r"><code>dimensions.1.2.MDS &lt;- plotMDS(y, dim.plot = c(1, 2), plot = FALSE)
dimensions.3.4.MDS &lt;- plotMDS(y, dim.plot = c(3, 4), plot = FALSE)</code></pre>
<table class="gmisc_table" style="border-collapse: collapse; margin-top: 1em; margin-bottom: 1em;">
<thead>
<tr>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey;">
</th>
<th style="border-bottom: 1px solid grey; border-top: 2px solid grey; text-align: center;">
Group
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">
1
</td>
<td style="background-color: #ffcf6b; text-align: center;">
KO_DEX_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
2
</td>
<td style="background-color: #bd8102; text-align: center;">
KO_DEX_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
3
</td>
<td style="background-color: #fb6a7b; text-align: center;">
KO_SAL_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
4
</td>
<td style="background-color: #b90017; text-align: center;">
KO_SAL_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
5
</td>
<td style="background-color: #82ef65; text-align: center;">
WT_DEX_24H
</td>
</tr>
<tr>
<td style="text-align: left;">
6
</td>
<td style="background-color: #21a400; text-align: center;">
WT_DEX_3H
</td>
</tr>
<tr>
<td style="text-align: left;">
7
</td>
<td style="background-color: #6b8cde; text-align: center;">
WT_SAL_24H
</td>
</tr>
<tr>
<td style="border-bottom: 2px solid grey; text-align: left;">
8
</td>
<td style="background-color: #06319c; border-bottom: 2px solid grey; text-align: center;">
WT_SAL_3H
</td>
</tr>
</tbody>
</table>
<script>/*
* Copyright (C) 2009 Apple Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
*    notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
*    notice, this list of conditions and the following disclaimer in the
*    documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
* PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* Copyright (2016) Duncan Murdoch - fixed CanvasMatrix4.ortho,
* cleaned up.
*/
/*
CanvasMatrix4 class
This class implements a 4x4 matrix. It has functions which
duplicate the functionality of the OpenGL matrix stack and
glut functions.
IDL:
[
Constructor(in CanvasMatrix4 matrix),           // copy passed matrix into new CanvasMatrix4
Constructor(in sequence<float> array)           // create new CanvasMatrix4 with 16 floats (row major)
Constructor()                                   // create new CanvasMatrix4 with identity matrix
]
interface CanvasMatrix4 {
attribute float m11;
attribute float m12;
attribute float m13;
attribute float m14;
attribute float m21;
attribute float m22;
attribute float m23;
attribute float m24;
attribute float m31;
attribute float m32;
attribute float m33;
attribute float m34;
attribute float m41;
attribute float m42;
attribute float m43;
attribute float m44;
void load(in CanvasMatrix4 matrix);                 // copy the values from the passed matrix
void load(in sequence<float> array);                // copy 16 floats into the matrix
sequence<float> getAsArray();                       // return the matrix as an array of 16 floats
WebGLFloatArray getAsCanvasFloatArray();           // return the matrix as a WebGLFloatArray with 16 values
void makeIdentity();                                // replace the matrix with identity
void transpose();                                   // replace the matrix with its transpose
void invert();                                      // replace the matrix with its inverse
void translate(in float x, in float y, in float z); // multiply the matrix by passed translation values on the right
void scale(in float x, in float y, in float z);     // multiply the matrix by passed scale values on the right
void rotate(in float angle,                         // multiply the matrix by passed rotation values on the right
in float x, in float y, in float z);    // (angle is in degrees)
void multRight(in CanvasMatrix matrix);             // multiply the matrix by the passed matrix on the right
void multLeft(in CanvasMatrix matrix);              // multiply the matrix by the passed matrix on the left
void ortho(in float left, in float right,           // multiply the matrix by the passed ortho values on the right
in float bottom, in float top,
in float near, in float far);
void frustum(in float left, in float right,         // multiply the matrix by the passed frustum values on the right
in float bottom, in float top,
in float near, in float far);
void perspective(in float fovy, in float aspect,    // multiply the matrix by the passed perspective values on the right
in float zNear, in float zFar);
void lookat(in float eyex, in float eyey, in float eyez,    // multiply the matrix by the passed lookat
in float ctrx, in float ctry, in float ctrz,    // values on the right
in float upx, in float upy, in float upz);
}
*/
CanvasMatrix4 = function(m)
{
if (typeof m == 'object') {
if ("length" in m && m.length >= 16) {
this.load(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]);
return;
}
else if (m instanceof CanvasMatrix4) {
this.load(m);
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.load = function()
{
if (arguments.length == 1 && typeof arguments[0] == 'object') {
var matrix = arguments[0];
if ("length" in matrix && matrix.length == 16) {
this.m11 = matrix[0];
this.m12 = matrix[1];
this.m13 = matrix[2];
this.m14 = matrix[3];
this.m21 = matrix[4];
this.m22 = matrix[5];
this.m23 = matrix[6];
this.m24 = matrix[7];
this.m31 = matrix[8];
this.m32 = matrix[9];
this.m33 = matrix[10];
this.m34 = matrix[11];
this.m41 = matrix[12];
this.m42 = matrix[13];
this.m43 = matrix[14];
this.m44 = matrix[15];
return;
}
if (arguments[0] instanceof CanvasMatrix4) {
this.m11 = matrix.m11;
this.m12 = matrix.m12;
this.m13 = matrix.m13;
this.m14 = matrix.m14;
this.m21 = matrix.m21;
this.m22 = matrix.m22;
this.m23 = matrix.m23;
this.m24 = matrix.m24;
this.m31 = matrix.m31;
this.m32 = matrix.m32;
this.m33 = matrix.m33;
this.m34 = matrix.m34;
this.m41 = matrix.m41;
this.m42 = matrix.m42;
this.m43 = matrix.m43;
this.m44 = matrix.m44;
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.getAsArray = function()
{
return [
this.m11, this.m12, this.m13, this.m14,
this.m21, this.m22, this.m23, this.m24,
this.m31, this.m32, this.m33, this.m34,
this.m41, this.m42, this.m43, this.m44
];
};
CanvasMatrix4.prototype.getAsWebGLFloatArray = function()
{
return new WebGLFloatArray(this.getAsArray());
};
CanvasMatrix4.prototype.makeIdentity = function()
{
this.m11 = 1;
this.m12 = 0;
this.m13 = 0;
this.m14 = 0;
this.m21 = 0;
this.m22 = 1;
this.m23 = 0;
this.m24 = 0;
this.m31 = 0;
this.m32 = 0;
this.m33 = 1;
this.m34 = 0;
this.m41 = 0;
this.m42 = 0;
this.m43 = 0;
this.m44 = 1;
};
CanvasMatrix4.prototype.transpose = function()
{
var tmp = this.m12;
this.m12 = this.m21;
this.m21 = tmp;
tmp = this.m13;
this.m13 = this.m31;
this.m31 = tmp;
tmp = this.m14;
this.m14 = this.m41;
this.m41 = tmp;
tmp = this.m23;
this.m23 = this.m32;
this.m32 = tmp;
tmp = this.m24;
this.m24 = this.m42;
this.m42 = tmp;
tmp = this.m34;
this.m34 = this.m43;
this.m43 = tmp;
};
CanvasMatrix4.prototype.invert = function()
{
// Calculate the 4x4 determinant
// If the determinant is zero,
// then the inverse matrix is not unique.
var det = this._determinant4x4();
if (Math.abs(det) < 1e-8)
return null;
this._makeAdjoint();
// Scale the adjoint matrix to get the inverse
this.m11 /= det;
this.m12 /= det;
this.m13 /= det;
this.m14 /= det;
this.m21 /= det;
this.m22 /= det;
this.m23 /= det;
this.m24 /= det;
this.m31 /= det;
this.m32 /= det;
this.m33 /= det;
this.m34 /= det;
this.m41 /= det;
this.m42 /= det;
this.m43 /= det;
this.m44 /= det;
};
CanvasMatrix4.prototype.translate = function(x,y,z)
{
if (x === undefined)
x = 0;
if (y === undefined)
y = 0;
if (z === undefined)
z = 0;
var matrix = new CanvasMatrix4();
matrix.m41 = x;
matrix.m42 = y;
matrix.m43 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.scale = function(x,y,z)
{
if (x === undefined)
x = 1;
if (z === undefined) {
if (y === undefined) {
y = x;
z = x;
}
else
z = 1;
}
else if (y === undefined)
y = x;
var matrix = new CanvasMatrix4();
matrix.m11 = x;
matrix.m22 = y;
matrix.m33 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.rotate = function(angle,x,y,z)
{
// angles are in degrees. Switch to radians
angle = angle / 180 * Math.PI;
angle /= 2;
var sinA = Math.sin(angle);
var cosA = Math.cos(angle);
var sinA2 = sinA * sinA;
// normalize
var length = Math.sqrt(x * x + y * y + z * z);
if (length === 0) {
// bad vector, just use something reasonable
x = 0;
y = 0;
z = 1;
} else if (length != 1) {
x /= length;
y /= length;
z /= length;
}
var mat = new CanvasMatrix4();
// optimize case where axis is along major axis
if (x == 1 && y === 0 && z === 0) {
mat.m11 = 1;
mat.m12 = 0;
mat.m13 = 0;
mat.m21 = 0;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 2 * sinA * cosA;
mat.m31 = 0;
mat.m32 = -2 * sinA * cosA;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y == 1 && z === 0) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 0;
mat.m13 = -2 * sinA * cosA;
mat.m21 = 0;
mat.m22 = 1;
mat.m23 = 0;
mat.m31 = 2 * sinA * cosA;
mat.m32 = 0;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y === 0 && z == 1) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 2 * sinA * cosA;
mat.m13 = 0;
mat.m21 = -2 * sinA * cosA;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 0;
mat.m31 = 0;
mat.m32 = 0;
mat.m33 = 1;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else {
var x2 = x*x;
var y2 = y*y;
var z2 = z*z;
mat.m11 = 1 - 2 * (y2 + z2) * sinA2;
mat.m12 = 2 * (x * y * sinA2 + z * sinA * cosA);
mat.m13 = 2 * (x * z * sinA2 - y * sinA * cosA);
mat.m21 = 2 * (y * x * sinA2 - z * sinA * cosA);
mat.m22 = 1 - 2 * (z2 + x2) * sinA2;
mat.m23 = 2 * (y * z * sinA2 + x * sinA * cosA);
mat.m31 = 2 * (z * x * sinA2 + y * sinA * cosA);
mat.m32 = 2 * (z * y * sinA2 - x * sinA * cosA);
mat.m33 = 1 - 2 * (x2 + y2) * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
}
this.multRight(mat);
};
CanvasMatrix4.prototype.multRight = function(mat)
{
var m11 = (this.m11 * mat.m11 + this.m12 * mat.m21 +
this.m13 * mat.m31 + this.m14 * mat.m41);
var m12 = (this.m11 * mat.m12 + this.m12 * mat.m22 +
this.m13 * mat.m32 + this.m14 * mat.m42);
var m13 = (this.m11 * mat.m13 + this.m12 * mat.m23 +
this.m13 * mat.m33 + this.m14 * mat.m43);
var m14 = (this.m11 * mat.m14 + this.m12 * mat.m24 +
this.m13 * mat.m34 + this.m14 * mat.m44);
var m21 = (this.m21 * mat.m11 + this.m22 * mat.m21 +
this.m23 * mat.m31 + this.m24 * mat.m41);
var m22 = (this.m21 * mat.m12 + this.m22 * mat.m22 +
this.m23 * mat.m32 + this.m24 * mat.m42);
var m23 = (this.m21 * mat.m13 + this.m22 * mat.m23 +
this.m23 * mat.m33 + this.m24 * mat.m43);
var m24 = (this.m21 * mat.m14 + this.m22 * mat.m24 +
this.m23 * mat.m34 + this.m24 * mat.m44);
var m31 = (this.m31 * mat.m11 + this.m32 * mat.m21 +
this.m33 * mat.m31 + this.m34 * mat.m41);
var m32 = (this.m31 * mat.m12 + this.m32 * mat.m22 +
this.m33 * mat.m32 + this.m34 * mat.m42);
var m33 = (this.m31 * mat.m13 + this.m32 * mat.m23 +
this.m33 * mat.m33 + this.m34 * mat.m43);
var m34 = (this.m31 * mat.m14 + this.m32 * mat.m24 +
this.m33 * mat.m34 + this.m34 * mat.m44);
var m41 = (this.m41 * mat.m11 + this.m42 * mat.m21 +
this.m43 * mat.m31 + this.m44 * mat.m41);
var m42 = (this.m41 * mat.m12 + this.m42 * mat.m22 +
this.m43 * mat.m32 + this.m44 * mat.m42);
var m43 = (this.m41 * mat.m13 + this.m42 * mat.m23 +
this.m43 * mat.m33 + this.m44 * mat.m43);
var m44 = (this.m41 * mat.m14 + this.m42 * mat.m24 +
this.m43 * mat.m34 + this.m44 * mat.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.multLeft = function(mat)
{
var m11 = (mat.m11 * this.m11 + mat.m12 * this.m21 +
mat.m13 * this.m31 + mat.m14 * this.m41);
var m12 = (mat.m11 * this.m12 + mat.m12 * this.m22 +
mat.m13 * this.m32 + mat.m14 * this.m42);
var m13 = (mat.m11 * this.m13 + mat.m12 * this.m23 +
mat.m13 * this.m33 + mat.m14 * this.m43);
var m14 = (mat.m11 * this.m14 + mat.m12 * this.m24 +
mat.m13 * this.m34 + mat.m14 * this.m44);
var m21 = (mat.m21 * this.m11 + mat.m22 * this.m21 +
mat.m23 * this.m31 + mat.m24 * this.m41);
var m22 = (mat.m21 * this.m12 + mat.m22 * this.m22 +
mat.m23 * this.m32 + mat.m24 * this.m42);
var m23 = (mat.m21 * this.m13 + mat.m22 * this.m23 +
mat.m23 * this.m33 + mat.m24 * this.m43);
var m24 = (mat.m21 * this.m14 + mat.m22 * this.m24 +
mat.m23 * this.m34 + mat.m24 * this.m44);
var m31 = (mat.m31 * this.m11 + mat.m32 * this.m21 +
mat.m33 * this.m31 + mat.m34 * this.m41);
var m32 = (mat.m31 * this.m12 + mat.m32 * this.m22 +
mat.m33 * this.m32 + mat.m34 * this.m42);
var m33 = (mat.m31 * this.m13 + mat.m32 * this.m23 +
mat.m33 * this.m33 + mat.m34 * this.m43);
var m34 = (mat.m31 * this.m14 + mat.m32 * this.m24 +
mat.m33 * this.m34 + mat.m34 * this.m44);
var m41 = (mat.m41 * this.m11 + mat.m42 * this.m21 +
mat.m43 * this.m31 + mat.m44 * this.m41);
var m42 = (mat.m41 * this.m12 + mat.m42 * this.m22 +
mat.m43 * this.m32 + mat.m44 * this.m42);
var m43 = (mat.m41 * this.m13 + mat.m42 * this.m23 +
mat.m43 * this.m33 + mat.m44 * this.m43);
var m44 = (mat.m41 * this.m14 + mat.m42 * this.m24 +
mat.m43 * this.m34 + mat.m44 * this.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.ortho = function(left, right, bottom, top, near, far)
{
var tx = (left + right) / (left - right);
var ty = (top + bottom) / (bottom - top);
var tz = (far + near) / (near - far);
var matrix = new CanvasMatrix4();
matrix.m11 = 2 / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = 0;
matrix.m32 = 0;
matrix.m33 = -2 / (far - near);
matrix.m34 = 0;
matrix.m41 = tx;
matrix.m42 = ty;
matrix.m43 = tz;
matrix.m44 = 1;
this.multRight(matrix);
};
CanvasMatrix4.prototype.frustum = function(left, right, bottom, top, near, far)
{
var matrix = new CanvasMatrix4();
var A = (right + left) / (right - left);
var B = (top + bottom) / (top - bottom);
var C = -(far + near) / (far - near);
var D = -(2 * far * near) / (far - near);
matrix.m11 = (2 * near) / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 * near / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = A;
matrix.m32 = B;
matrix.m33 = C;
matrix.m34 = -1;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = D;
matrix.m44 = 0;
this.multRight(matrix);
};
CanvasMatrix4.prototype.perspective = function(fovy, aspect, zNear, zFar)
{
var top = Math.tan(fovy * Math.PI / 360) * zNear;
var bottom = -top;
var left = aspect * bottom;
var right = aspect * top;
this.frustum(left, right, bottom, top, zNear, zFar);
};
CanvasMatrix4.prototype.lookat = function(eyex, eyey, eyez, centerx, centery, centerz, upx, upy, upz)
{
var matrix = new CanvasMatrix4();
// Make rotation matrix
// Z vector
var zx = eyex - centerx;
var zy = eyey - centery;
var zz = eyez - centerz;
var mag = Math.sqrt(zx * zx + zy * zy + zz * zz);
if (mag) {
zx /= mag;
zy /= mag;
zz /= mag;
}
// Y vector
var yx = upx;
var yy = upy;
var yz = upz;
// X vector = Y cross Z
xx =  yy * zz - yz * zy;
xy = -yx * zz + yz * zx;
xz =  yx * zy - yy * zx;
// Recompute Y = Z cross X
yx = zy * xz - zz * xy;
yy = -zx * xz + zz * xx;
yx = zx * xy - zy * xx;
// cross product gives area of parallelogram, which is < 1.0 for
// non-perpendicular unit-length vectors; so normalize x, y here
mag = Math.sqrt(xx * xx + xy * xy + xz * xz);
if (mag) {
xx /= mag;
xy /= mag;
xz /= mag;
}
mag = Math.sqrt(yx * yx + yy * yy + yz * yz);
if (mag) {
yx /= mag;
yy /= mag;
yz /= mag;
}
matrix.m11 = xx;
matrix.m12 = xy;
matrix.m13 = xz;
matrix.m14 = 0;
matrix.m21 = yx;
matrix.m22 = yy;
matrix.m23 = yz;
matrix.m24 = 0;
matrix.m31 = zx;
matrix.m32 = zy;
matrix.m33 = zz;
matrix.m34 = 0;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = 0;
matrix.m44 = 1;
matrix.translate(-eyex, -eyey, -eyez);
this.multRight(matrix);
};
// Support functions
CanvasMatrix4.prototype._determinant2x2 = function(a, b, c, d)
{
return a * d - b * c;
};
CanvasMatrix4.prototype._determinant3x3 = function(a1, a2, a3, b1, b2, b3, c1, c2, c3)
{
return a1 * this._determinant2x2(b2, b3, c2, c3) -
b1 * this._determinant2x2(a2, a3, c2, c3) +
c1 * this._determinant2x2(a2, a3, b2, b3);
};
CanvasMatrix4.prototype._determinant4x4 = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
return a1 * this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4) -
b1 * this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4) +
c1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4) -
d1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
};
CanvasMatrix4.prototype._makeAdjoint = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
// Row column labeling reversed since we transpose rows & columns
this.m11  =   this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4);
this.m21  = - this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4);
this.m31  =   this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4);
this.m41  = - this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
this.m12  = - this._determinant3x3(b1, b3, b4, c1, c3, c4, d1, d3, d4);
this.m22  =   this._determinant3x3(a1, a3, a4, c1, c3, c4, d1, d3, d4);
this.m32  = - this._determinant3x3(a1, a3, a4, b1, b3, b4, d1, d3, d4);
this.m42  =   this._determinant3x3(a1, a3, a4, b1, b3, b4, c1, c3, c4);
this.m13  =   this._determinant3x3(b1, b2, b4, c1, c2, c4, d1, d2, d4);
this.m23  = - this._determinant3x3(a1, a2, a4, c1, c2, c4, d1, d2, d4);
this.m33  =   this._determinant3x3(a1, a2, a4, b1, b2, b4, d1, d2, d4);
this.m43  = - this._determinant3x3(a1, a2, a4, b1, b2, b4, c1, c2, c4);
this.m14  = - this._determinant3x3(b1, b2, b3, c1, c2, c3, d1, d2, d3);
this.m24  =   this._determinant3x3(a1, a2, a3, c1, c2, c3, d1, d2, d3);
this.m34  = - this._determinant3x3(a1, a2, a3, b1, b2, b3, d1, d2, d3);
this.m44  =   this._determinant3x3(a1, a2, a3, b1, b2, b3, c1, c2, c3);
};</script>
<script>// To generate the help pages for this library, use
// jsdoc --destination ../../../doc/rglwidgetClass --template ~/node_modules/jsdoc-baseline rglClass.src.js
// To validate, use
// setwd(".../inst/htmlwidgets/lib/rglClass")
// hints <- js::jshint(readLines("rglClass.src.js"))
// hints[, c("line", "reason")]
/**
* The class of an rgl widget
* @class
*/
rglwidgetClass = function() {
this.canvas = null;
this.userMatrix = new CanvasMatrix4();
this.types = [];
this.prMatrix = new CanvasMatrix4();
this.mvMatrix = new CanvasMatrix4();
this.vp = null;
this.prmvMatrix = null;
this.origs = null;
this.gl = null;
this.scene = null;
this.select = {state: "inactive", subscene: null, region: {p1: {x:0, y:0}, p2: {x:0, y:0}}};
this.drawing = false;
};
/**
* Multiply matrix by vector
* @returns {number[]}
* @param M {number[][]} Left operand
* @param v {number[]} Right operand
*/
rglwidgetClass.prototype.multMV = function(M, v) {
return [ M.m11 * v[0] + M.m12 * v[1] + M.m13 * v[2] + M.m14 * v[3],
M.m21 * v[0] + M.m22 * v[1] + M.m23 * v[2] + M.m24 * v[3],
M.m31 * v[0] + M.m32 * v[1] + M.m33 * v[2] + M.m34 * v[3],
M.m41 * v[0] + M.m42 * v[1] + M.m43 * v[2] + M.m44 * v[3]
];
};
/**
* Multiply row vector by Matrix
* @returns {number[]}
* @param v {number[]} left operand
* @param M {number[][]} right operand
*/
rglwidgetClass.prototype.multVM = function(v, M) {
return [ M.m11 * v[0] + M.m21 * v[1] + M.m31 * v[2] + M.m41 * v[3],
M.m12 * v[0] + M.m22 * v[1] + M.m32 * v[2] + M.m42 * v[3],
M.m13 * v[0] + M.m23 * v[1] + M.m33 * v[2] + M.m43 * v[3],
M.m14 * v[0] + M.m24 * v[1] + M.m34 * v[2] + M.m44 * v[3]
];
};
/**
* Euclidean length of a vector
* @returns {number}
* @param v {number[]}
*/
rglwidgetClass.prototype.vlen = function(v) {
return Math.sqrt(this.dotprod(v, v));
};
/**
* Dot product of two vectors
* @instance rglwidgetClass
* @returns {number}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.dotprod = function(a, b) {
return a[0]*b[0] + a[1]*b[1] + a[2]*b[2];
};
/**
* Cross product of two vectors
* @returns {number[]}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
};
/**
* Bind vectors or matrices by columns
* @returns {number[][]}
* @param a {number[]|number[][]}
* @param b {number[]|number[][]}
*/
rglwidgetClass.prototype.cbind = function(a, b) {
if (b.length < a.length)
b = this.repeatToLen(b, a.length);
else if (a.length < b.length)
a = this.repeatToLen(a, b.length);
return a.map(function(currentValue, index, array) {
return currentValue.concat(b[index]);
});
};
/**
* Swap elements
* @returns {any[]}
* @param a {any[]}
* @param i {number} Element to swap
* @param j {number} Other element to swap
*/
rglwidgetClass.prototype.swap = function(a, i, j) {
var temp = a[i];
a[i] = a[j];
a[j] = temp;
};
/**
* Flatten a matrix into a vector
* @returns {any[]}
* @param a {any[][]}
*/
rglwidgetClass.prototype.flatten = function(arr, result) {
var value;
if (typeof result === "undefined") result = [];
for (var i = 0, length = arr.length; i < length; i++) {
value = arr[i];
if (Array.isArray(value)) {
this.flatten(value, result);
} else {
result.push(value);
}
}
return result;
};
/**
* set element of 1d or 2d array as if it was flattened.
* Column major, zero based!
* @returns {any[]|any[][]}
* @param {any[]|any[][]} a - array
* @param {number} i - element
* @param {any} value
*/
rglwidgetClass.prototype.setElement = function(a, i, value) {
if (Array.isArray(a[0])) {
var dim = a.length,
col = Math.floor(i/dim),
row = i % dim;
a[row][col] = value;
} else {
a[i] = value;
}
};
/**
* Transpose an array
* @returns {any[][]}
* @param {any[][]} a
*/
rglwidgetClass.prototype.transpose = function(a) {
var newArray = [],
n = a.length,
m = a[0].length,
i;
for(i = 0; i < m; i++){
newArray.push([]);
}
for(i = 0; i < n; i++){
for(var j = 0; j < m; j++){
newArray[j].push(a[i][j]);
}
}
return newArray;
};
/**
* Calculate sum of squares of a numeric vector
* @returns {number}
* @param {number[]} x
*/
rglwidgetClass.prototype.sumsq = function(x) {
var result = 0, i;
for (i=0; i < x.length; i++)
result += x[i]*x[i];
return result;
};
/**
* Convert a matrix to a CanvasMatrix4
* @returns {CanvasMatrix4}
* @param {number[][]|number[]} mat
*/
rglwidgetClass.prototype.toCanvasMatrix4 = function(mat) {
if (mat instanceof CanvasMatrix4)
return mat;
var result = new CanvasMatrix4();
mat = this.flatten(this.transpose(mat));
result.load(mat);
return result;
};
/**
* Convert an R-style numeric colour string to an rgb vector
* @returns {number[]}
* @param {string} s
*/
rglwidgetClass.prototype.stringToRgb = function(s) {
s = s.replace("#", "");
var bigint = parseInt(s, 16);
return [((bigint >> 16) & 255)/255,
((bigint >> 8) & 255)/255,
(bigint & 255)/255];
};
/**
* Take a component-by-component product of two 3 vectors
* @returns {number[]}
* @param {number[]} x
* @param {number[]} y
*/
rglwidgetClass.prototype.componentProduct = function(x, y) {
if (typeof y === "undefined") {
this.alertOnce("Bad arg to componentProduct");
}
var result = new Float32Array(3), i;
for (i = 0; i<3; i++)
result[i] = x[i]*y[i];
return result;
};
/**
* Get next higher power of two
* @returns { number }
* @param { number } value - input value
*/
rglwidgetClass.prototype.getPowerOfTwo = function(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
};
/**
* Unique entries
* @returns { any[] }
* @param { any[] } arr - An array
*/
rglwidgetClass.prototype.unique = function(arr) {
arr = [].concat(arr);
return arr.filter(function(value, index, self) {
return self.indexOf(value) === index;
});
};
/**
* Shallow compare of arrays
* @returns { boolean }
* @param { any[] } a - An array
* @param { any[] } b - Another array
*/
rglwidgetClass.prototype.equalArrays = function(a, b) {
return a === b || (a && b &&
a.length === b.length &&
a.every(function(v, i) {return v === b[i];}));
};
/**
* Repeat an array to a desired length
* @returns {any[]}
* @param {any | any[]} arr The input array
* @param {number} len The desired output length
*/
rglwidgetClass.prototype.repeatToLen = function(arr, len) {
arr = [].concat(arr);
while (arr.length < len/2)
arr = arr.concat(arr);
return arr.concat(arr.slice(0, len - arr.length));
};
/**
* Give a single alert message, not to be repeated.
* @param {string} msg  The message to give.
*/
rglwidgetClass.prototype.alertOnce = function(msg) {
if (typeof this.alerted !== "undefined")
return;
this.alerted = true;
alert(msg);
};
rglwidgetClass.prototype.f_is_lit = 1;
rglwidgetClass.prototype.f_is_smooth = 2;
rglwidgetClass.prototype.f_has_texture = 4;
rglwidgetClass.prototype.f_depth_sort = 8;
rglwidgetClass.prototype.f_fixed_quads = 16;
rglwidgetClass.prototype.f_is_transparent = 32;
rglwidgetClass.prototype.f_is_lines = 64;
rglwidgetClass.prototype.f_sprites_3d = 128;
rglwidgetClass.prototype.f_sprite_3d = 256;
rglwidgetClass.prototype.f_is_subscene = 512;
rglwidgetClass.prototype.f_is_clipplanes = 1024;
rglwidgetClass.prototype.f_fixed_size = 2048;
rglwidgetClass.prototype.f_is_points = 4096;
rglwidgetClass.prototype.f_is_twosided = 8192;
rglwidgetClass.prototype.f_fat_lines = 16384;
rglwidgetClass.prototype.f_is_brush = 32768;
/**
* Which list does a particular id come from?
* @returns { string }
* @param {number} id The id to look up.
*/
rglwidgetClass.prototype.whichList = function(id) {
var obj = this.getObj(id),
flags = obj.flags;
if (obj.type === "light")
return "lights";
if (flags & this.f_is_subscene)
return "subscenes";
if (flags & this.f_is_clipplanes)
return "clipplanes";
if (flags & this.f_is_transparent)
return "transparent";
return "opaque";
};
/**
* Get an object by id number.
* @returns { Object }
* @param {number} id
*/
rglwidgetClass.prototype.getObj = function(id) {
if (typeof id !== "number") {
this.alertOnce("getObj id is "+typeof id);
}
return this.scene.objects[id];
};
/**
* Get ids of a particular type from a subscene or the whole scene
* @returns { number[] }
* @param {string} type What type of object?
* @param {number} subscene  Which subscene?  If not given, find in the whole scene
*/
rglwidgetClass.prototype.getIdsByType = function(type, subscene) {
var
result = [], i, self = this;
if (typeof subscene === "undefined") {
Object.keys(this.scene.objects).forEach(
function(key) {
key = parseInt(key, 10);
if (self.getObj(key).type === type)
result.push(key);
});
} else {
ids = this.getObj(subscene).objects;
for (i=0; i < ids.length; i++) {
if (this.getObj(ids[i]).type === type) {
result.push(ids[i]);
}
}
}
return result;
};
/**
* Get a particular material property for an id
* @returns { any }
* @param {number} id  Which object?
* @param {string} property Which material property?
*/
rglwidgetClass.prototype.getMaterial = function(id, property) {
var obj = this.getObj(id), mat;
if (typeof obj.material === "undefined")
console.error("material undefined");
mat = obj.material[property];
if (typeof mat === "undefined")
mat = this.scene.material[property];
return mat;
};
/**
* Is a particular id in a subscene?
* @returns { boolean }
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.inSubscene = function(id, subscene) {
return this.getObj(subscene).objects.indexOf(id) > -1;
};
/**
* Add an id to a subscene.
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.addToSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
ids = [id],
obj = this.getObj(id), i;
if (typeof obj != "undefined" && typeof (obj.newIds) !== "undefined") {
ids = ids.concat(obj.newIds);
}
thesub.objects = [].concat(thesub.objects);
for (i = 0; i < ids.length; i++) {
id = ids[i];
if (thesub.objects.indexOf(id) == -1) {
thelist = this.whichList(id);
thesub.objects.push(id);
thesub[thelist].push(id);
}
}
};
/**
* Delete an id from a subscene
* @param { number } id - the id to add
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.delFromSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
obj = this.getObj(id),
ids = [id], i;
if (typeof obj !== "undefined" && typeof (obj.newIds) !== "undefined")
ids = ids.concat(obj.newIds);
thesub.objects = [].concat(thesub.objects); // It might be a scalar
for (j=0; j<ids.length;j++) {
id = ids[j];
i = thesub.objects.indexOf(id);
if (i > -1) {
thesub.objects.splice(i, 1);
thelist = this.whichList(id);
i = thesub[thelist].indexOf(id);
thesub[thelist].splice(i, 1);
}
}
};
/**
* Set the ids in a subscene
* @param { number[] } ids - the ids to set
* @param { number } subsceneid - the id of the subscene
*/
rglwidgetClass.prototype.setSubsceneEntries = function(ids, subsceneid) {
var sub = this.getObj(subsceneid);
sub.objects = ids;
this.initSubscene(subsceneid);
};
/**
* Get the ids in a subscene
* @returns {number[]}
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getSubsceneEntries = function(subscene) {
return this.getObj(subscene).objects;
};
/**
* Get the ids of the subscenes within a subscene
* @returns { number[] }
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getChildSubscenes = function(subscene) {
return this.getObj(subscene).subscenes;
};
/**
* Start drawing
* @returns { boolean } Previous state
*/
rglwidgetClass.prototype.startDrawing = function() {
var value = this.drawing;
this.drawing = true;
return value;
};
/**
* Stop drawing and check for context loss
* @param { boolean } saved - Previous state
*/
rglwidgetClass.prototype.stopDrawing = function(saved) {
this.drawing = saved;
if (!saved && this.gl && this.gl.isContextLost())
this.restartCanvas();
};
/**
* Generate the vertex shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getVertexShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userVertexShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
nclipplanes = this.countClipplanes(),
fixed_size = flags & this.f_fixed_size,
is_points = flags & this.f_is_points,
is_twosided = flags & this.f_is_twosided,
fat_lines = flags & this.f_fat_lines,
is_brush = flags & this.f_is_brush,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
result = "  /* ****** "+type+" object "+id+" vertex shader ****** */\n"+
"  attribute vec3 aPos;\n"+
"  attribute vec4 aCol;\n"+
" uniform mat4 mvMatrix;\n"+
" uniform mat4 prMatrix;\n"+
" varying vec4 vCol;\n"+
" varying vec4 vPosition;\n";
if ((is_lit && !fixed_quads && !is_brush) || sprite_3d)
result = result + "  attribute vec3 aNorm;\n"+
" uniform mat4 normMatrix;\n"+
" varying vec3 vNormal;\n";
if (has_texture || type === "text")
result = result + " attribute vec2 aTexcoord;\n"+
" varying vec2 vTexcoord;\n";
if (fixed_size)
result = result + "  uniform vec2 textScale;\n";
if (fixed_quads)
result = result + "  attribute vec2 aOfs;\n";
else if (sprite_3d)
result = result + "  uniform vec3 uOrig;\n"+
"  uniform float uSize;\n"+
"  uniform mat4 usermat;\n";
if (is_twosided)
result = result + "  attribute vec3 aPos1;\n"+
"  attribute vec3 aPos2;\n"+
"  varying float normz;\n";
if (fat_lines) {
result = result +   "  attribute vec3 aNext;\n"+
"  attribute vec2 aPoint;\n"+
"  varying vec2 vPoint;\n"+
"  varying float vLength;\n"+
"  uniform float uAspect;\n"+
"  uniform float uLwd;\n";
}
result = result + "  void main(void) {\n";
if ((nclipplanes || (!fixed_quads && !sprite_3d)) && !is_brush)
result = result + "    vPosition = mvMatrix * vec4(aPos, 1.);\n";
if (!fixed_quads && !sprite_3d && !is_brush)
result = result + "    gl_Position = prMatrix * vPosition;\n";
if (is_points) {
var size = this.getMaterial(id, "size");
result = result + "    gl_PointSize = "+size.toFixed(1)+";\n";
}
result = result + "    vCol = aCol;\n";
if (is_lit && !fixed_quads && !sprite_3d && !is_brush)
result = result + "    vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n";
if (has_texture || type == "text")
result = result + "    vTexcoord = aTexcoord;\n";
if (fixed_size)
result = result + "    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w;\n"+
"   gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n";
if (type == "sprites" && !fixed_size)
result = result + "    vec4 pos = mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w + vec4(aOfs, 0., 0.);\n"+
"   gl_Position = prMatrix*pos;\n";
if (sprite_3d)
result = result + "   vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n"+
"   vec4 pos = mvMatrix * vec4(uOrig, 1.);\n"+
"   vPosition = pos/pos.w + vec4(uSize*(vec4(aPos, 1.)*usermat).xyz,0.);\n"+
"   gl_Position = prMatrix * vPosition;\n";
if (is_twosided)
result = result + "   vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n"+
"   pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n"+
"   vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n"+
"   pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n"+
"   normz = pos1.x*pos2.y - pos1.y*pos2.x;\n";
if (fat_lines) 
/* This code was inspired by Matt Deslauriers' code in https://mattdesl.svbtle.com/drawing-lines-is-hard */
result = result + "   vec2 aspectVec = vec2(uAspect, 1.0);\n"+
"   mat4 projViewModel = prMatrix * mvMatrix;\n"+
"   vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n"+
"   currentProjected = currentProjected/currentProjected.w;\n"+
"   vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n"+
"   vec2 currentScreen = currentProjected.xy * aspectVec;\n"+
"   vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n"+
"   float len = uLwd;\n"+
"   vec2 dir = vec2(1.0, 0.0);\n"+
"   vPoint = aPoint;\n"+
"   vLength = length(nextScreen - currentScreen)/2.0;\n"+
"   vLength = vLength/(vLength + len);\n"+
"   if (vLength > 0.0) {\n"+
"     dir = normalize(nextScreen - currentScreen);\n"+
"   }\n"+
"   vec2 normal = vec2(-dir.y, dir.x);\n"+
"   dir.x /= uAspect;\n"+
"   normal.x /= uAspect;\n"+
"   vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n"+
"   gl_Position = currentProjected + offset;\n";
if (is_brush)
result = result + "   gl_Position = vec4(aPos, 1.);\n";
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Generate the fragment shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getFragmentShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userFragmentShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
is_twosided = (flags & this.f_is_twosided) > 0,
fat_lines = flags & this.f_fat_lines,
is_transparent = flags & this.f_is_transparent,
nclipplanes = this.countClipplanes(), i,
texture_format, nlights,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
if (has_texture)
texture_format = this.getMaterial(id, "textype");
result = "/* ****** "+type+" object "+id+" fragment shader ****** */\n"+
"#ifdef GL_ES\n"+
"#ifdef GL_FRAGMENT_PRECISION_HIGH\n"+
"  precision highp float;\n"+
"#else\n"+
"  precision mediump float;\n"+
"#endif\n"+
"#endif\n"+
"  varying vec4 vCol; // carries alpha\n"+
"  varying vec4 vPosition;\n";
if (has_texture || type === "text")
result = result + "  varying vec2 vTexcoord;\n"+
" uniform sampler2D uSampler;\n";
if (is_lit && !fixed_quads)
result = result + "  varying vec3 vNormal;\n";
for (i = 0; i < nclipplanes; i++)
result = result + "  uniform vec4 vClipplane"+i+";\n";
if (is_lit) {
nlights = this.countLights();
if (nlights)
result = result + "  uniform mat4 mvMatrix;\n";
else
is_lit = false;
}
if (is_lit) {
result = result + "   uniform vec3 emission;\n"+
"   uniform float shininess;\n";
for (i=0; i < nlights; i++) {
result = result + "   uniform vec3 ambient" + i + ";\n"+
"   uniform vec3 specular" + i +"; // light*material\n"+
"   uniform vec3 diffuse" + i + ";\n"+
"   uniform vec3 lightDir" + i + ";\n"+
"   uniform bool viewpoint" + i + ";\n"+
"   uniform bool finite" + i + ";\n";
}
}
if (is_twosided)
result = result + "   uniform bool front;\n"+
"   varying float normz;\n";
if (fat_lines)
result = result + "   varying vec2 vPoint;\n"+
"   varying float vLength;\n";
result = result + "  void main(void) {\n";
if (fat_lines) {
result = result + "    vec2 point = vPoint;\n"+
"    bool neg = point.y < 0.0;\n"+
"    point.y = neg ? "+
"      (point.y + vLength)/(1.0 - vLength) :\n"+
"     -(point.y - vLength)/(1.0 - vLength);\n";
if (is_transparent && type == "linestrip")
result = result+"    if (neg && length(point) <= 1.0) discard;\n";
result = result + "    point.y = min(point.y, 0.0);\n"+
"    if (length(point) > 1.0) discard;\n";
}
for (i=0; i < nclipplanes;i++)
result = result + "    if (dot(vPosition, vClipplane"+i+") < 0.0) discard;\n";
if (fixed_quads) {
result = result +   "    vec3 n = vec3(0., 0., 1.);\n";
} else if (is_lit) {
result = result +   "    vec3 n = normalize(vNormal);\n";
}
if (is_twosided) {
result = result +   "    if ((normz <= 0.) != front) discard;\n";
}
if (is_lit) {
result = result + "    vec3 eye = normalize(-vPosition.xyz);\n"+
"   vec3 lightdir;\n"+
"   vec4 colDiff;\n"+
"   vec3 halfVec;\n"+
"   vec4 lighteffect = vec4(emission, 0.);\n"+
"   vec3 col;\n"+
"   float nDotL;\n";
if (!fixed_quads) {
result = result +   "   n = -faceforward(n, n, eye);\n";
}
for (i=0; i < nlights; i++) {
result = result + "   colDiff = vec4(vCol.rgb * diffuse" + i + ", vCol.a);\n"+
"   lightdir = lightDir" + i + ";\n"+
"   if (!viewpoint" + i +")\n"+
"     lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n"+
"   if (!finite" + i + ") {\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   } else {\n"+
"     lightdir = normalize(lightdir - vPosition.xyz);\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   }\n"+
"    col = ambient" + i + ";\n"+
"   nDotL = dot(n, lightdir);\n"+
"   col = col + max(nDotL, 0.) * colDiff.rgb;\n"+
"   col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular" + i + ";\n"+
"   lighteffect = lighteffect + vec4(col, colDiff.a);\n";
}
} else {
result = result +   "   vec4 colDiff = vCol;\n"+
"    vec4 lighteffect = colDiff;\n";
}
if (type === "text")
result = result +   "    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n";
if (has_texture) {
result = result + {
rgb:            "   vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n",
rgba:           "   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n",
alpha:          "   vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n"+
"   textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n",
luminance:      "   vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n",
"luminance.alpha":"    vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n"+
"   textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n"
}[texture_format]+
"   gl_FragColor = textureColor;\n";
} else if (type === "text") {
result = result +   "    if (textureColor.a < 0.1)\n"+
"     discard;\n"+
"   else\n"+
"     gl_FragColor = textureColor;\n";
} else
result = result +   "   gl_FragColor = lighteffect;\n";
//if (fat_lines)
//  result = result +   "   gl_FragColor = vec4(0.0, abs(point.x), abs(point.y), 1.0);"
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Call gl functions to create and compile shader
* @returns {Object}
* @param { number } shaderType - gl code for shader type
* @param { string } code - code for the shader
*/
rglwidgetClass.prototype.getShader = function(shaderType, code) {
var gl = this.gl, shader;
shader = gl.createShader(shaderType);
gl.shaderSource(shader, code);
gl.compileShader(shader);
if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost())
alert(gl.getShaderInfoLog(shader));
return shader;
};
/**
* Handle a texture after its image has been loaded
* @param { Object } texture - the gl texture object
* @param { Object } textureCanvas - the canvas holding the image
*/
rglwidgetClass.prototype.handleLoadedTexture = function(texture, textureCanvas) {
var gl = this.gl || this.initGL();
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.generateMipmap(gl.TEXTURE_2D);
gl.bindTexture(gl.TEXTURE_2D, null);
};
/**
* Get maximum dimension of texture in current browser.
* @returns {number}
*/
rglwidgetClass.prototype.getMaxTexSize = function() {
var gl = this.gl || this.initGL();  
return Math.min(4096, gl.getParameter(gl.MAX_TEXTURE_SIZE));
};
/**
* Load an image to a texture
* @param { string } uri - The image location
* @param { Object } texture - the gl texture object
*/
rglwidgetClass.prototype.loadImageToTexture = function(uri, texture) {
var canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
image = new Image(),
self = this;
image.onload = function() {
var w = image.width,
h = image.height,
canvasX = self.getPowerOfTwo(w),
canvasY = self.getPowerOfTwo(h),
gl = self.gl || self.initGL(),
maxTexSize = self.getMaxTexSize();
while (canvasX > 1 && canvasY > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
canvasX /= 2;
canvasY /= 2;
}
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
self.handleLoadedTexture(texture, canvas);
self.drawScene();
};
image.src = uri;
};
/**
* Draw text to the texture canvas
* @returns { Object } object with text measurements
* @param { string } text - the text
* @param { number } cex - expansion
* @param { string } family - font family
* @param { number } font - font number
*/
rglwidgetClass.prototype.drawTextToCanvas = function(text, cex, family, font) {
var canvasX, canvasY,
textY,
scaling = 20,
textColour = "white",
backgroundColour = "rgba(0,0,0,0)",
canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
i, textHeight = 0, textHeights = [], width, widths = [], 
offsetx, offsety = 0, line, lines = [], offsetsx = [],
offsetsy = [], lineoffsetsy = [], fontStrings = [],
maxTexSize = this.getMaxTexSize(),
getFontString = function(i) {
textHeights[i] = scaling*cex[i];
var fontString = textHeights[i] + "px",
family0 = family[i],
font0 = font[i];
if (family0 === "sans")
family0 = "sans-serif";
else if (family0 === "mono")
family0 = "monospace";
fontString = fontString + " " + family0;
if (font0 === 2 || font0 === 4)
fontString = "bold " + fontString;
if (font0 === 3 || font0 === 4)
fontString = "italic " + fontString;
return fontString;
};
cex = this.repeatToLen(cex, text.length);
family = this.repeatToLen(family, text.length);
font = this.repeatToLen(font, text.length);
canvasX = 1;
line = -1;
offsetx = maxTexSize;
for (i = 0; i < text.length; i++)  {
ctx.font = fontStrings[i] = getFontString(i);
width = widths[i] = ctx.measureText(text[i]).width;
if (offsetx + width > maxTexSize) {
line += 1;
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
if (offsety > maxTexSize)
console.error("Too many strings for texture.");
textHeight = 0;
offsetx = 0;
}
textHeight = Math.max(textHeight, textHeights[i]);
offsetsx[i] = offsetx;
offsetx += width;
canvasX = Math.max(canvasX, offsetx);
lines[i] = line;
}
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
for (i = 0; i < text.length; i++) {
offsetsy[i] = lineoffsetsy[lines[i]];
}
canvasX = this.getPowerOfTwo(canvasX);
canvasY = this.getPowerOfTwo(offsety);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.textBaseline = "alphabetic";
for(i = 0; i < text.length; i++) {
ctx.font = fontStrings[i];
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.fillText(text[i], offsetsx[i],  offsetsy[i]);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeights:textHeights,
offsetsx:offsetsx, offsetsy:offsetsy};
};
/**
* Set the gl viewport and scissor test
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setViewport = function(id) {
var gl = this.gl || this.initGL(),
vp = this.getObj(id).par3d.viewport,
x = vp.x*this.canvas.width,
y = vp.y*this.canvas.height,
width = vp.width*this.canvas.width,
height = vp.height*this.canvas.height;
this.vp = {x:x, y:y, width:width, height:height};
gl.viewport(x, y, width, height);
gl.scissor(x, y, width, height);
gl.enable(gl.SCISSOR_TEST);
};
/**
* Set the projection matrix for a subscene
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setprMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.projection;
if (embedding === "replace")
this.prMatrix.makeIdentity();
else
this.setprMatrix(subscene.parent);
if (embedding === "inherit")
return;
// This is based on the Frustum::enclose code from geom.cpp
var bbox = subscene.par3d.bbox,
scale = subscene.par3d.scale,
ranges = [(bbox[1]-bbox[0])*scale[0]/2,
(bbox[3]-bbox[2])*scale[1]/2,
(bbox[5]-bbox[4])*scale[2]/2],
radius = Math.sqrt(this.sumsq(ranges))*1.1; // A bit bigger to handle labels
if (radius <= 0) radius = 1;
var observer = subscene.par3d.observer,
distance = observer[2],
FOV = subscene.par3d.FOV, ortho = FOV === 0,
t = ortho ? 1 : Math.tan(FOV*Math.PI/360),
near = distance - radius,
far = distance + radius,
hlen,
aspect = this.vp.width/this.vp.height,
z = subscene.par3d.zoom,
userProjection = subscene.par3d.userProjection;
if (far < 0.0)
far = 1.0;
if (near < far/100.0)
near = far/100.0;
hlen = t*near;
if (ortho) {
if (aspect > 1)
this.prMatrix.ortho(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.ortho(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
} else {
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
}
this.prMatrix.multRight(userProjection);
};
/**
* Set the model-view matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmvMatrix = function(id) {
var observer = this.getObj(id).par3d.observer;
this.mvMatrix.makeIdentity();
this.setmodelMatrix(id);
this.mvMatrix.translate(-observer[0], -observer[1], -observer[2]);
};
/**
* Set the model matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmodelMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.model;
if (embedding !== "inherit") {
var scale = subscene.par3d.scale,
bbox = subscene.par3d.bbox,
center = [(bbox[0]+bbox[1])/2,
(bbox[2]+bbox[3])/2,
(bbox[4]+bbox[5])/2];
this.mvMatrix.translate(-center[0], -center[1], -center[2]);
this.mvMatrix.scale(scale[0], scale[1], scale[2]);
this.mvMatrix.multRight( subscene.par3d.userMatrix );
}
if (embedding !== "replace")
this.setmodelMatrix(subscene.parent);
};
/**
* Set the normals matrix for a subscene
* @param { number } subsceneid - id of the subscene
*/
rglwidgetClass.prototype.setnormMatrix = function(subsceneid) {
var self = this,
recurse = function(id) {
var sub = self.getObj(id),
embedding = sub.embeddings.model;
if (embedding !== "inherit") {
var scale = sub.par3d.scale;
self.normMatrix.scale(1/scale[0], 1/scale[1], 1/scale[2]);
self.normMatrix.multRight(sub.par3d.userMatrix);
}
if (embedding !== "replace")
recurse(sub.parent);
};
self.normMatrix.makeIdentity();
recurse(subsceneid);
};
/**
* Set the combined projection-model-view matrix
*/
rglwidgetClass.prototype.setprmvMatrix = function() {
this.prmvMatrix = new CanvasMatrix4( this.mvMatrix );
this.prmvMatrix.multRight( this.prMatrix );
};
/**
* Count clipping planes in a scene
* @returns {number}
*/
rglwidgetClass.prototype.countClipplanes = function() {
return this.countObjs("clipplanes");
};
/**
* Count lights in a scene
* @returns { number }
*/
rglwidgetClass.prototype.countLights = function() {
return this.countObjs("light");
};
/**
* Count objects of specific type in a scene
* @returns { number }
* @param { string } type - Type of object to count
*/
rglwidgetClass.prototype.countObjs = function(type) {
var self = this,
bound = 0;
Object.keys(this.scene.objects).forEach(
function(key) {
if (self.getObj(parseInt(key, 10)).type === type)
bound = bound + 1;
});
return bound;
};
/**
* Initialize a subscene
* @param { number } id - id of subscene.
*/
rglwidgetClass.prototype.initSubscene = function(id) {
var sub = this.getObj(id),
i, obj;
if (sub.type !== "subscene")
return;
sub.par3d.userMatrix = this.toCanvasMatrix4(sub.par3d.userMatrix);
sub.par3d.userProjection = this.toCanvasMatrix4(sub.par3d.userProjection);
sub.par3d.userProjection.transpose();
sub.par3d.listeners = [].concat(sub.par3d.listeners);
sub.backgroundId = undefined;
sub.subscenes = [];
sub.clipplanes = [];
sub.transparent = [];
sub.opaque = [];
sub.lights = [];
for (i=0; i < sub.objects.length; i++) {
obj = this.getObj(sub.objects[i]);
if (typeof obj === "undefined") {
sub.objects.splice(i, 1);
i--;
} else if (obj.type === "background")
sub.backgroundId = obj.id;
else
sub[this.whichList(obj.id)].push(obj.id);
}
};
/**
* Copy object
* @param { number } id - id of object to copy
* @param { string } reuse - Document id of scene to reuse
*/
rglwidgetClass.prototype.copyObj = function(id, reuse) {
var obj = this.getObj(id),
prev = document.getElementById(reuse);
if (prev !== null) {
prev = prev.rglinstance;
var
prevobj = prev.getObj(id),
fields = ["flags", "type",
"colors", "vertices", "centers",
"normals", "offsets",
"texts", "cex", "family", "font", "adj",
"material",
"radii",
"texcoords",
"userMatrix", "ids",
"dim",
"par3d", "userMatrix",
"viewpoint", "finite",
"pos"],
i;
for (i = 0; i < fields.length; i++) {
if (typeof prevobj[fields[i]] !== "undefined")
obj[fields[i]] = prevobj[fields[i]];
}
} else
console.warn("copyObj failed");
};
/**
* Update the triangles used to display a plane
* @param { number } id - id of the plane
* @param { Object } bbox - bounding box in which to display the plane
*/
rglwidgetClass.prototype.planeUpdateTriangles = function(id, bbox) {
var perms = [[0,0,1], [1,2,2], [2,1,0]],
x, xrow, elem, A, d, nhits, i, j, k, u, v, w, intersect, which, v0, v2, vx, reverse,
face1 = [], face2 = [], normals = [],
obj = this.getObj(id),
nPlanes = obj.normals.length;
obj.bbox = bbox;
obj.vertices = [];
obj.initialized = false;
for (elem = 0; elem < nPlanes; elem++) {
//    Vertex Av = normal.getRecycled(elem);
x = [];
A = obj.normals[elem];
d = obj.offsets[elem][0];
nhits = 0;
for (i=0; i<3; i++)
for (j=0; j<2; j++)
for (k=0; k<2; k++) {
u = perms[0][i];
v = perms[1][i];
w = perms[2][i];
if (A[w] !== 0.0) {
intersect = -(d + A[u]*bbox[j+2*u] + A[v]*bbox[k+2*v])/A[w];
if (bbox[2*w] < intersect && intersect < bbox[1+2*w]) {
xrow = [];
xrow[u] = bbox[j+2*u];
xrow[v] = bbox[k+2*v];
xrow[w] = intersect;
x.push(xrow);
face1[nhits] = j + 2*u;
face2[nhits] = k + 2*v;
nhits++;
}
}
}
if (nhits > 3) {
/* Re-order the intersections so the triangles work */
for (i=0; i<nhits-2; i++) {
which = 0; /* initialize to suppress warning */
for (j=i+1; j<nhits; j++) {
if (face1[i] == face1[j] || face1[i] == face2[j] ||
face2[i] == face1[j] || face2[i] == face2[j] ) {
which = j;
break;
}
}
if (which > i+1) {
this.swap(x, i+1, which);
this.swap(face1, i+1, which);
this.swap(face2, i+1, which);
}
}
}
if (nhits >= 3) {
/* Put in order so that the normal points out the FRONT of the faces */
v0 = [x[0][0] - x[1][0] , x[0][1] - x[1][1], x[0][2] - x[1][2]];
v2 = [x[2][0] - x[1][0] , x[2][1] - x[1][1], x[2][2] - x[1][2]];
/* cross-product */
vx = this.xprod(v0, v2);
reverse = this.dotprod(vx, A) > 0;
for (i=0; i<nhits-2; i++) {
obj.vertices.push(x[0]);
normals.push(A);
for (j=1; j<3; j++) {
obj.vertices.push(x[i + (reverse ? 3-j : j)]);
normals.push(A);
}
}
}
}
obj.pnormals = normals;
};
rglwidgetClass.prototype.getAdj = function (pos, offset, text) {
switch(pos) {
case 1: return [0.5, 1 + offset];
case 2: return [1 + offset/text.length, 0.5];
case 3: return [0.5, -offset];
case 4: return [-offset/text.length, 0.5];
}
}
/**
* Initialize object for display
* @param { number } id - id of object to initialize
*/
rglwidgetClass.prototype.initObj = function(id) {
var obj = this.getObj(id),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = obj.is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
is_brush = flags & this.f_is_brush,
gl = this.gl || this.initGL(),
polygon_offset,
texinfo, drawtype, nclipplanes, f, nrows, oldrows,
i,j,v,v1,v2, mat, uri, matobj, pass, passes, pmode,
dim, nx, nz, attr;
if (typeof id !== "number") {
this.alertOnce("initObj id is "+typeof id);
}
obj.initialized = true;
if (type === "bboxdeco" || type === "subscene")
return;
if (type === "light") {
obj.ambient = new Float32Array(obj.colors[0].slice(0,3));
obj.diffuse = new Float32Array(obj.colors[1].slice(0,3));
obj.specular = new Float32Array(obj.colors[2].slice(0,3));
obj.lightDir = new Float32Array(obj.vertices[0]);
return;
}
if (type === "clipplanes") {
obj.vClipplane = this.flatten(this.cbind(obj.normals, obj.offsets));
return;
}
if (type === "background" && typeof obj.ids !== "undefined") {
obj.quad = this.flatten([].concat(obj.ids));
return;
}
polygon_offset = this.getMaterial(id, "polygon_offset");
if (polygon_offset[0] != 0 || polygon_offset[1] != 0)
obj.polygon_offset = polygon_offset;
if (is_transparent) {
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}
if (is_brush)
this.initSelection(id);
if (typeof obj.vertices === "undefined")
obj.vertices = [];
v = obj.vertices;
obj.vertexCount = v.length;
if (!obj.vertexCount) return;
if (is_twosided) {
if (typeof obj.userAttributes === "undefined")
obj.userAttributes = {};
v1 = Array(v.length);
v2 = Array(v.length);
if (obj.type == "triangles" || obj.type == "quads") {
if (obj.type == "triangles")
nrow = 3;
else
nrow = 4;
for (i=0; i<Math.floor(v.length/nrow); i++)
for (j=0; j<nrow; j++) {
v1[nrow*i + j] = v[nrow*i + ((j+1) % nrow)];
v2[nrow*i + j] = v[nrow*i + ((j+2) % nrow)];
}
} else if (obj.type == "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz && j+1 < nx) {
v2[j + nx*i] = v[j + nx*(i+1)];
v1[j + nx*i] = v[j+1 + nx*(i+1)];
} else if (i+1 < nz) {
v2[j + nx*i] = v[j-1 + nx*i];
v1[j + nx*i] = v[j + nx*(i+1)];
} else {
v2[j + nx*i] = v[j + nx*(i-1)];
v1[j + nx*i] = v[j-1 + nx*(i-1)];
}
}
}
}
obj.userAttributes.aPos1 = v1;
obj.userAttributes.aPos2 = v2;
}
if (!sprites_3d) {
if (gl.isContextLost()) return;
obj.prog = gl.createProgram();
gl.attachShader(obj.prog, this.getShader( gl.VERTEX_SHADER,
this.getVertexShader(id) ));
gl.attachShader(obj.prog, this.getShader( gl.FRAGMENT_SHADER,
this.getFragmentShader(id) ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(obj.prog, 0, "aPos");
gl.bindAttribLocation(obj.prog, 1, "aCol");
gl.linkProgram(obj.prog);
var linked = gl.getProgramParameter(obj.prog, gl.LINK_STATUS);
if (!linked) {
// An error occurred while linking
var lastError = gl.getProgramInfoLog(obj.prog);
console.warn("Error in program linking:" + lastError);
gl.deleteProgram(obj.prog);
return;
}
}
if (type === "text") {
texinfo = this.drawTextToCanvas(obj.texts,
this.flatten(obj.cex),
this.flatten(obj.family),
this.flatten(obj.family));
}
if (fixed_quads && !sprites_3d) {
obj.ofsLoc = gl.getAttribLocation(obj.prog, "aOfs");
}
if (sprite_3d) {
obj.origLoc = gl.getUniformLocation(obj.prog, "uOrig");
obj.sizeLoc = gl.getUniformLocation(obj.prog, "uSize");
obj.usermatLoc = gl.getUniformLocation(obj.prog, "usermat");
}
if (has_texture || type == "text") {
if (!obj.texture)
obj.texture = gl.createTexture();
obj.texLoc = gl.getAttribLocation(obj.prog, "aTexcoord");
obj.sampler = gl.getUniformLocation(obj.prog, "uSampler");
}
if (has_texture) {
mat = obj.material;
if (typeof mat.uri !== "undefined")
uri = mat.uri;
else if (typeof mat.uriElementId === "undefined") {
matobj = this.getObj(mat.uriId);
if (typeof matobj !== "undefined") {
uri = matobj.material.uri;
} else {
uri = "";
}
} else
uri = document.getElementById(mat.uriElementId).rglinstance.getObj(mat.uriId).material.uri;
this.loadImageToTexture(uri, obj.texture);
}
if (type === "text") {
this.handleLoadedTexture(obj.texture, this.textureCanvas);
}
var stride = 3, nc, cofs, nofs, radofs, oofs, tofs, vnew, fnew,
nextofs = -1, pointofs = -1, alias, colors, key, selection, filter, adj, pos, offset;
obj.alias = undefined;
colors = obj.colors;
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
key = this.scene.crosstalk.key[j];
options = this.scene.crosstalk.options[j];
colors = colors.slice(0); 
for (i = 0; i < v.length; i++)
colors[i] = obj.colors[i % obj.colors.length].slice(0);
if ( (selection = this.scene.crosstalk.selection) &&
(selection.length || !options.selectedIgnoreNone) )
for (i = 0; i < v.length; i++) {
if (!selection.includes(key[i])) {
if (options.deselectedColor)
colors[i] = options.deselectedColor.slice(0);
colors[i][3] = colors[i][3]*options.deselectedFade;   /* default: mostly transparent if not selected */
} else if (options.selectedColor)
colors[i] = options.selectedColor.slice(0);
}
if ( (filter = this.scene.crosstalk.filter) )
for (i = 0; i < v.length; i++) 
if (!filter.includes(key[i])) {
if (options.filteredColor)
colors[i] = options.filteredColor.slice(0);
colors[i][3] = colors[i][3]*options.filteredFade;   /* default: completely hidden if filtered */
}
}  
nc = obj.colorCount = colors.length;
if (nc > 1) {
cofs = stride;
stride = stride + 4;
v = this.cbind(v, colors);
} else {
cofs = -1;
obj.onecolor = this.flatten(colors);
}
if (typeof obj.normals !== "undefined") {
nofs = stride;
stride = stride + 3;
v = this.cbind(v, typeof obj.pnormals !== "undefined" ? obj.pnormals : obj.normals);
} else
nofs = -1;
if (typeof obj.radii !== "undefined") {
radofs = stride;
stride = stride + 1;
// FIXME:  always concat the radii?
if (obj.radii.length === v.length) {
v = this.cbind(v, obj.radii);
} else if (obj.radii.length === 1) {
v = v.map(function(row, i, arr) { return row.concat(obj.radii[0]);});
}
} else
radofs = -1;
// Add default indices
f = Array(v.length);
for (i = 0; i < v.length; i++)
f[i] = i;
obj.f = [f,f];
if (type == "sprites" && !sprites_3d) {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
fnew = new Array(4*v.length);
alias = new Array(v.length);
var rescale = fixed_size ? 72 : 1,
size = obj.radii, s = rescale*size[0]/2;
last = v.length;
f = obj.f[0];
for (i=0; i < v.length; i++) {
if (size.length > 1)
s = rescale*size[i]/2;
vnew[i]  = v[i].concat([0,0,-s,-s]);
fnew[4*i] = f[i];
vnew[last]= v[i].concat([1,0, s,-s]);
fnew[4*i+1] = last++;
vnew[last]= v[i].concat([1,1, s, s]);
fnew[4*i+2] = last++;
vnew[last]= v[i].concat([0,1,-s, s]);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (type === "text") {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
f = obj.f[0];
fnew = new Array(4*f.length);
alias = new Array(v.length);
last = v.length;
adj = this.flatten(obj.adj);
if (typeof obj.pos !== "undefined") {
pos = this.flatten(obj.pos);
offset = adj[0];
}
for (i=0; i < v.length; i++) {
if (typeof pos !== "undefined")
adj = this.getAdj(pos[i % pos.length], offset, obj.texts[i]);
vnew[i]  = v[i].concat([0,-0.5]).concat(adj);
fnew[4*i] = f[i];
vnew[last] = v[i].concat([1,-0.5]).concat(adj);
fnew[4*i+1] = last++;
vnew[last] = v[i].concat([1, 1.5]).concat(adj);
fnew[4*i+2] = last++;
vnew[last] = v[i].concat([0, 1.5]).concat(adj);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
for (j=0; j < 4; j++) {
v1 = vnew[fnew[4*i+j]];
v1[tofs+2] = 2*(v1[tofs]-v1[tofs+2])*texinfo.widths[i];
v1[tofs+3] = 2*(v1[tofs+1]-v1[tofs+3])*texinfo.textHeights[i];
v1[tofs] = (texinfo.offsetsx[i] + v1[tofs]*texinfo.widths[i])/texinfo.canvasX;
v1[tofs+1] = 1.0-(texinfo.offsetsy[i] -
v1[tofs+1]*texinfo.textHeights[i])/texinfo.canvasY;
vnew[fnew[4*i+j]] = v1;
}
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (typeof obj.texcoords !== "undefined") {
tofs = stride;
stride += 2;
oofs = -1;
v = this.cbind(v, obj.texcoords);
} else {
tofs = -1;
oofs = -1;
}
obj.alias = alias;
if (typeof obj.userAttributes !== "undefined") {
obj.userAttribOffsets = {};
obj.userAttribLocations = {};
obj.userAttribSizes = {};
for (attr in obj.userAttributes) {
obj.userAttribLocations[attr] = gl.getAttribLocation(obj.prog, attr);
if (obj.userAttribLocations[attr] >= 0) { // Attribute may not have been used
obj.userAttribOffsets[attr] = stride;
v = this.cbind(v, obj.userAttributes[attr]);
stride = v[0].length;
obj.userAttribSizes[attr] = stride - obj.userAttribOffsets[attr];
}
}
}
if (typeof obj.userUniforms !== "undefined") {
obj.userUniformLocations = {};
for (attr in obj.userUniforms)
obj.userUniformLocations[attr] = gl.getUniformLocation(obj.prog, attr);
}
if (sprites_3d) {
obj.userMatrix = new CanvasMatrix4(obj.userMatrix);
obj.objects = this.flatten([].concat(obj.ids));
is_lit = false;
for (i=0; i < obj.objects.length; i++)
this.initObj(obj.objects[i]);
}
if (is_lit && !fixed_quads) {
obj.normLoc = gl.getAttribLocation(obj.prog, "aNorm");
}
nclipplanes = this.countClipplanes();
if (nclipplanes && !sprites_3d) {
obj.clipLoc = [];
for (i=0; i < nclipplanes; i++)
obj.clipLoc[i] = gl.getUniformLocation(obj.prog,"vClipplane" + i);
}
if (is_lit) {
obj.emissionLoc = gl.getUniformLocation(obj.prog, "emission");
obj.emission = new Float32Array(this.stringToRgb(this.getMaterial(id, "emission")));
obj.shininessLoc = gl.getUniformLocation(obj.prog, "shininess");
obj.shininess = this.getMaterial(id, "shininess");
obj.nlights = this.countLights();
obj.ambientLoc = [];
obj.ambient = new Float32Array(this.stringToRgb(this.getMaterial(id, "ambient")));
obj.specularLoc = [];
obj.specular = new Float32Array(this.stringToRgb(this.getMaterial(id, "specular")));
obj.diffuseLoc = [];
obj.lightDirLoc = [];
obj.viewpointLoc = [];
obj.finiteLoc = [];
for (i=0; i < obj.nlights; i++) {
obj.ambientLoc[i] = gl.getUniformLocation(obj.prog, "ambient" + i);
obj.specularLoc[i] = gl.getUniformLocation(obj.prog, "specular" + i);
obj.diffuseLoc[i] = gl.getUniformLocation(obj.prog, "diffuse" + i);
obj.lightDirLoc[i] = gl.getUniformLocation(obj.prog, "lightDir" + i);
obj.viewpointLoc[i] = gl.getUniformLocation(obj.prog, "viewpoint" + i);
obj.finiteLoc[i] = gl.getUniformLocation(obj.prog, "finite" + i);
}
}
obj.passes = is_twosided + 1;
obj.pmode = new Array(obj.passes);
for (pass = 0; pass < obj.passes; pass++) {
if (type === "triangles" || type === "quads" || type === "surface")
pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
else pmode = "filled";
obj.pmode[pass] = pmode;
}
obj.f.length = obj.passes;
for (pass = 0; pass < obj.passes; pass++) {
f = fnew = obj.f[pass];
pmode = obj.pmode[pass];
if (pmode === "culled")
f = [];
else if (pmode === "points") {
// stay with default
} else if ((type === "quads" || type === "text" ||
type === "sprites") && !sprites_3d) {
nrows = Math.floor(obj.vertexCount/4);
if (pmode === "filled") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[4*i];
fnew[6*i+1] = f[4*i + 1];
fnew[6*i+2] = f[4*i + 2];
fnew[6*i+3] = f[4*i];
fnew[6*i+4] = f[4*i + 2];
fnew[6*i+5] = f[4*i + 3];
}
} else {
fnew = Array(8*nrows);
for (i=0; i < nrows; i++) {
fnew[8*i] = f[4*i];
fnew[8*i+1] = f[4*i + 1];
fnew[8*i+2] = f[4*i + 1];
fnew[8*i+3] = f[4*i + 2];
fnew[8*i+4] = f[4*i + 2];
fnew[8*i+5] = f[4*i + 3];
fnew[8*i+6] = f[4*i + 3];
fnew[8*i+7] = f[4*i];
}
}
} else if (type === "triangles") {
nrows = Math.floor(obj.vertexCount/3);
if (pmode === "filled") {
fnew = Array(3*nrows);
for (i=0; i < fnew.length; i++) {
fnew[i] = f[i];
}
} else if (pmode === "lines") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[3*i];
fnew[6*i + 1] = f[3*i + 1];
fnew[6*i + 2] = f[3*i + 1];
fnew[6*i + 3] = f[3*i + 2];
fnew[6*i + 4] = f[3*i + 2];
fnew[6*i + 5] = f[3*i];
}
}
} else if (type === "spheres") {
// default
} else if (type === "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
if (pmode === "filled") {
fnew = [];
for (j=0; j<nx-1; j++) {
for (i=0; i<nz-1; i++) {
fnew.push(f[j + nx*i],
f[j + nx*(i+1)],
f[j + 1 + nx*(i+1)],
f[j + nx*i],
f[j + 1 + nx*(i+1)],
f[j + 1 + nx*i]);
}
}
} else if (pmode === "lines") {
fnew = [];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz)
fnew.push(f[j + nx*i],
f[j + nx*(i+1)]);
if (j+1 < nx)
fnew.push(f[j + nx*i],
f[j+1 + nx*i]);
}
}
}
}
obj.f[pass] = fnew;
if (depth_sort) {
drawtype = "DYNAMIC_DRAW";
} else {
drawtype = "STATIC_DRAW";
}
}
if (fat_lines) {
alias = undefined;
obj.nextLoc = gl.getAttribLocation(obj.prog, "aNext");
obj.pointLoc = gl.getAttribLocation(obj.prog, "aPoint");
obj.aspectLoc = gl.getUniformLocation(obj.prog, "uAspect");
obj.lwdLoc = gl.getUniformLocation(obj.prog, "uLwd");
// Expand vertices to turn each segment into a pair of triangles
for (pass = 0; pass < obj.passes; pass++) {
f = obj.f[pass];    
oldrows = f.length;
if (obj.pmode[pass] === "lines") 
break;
}
if (type === "linestrip") 
nrows = 4*(oldrows - 1); 
else
nrows = 2*oldrows;
vnew = new Array(nrows);
fnew = new Array(1.5*nrows);
var fnext = new Array(nrows),
fpt = new Array(nrows), 
pt, start, gap = type === "linestrip" ? 3 : 1;
// We're going to turn each pair of vertices into 4 new ones, with the "next" and "pt" attributes
// added.
// We do this by copying the originals in the first pass, adding the new attributes, then in a 
// second pass add new vertices at the end.
for (i = 0; i < v.length; i++) {
vnew[i] = v[i].concat([0,0,0,0,0]); 
}
nextofs = stride;
pointofs = stride + 3;
stride = stride + 5;
// Now add the extras
last = v.length - 1;
ind = 0;
alias = new Array(f.length);
for (i = 0; i < f.length; i++)
alias[i] = [];
for (i = 0; i < f.length - 1; i++) {
if (type !== "linestrip" && i % 2 == 1)
continue;
k = ++last;
vnew[k] = vnew[f[i]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i+1]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = -1;
fnew[ind] = k;
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+1] = last;
alias[f[i]].push(last-1, last);
last++;
k = last;
vnew[k] = vnew[f[i+1]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = 1;
fnew[ind+2] = k;
fnew[ind+3] = fnew[ind+1];
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+4] = last;
fnew[ind+5] = fnew[ind+2];
ind += 6;
alias[f[i+1]].push(last-1, last);
}
vnew.length = last+1;
v = vnew;
obj.vertexCount = v.length;
if (typeof alias !== "undefined" && typeof obj.alias !== "undefined") {  // Already have aliases from previous section?
var oldalias = obj.alias, newalias = Array(obj.alias.length);
for (i = 0; i < newalias.length; i++) {
newalias[i] = oldalias[i].slice();
for (j = 0; j < oldalias[i].length; j++)
Array.prototype.push.apply(newalias[i], alias[oldalias[j]]); // pushes each element 
}
obj.alias = newalias;
} else
obj.alias = alias;
for (pass = 0; pass < obj.passes; pass++)
if (type === "lines" || type === "linestrip" || obj.pmode[pass] == "lines") {
obj.f[pass] = fnew;
}
if (depth_sort) 
drawtype = "DYNAMIC_DRAW";
else
drawtype = "STATIC_DRAW";
}
for (pass = 0; pass < obj.passes; pass++) {
if (obj.vertexCount > 65535) {
if (this.index_uint) {
obj.f[pass] = new Uint32Array(obj.f[pass]);
obj.index_uint = true;
} else
this.alertOnce("Object has "+obj.vertexCount+" vertices, not supported in this browser.");
} else {
obj.f[pass] = new Uint16Array(obj.f[pass]);
obj.index_uint = false;
}
}
if (stride !== v[0].length) {
this.alertOnce("problem in stride calculation");
}
obj.vOffsets = {vofs:0, cofs:cofs, nofs:nofs, radofs:radofs, oofs:oofs, tofs:tofs,
nextofs:nextofs, pointofs:pointofs, stride:stride};
obj.values = new Float32Array(this.flatten(v));
if (type !== "spheres" && !sprites_3d) {
obj.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW); //
obj.ibuf = Array(obj.passes);
obj.ibuf[0] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[0]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[0], gl[drawtype]);
if (is_twosided) {
obj.ibuf[1] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[1]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[1], gl[drawtype]);
}
}
if (!sprites_3d) {
obj.mvMatLoc = gl.getUniformLocation(obj.prog, "mvMatrix");
obj.prMatLoc = gl.getUniformLocation(obj.prog, "prMatrix");
}
if (fixed_size) {
obj.textScaleLoc = gl.getUniformLocation(obj.prog, "textScale");
}
if (is_lit && !sprites_3d) {
obj.normMatLoc = gl.getUniformLocation(obj.prog, "normMatrix");
}
if (is_twosided) {
obj.frontLoc = gl.getUniformLocation(obj.prog, "front");
}
};
/**
* Set gl depth test based on object's material
* @param { number } id - object to use
*/
rglwidgetClass.prototype.setDepthTest = function(id) {
var gl = this.gl || this.initGL(),
tests = {never: gl.NEVER,
less:  gl.LESS,
equal: gl.EQUAL,
lequal:gl.LEQUAL,
greater: gl.GREATER,
notequal: gl.NOTEQUAL,
gequal: gl.GEQUAL,
always: gl.ALWAYS},
test = tests[this.getMaterial(id, "depth_test")];
gl.depthFunc(test);
};
rglwidgetClass.prototype.mode4type = {points : "POINTS",
linestrip : "LINE_STRIP",
abclines : "LINES",
lines : "LINES",
sprites : "TRIANGLES",
planes : "TRIANGLES",
text : "TRIANGLES",
quads : "TRIANGLES",
surface : "TRIANGLES",
triangles : "TRIANGLES"};
/**
* Sort objects from back to front
* @returns { number[] }
* @param { Object } obj - object to sort
*/
rglwidgetClass.prototype.depthSort = function(obj) {
var n = obj.centers.length,
depths = new Float32Array(n),
result = new Array(n),
compare = function(i,j) { return depths[j] - depths[i]; },
z, w;
for(i=0; i<n; i++) {
z = this.prmvMatrix.m13*obj.centers[i][0] +
this.prmvMatrix.m23*obj.centers[i][1] +
this.prmvMatrix.m33*obj.centers[i][2] +
this.prmvMatrix.m43;
w = this.prmvMatrix.m14*obj.centers[i][0] +
this.prmvMatrix.m24*obj.centers[i][1] +
this.prmvMatrix.m34*obj.centers[i][2] +
this.prmvMatrix.m44;
depths[i] = z/w;
result[i] = i;
}
result.sort(compare);
return result;
};
rglwidgetClass.prototype.disableArrays = function(obj, enabled) {
var gl = this.gl || this.initGL(),
objLocs = ["normLoc", "texLoc", "ofsLoc", "pointLoc", "nextLoc"],
thisLocs = ["posLoc", "colLoc"], i, attr;
for (i = 0; i < objLocs.length; i++) 
if (enabled[objLocs[i]]) gl.disableVertexAttribArray(obj[objLocs[i]]);
for (i = 0; i < thisLocs.length; i++)
if (enabled[thisLocs[i]]) gl.disableVertexAttribArray(this[objLocs[i]]);
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.disableVertexAttribArray( obj.userAttribLocations[attr] );
}
}
}
/**
* Draw an object in a subscene
* @param { number } id - object to draw
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawObj = function(id, subsceneid) {
var obj = this.getObj(id),
subscene = this.getObj(subsceneid),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = flags & this.f_is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
is_points = flags & this.f_is_points,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
gl = this.gl || this.initGL(),
mat,
sphereMV, baseofs, ofs, sscale, i, count, light,
pass, mode, pmode, attr,
enabled = {};
if (typeof id !== "number") {
this.alertOnce("drawObj id is "+typeof id);
}
if (type === "planes") {
if (obj.bbox !== subscene.par3d.bbox || !obj.initialized) {
this.planeUpdateTriangles(id, subscene.par3d.bbox);
}
}
if (!obj.initialized)
this.initObj(id);
if (type === "clipplanes") {
count = obj.offsets.length;
var IMVClip = [];
for (i=0; i < count; i++) {
IMVClip[i] = this.multMV(this.invMatrix, obj.vClipplane.slice(4*i, 4*(i+1)));
}
obj.IMVClip = IMVClip;
return;
}
if (type === "light" || type === "bboxdeco" || !obj.vertexCount)
return;
if (!is_transparent &&
obj.someHidden) {
is_transparent = true;
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}        
this.setDepthTest(id);
if (sprites_3d) {
var norigs = obj.vertices.length,
savenorm = new CanvasMatrix4(this.normMatrix);
this.origs = obj.vertices;
this.usermat = new Float32Array(obj.userMatrix.getAsArray());
this.radii = obj.radii;
this.normMatrix = subscene.spriteNormmat;
for (this.iOrig=0; this.iOrig < norigs; this.iOrig++) {
for (i=0; i < obj.objects.length; i++) {
this.drawObj(obj.objects[i], subsceneid);
}
}
this.normMatrix = savenorm;
return;
} else {
gl.useProgram(obj.prog);
}
if (typeof obj.polygon_offset !== "undefined") {
gl.polygonOffset(obj.polygon_offset[0],
obj.polygon_offset[1]);
gl.enable(gl.POLYGON_OFFSET_FILL);
}
if (sprite_3d) {
gl.uniform3fv(obj.origLoc, new Float32Array(this.origs[this.iOrig]));
if (this.radii.length > 1) {
gl.uniform1f(obj.sizeLoc, this.radii[this.iOrig][0]);
} else {
gl.uniform1f(obj.sizeLoc, this.radii[0][0]);
}
gl.uniformMatrix4fv(obj.usermatLoc, false, this.usermat);
}
if (type === "spheres") {
gl.bindBuffer(gl.ARRAY_BUFFER, this.sphere.buf);
} else {
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
}
gl.uniformMatrix4fv( obj.prMatLoc, false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0,
clipplaneids = subscene.clipplanes,
clip, j;
for (i=0; i < clipplaneids.length; i++) {
clip = this.getObj(clipplaneids[i]);
for (j=0; j < clip.offsets.length; j++) {
gl.uniform4fv(obj.clipLoc[clipcheck + j], clip.IMVClip[j]);
}
clipcheck += clip.offsets.length;
}
if (typeof obj.clipLoc !== "undefined")
for (i=clipcheck; i < obj.clipLoc.length; i++)
gl.uniform4f(obj.clipLoc[i], 0,0,0,0);
if (is_lit) {
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(this.normMatrix.getAsArray()) );
gl.uniform3fv( obj.emissionLoc, obj.emission);
gl.uniform1f( obj.shininessLoc, obj.shininess);
for (i=0; i < subscene.lights.length; i++) {
light = this.getObj(subscene.lights[i]);
if (!light.initialized) this.initObj(subscene.lights[i]);
gl.uniform3fv( obj.ambientLoc[i], this.componentProduct(light.ambient, obj.ambient));
gl.uniform3fv( obj.specularLoc[i], this.componentProduct(light.specular, obj.specular));
gl.uniform3fv( obj.diffuseLoc[i], light.diffuse);
gl.uniform3fv( obj.lightDirLoc[i], light.lightDir);
gl.uniform1i( obj.viewpointLoc[i], light.viewpoint);
gl.uniform1i( obj.finiteLoc[i], light.finite);
}
for (i=subscene.lights.length; i < obj.nlights; i++) {
gl.uniform3f( obj.ambientLoc[i], 0,0,0);
gl.uniform3f( obj.specularLoc[i], 0,0,0);
gl.uniform3f( obj.diffuseLoc[i], 0,0,0);
}
}
if (fixed_size) {
gl.uniform2f( obj.textScaleLoc, 0.75/this.vp.width, 0.75/this.vp.height);
}
gl.enableVertexAttribArray( this.posLoc );
enabled.posLoc = true;
var nc = obj.colorCount;
count = obj.vertexCount;
if (type === "spheres") {
subscene = this.getObj(subsceneid);
var scale = subscene.par3d.scale,
scount = count, indices;
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.enableVertexAttribArray(obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.disableVertexAttribArray( this.colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(scale[0], scale[1], scale[2]);
sphereNorm.multRight(this.normMatrix);
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(sphereNorm.getAsArray()) );
if (nc == 1) {
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
}
if (has_texture) {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,
4*this.sphere.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (depth_sort)
indices = this.depthSort(obj);
for (i = 0; i < scount; i++) {
sphereMV = new CanvasMatrix4();
if (depth_sort) {
baseofs = indices[i]*obj.vOffsets.stride;
} else {
baseofs = i*obj.vOffsets.stride;
}
ofs = baseofs + obj.vOffsets.radofs;
sscale = obj.values[ofs];
sphereMV.scale(sscale/scale[0], sscale/scale[1], sscale/scale[2]);
sphereMV.translate(obj.values[baseofs],
obj.values[baseofs+1],
obj.values[baseofs+2]);
sphereMV.multRight(this.mvMatrix);
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(sphereMV.getAsArray()) );
if (nc > 1) {
ofs = baseofs + obj.vOffsets.cofs;
gl.vertexAttrib4f( this.colLoc, obj.values[ofs],
obj.values[ofs+1],
obj.values[ofs+2],
obj.values[ofs+3] );
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.sphere.ibuf);
gl.drawElements(gl.TRIANGLES, this.sphere.sphereCount, gl.UNSIGNED_SHORT, 0);
}
this.disableArrays(obj, enabled);
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
return;
} else {
if (obj.colorCount === 1) {
gl.disableVertexAttribArray( this.colLoc );
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
} else {
gl.enableVertexAttribArray( this.colLoc );
enabled.colLoc = true;
gl.vertexAttribPointer(this.colLoc, 4, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.cofs);
}
}
if (is_lit && obj.vOffsets.nofs > 0) {
gl.enableVertexAttribArray( obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nofs);
}
if (has_texture || type === "text") {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (fixed_quads) {
gl.enableVertexAttribArray( obj.ofsLoc );
enabled.ofsLoc = true;
gl.vertexAttribPointer(obj.ofsLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.oofs);
}
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.enableVertexAttribArray( obj.userAttribLocations[attr] );
gl.vertexAttribPointer( obj.userAttribLocations[attr], obj.userAttribSizes[attr],
gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.userAttribOffsets[attr]);
}
}
if (typeof obj.userUniforms !== "undefined") {
for (attr in obj.userUniformLocations) {
var loc = obj.userUniformLocations[attr];
if (loc !== null) {
var uniform = obj.userUniforms[attr];
if (typeof uniform.length === "undefined")
gl.uniform1f(loc, uniform);
else if (typeof uniform[0].length === "undefined") {
uniform = new Float32Array(uniform);
switch(uniform.length) {
case 2: gl.uniform2fv(loc, uniform); break;
case 3: gl.uniform3fv(loc, uniform); break;
case 4: gl.uniform4fv(loc, uniform); break;
default: console.warn("bad uniform length");
}
} else if (uniform.length == 4 && uniform[0].length == 4)
gl.uniformMatrix4fv(loc, false, new Float32Array(uniform.getAsArray()));
else
console.warn("unsupported uniform matrix");
}
}
}
for (pass = 0; pass < obj.passes; pass++) {
pmode = obj.pmode[pass];
if (pmode === "culled")
continue;
mode = fat_lines && (is_lines || pmode == "lines") ? "TRIANGLES" : this.mode4type[type];
if (depth_sort && pmode == "filled") {// Don't try depthsorting on wireframe or points
var faces = this.depthSort(obj),
nfaces = faces.length,
frowsize = Math.floor(obj.f[pass].length/nfaces);
if (type !== "spheres") {
var f = obj.index_uint ? new Uint32Array(obj.f[pass].length) : new Uint16Array(obj.f[pass].length);
for (i=0; i<nfaces; i++) {
for (j=0; j<frowsize; j++) {
f[frowsize*i + j] = obj.f[pass][frowsize*faces[i] + j];
}
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.DYNAMIC_DRAW);
}
}
if (is_twosided)
gl.uniform1i(obj.frontLoc, pass !== 0);
if (type !== "spheres") 
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
if (type === "sprites" || type === "text" || type === "quads") {
count = count * 6/4;
} else if (type === "surface") {
count = obj.f[pass].length;
}
count = obj.f[pass].length;
if (!is_lines && pmode === "lines" && !fat_lines) {
mode = "LINES";
} else if (pmode === "points") {
mode = "POINTS";
}
if ((is_lines || pmode === "lines") && fat_lines) {
gl.enableVertexAttribArray(obj.pointLoc);
enabled.pointLoc = true;
gl.vertexAttribPointer(obj.pointLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.pointofs);
gl.enableVertexAttribArray(obj.nextLoc );
enabled.nextLoc = true;
gl.vertexAttribPointer(obj.nextLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nextofs);
gl.uniform1f(obj.aspectLoc, this.vp.width/this.vp.height);
gl.uniform1f(obj.lwdLoc, this.getMaterial(id, "lwd")/this.vp.height);
}
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*obj.vOffsets.stride,  4*obj.vOffsets.vofs);
gl.drawElements(gl[mode], count, obj.index_uint ? gl.UNSIGNED_INT : gl.UNSIGNED_SHORT, 0);
this.disableArrays(obj, enabled);
}
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
};
/**
* Draw the background for a subscene
* @param { number } id - id of background object
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawBackground = function(id, subsceneid) {
var gl = this.gl || this.initGL(),
obj = this.getObj(id),
bg, i;
if (!obj.initialized)
this.initObj(id);
if (obj.colors.length) {
bg = obj.colors[0];
gl.clearColor(bg[0], bg[1], bg[2], bg[3]);
gl.depthMask(true);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
}
if (typeof obj.quad !== "undefined") {
this.prMatrix.makeIdentity();
this.mvMatrix.makeIdentity();
gl.disable(gl.BLEND);
gl.disable(gl.DEPTH_TEST);
gl.depthMask(false);
for (i=0; i < obj.quad.length; i++)
this.drawObj(obj.quad[i], subsceneid);
}
};
/**
* Draw a subscene
* @param { number } subsceneid - id of subscene
* @param { boolean } opaquePass - is this the opaque drawing pass?
*/
rglwidgetClass.prototype.drawSubscene = function(subsceneid, opaquePass) {
var gl = this.gl || this.initGL(),
sub = this.getObj(subsceneid),
objects = this.scene.objects,
subids = sub.objects,
subscene_has_faces = false,
subscene_needs_sorting = false,
flags, i, obj;
if (sub.par3d.skipRedraw)
return;
for (i=0; i < subids.length; i++) {
obj = objects[subids[i]];
flags = obj.flags;
if (typeof flags !== "undefined") {
subscene_has_faces |= (flags & this.f_is_lit)
& !(flags & this.f_fixed_quads);
obj.is_transparent = (flags & this.f_is_transparent) || obj.someHidden;
subscene_needs_sorting |= (flags & this.f_depth_sort) || obj.is_transparent;
}
}
this.setViewport(subsceneid);
if (typeof sub.backgroundId !== "undefined" && opaquePass)
this.drawBackground(sub.backgroundId, subsceneid);
if (subids.length) {
this.setprMatrix(subsceneid);
this.setmvMatrix(subsceneid);
if (subscene_has_faces) {
this.setnormMatrix(subsceneid);
if ((sub.flags & this.f_sprites_3d) &&
typeof sub.spriteNormmat === "undefined") {
sub.spriteNormmat = new CanvasMatrix4(this.normMatrix);
}
}
if (subscene_needs_sorting)
this.setprmvMatrix();
var clipids = sub.clipplanes;
if (typeof clipids === "undefined") {
console.warn("bad clipids");
}
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < clipids.length; i++)
this.drawObj(clipids[i], subsceneid);
}
subids = sub.opaque.concat(sub.transparent);
if (opaquePass) {
gl.enable(gl.DEPTH_TEST);
gl.depthMask(true);
gl.disable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (!this.getObj(subids[i]).is_transparent) 
this.drawObj(subids[i], subsceneid);
}
} else {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (this.getObj(subids[i]).is_transparent)
this.drawObj(subids[i], subsceneid);
}
}
subids = sub.subscenes;
for (i = 0; i < subids.length; i++) {
this.drawSubscene(subids[i], opaquePass);
}
}
};
/**
* Respond to brush change
*/
rglwidgetClass.prototype.selectionChanged = function() {
var i, j, k, id, subid = this.select.subscene, subscene,
objids, obj,
p1 = this.select.region.p1, p2 = this.select.region.p2,
filter, selection = [], handle, keys, xmin, x, xmax, ymin, y, ymax, z, v,
someHidden;
if (!subid)
return;
subscene = this.getObj(subid);
objids = subscene.objects;
filter = this.scene.crosstalk.filter;
this.setmvMatrix(subid);
this.setprMatrix(subid);
this.setprmvMatrix();
xmin = Math.min(p1.x, p2.x);
xmax = Math.max(p1.x, p2.x);
ymin = Math.min(p1.y, p2.y);
ymax = Math.max(p1.y, p2.y);
for (i = 0; i < objids.length; i++) {
id = objids[i];
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
keys = this.scene.crosstalk.key[j];
obj = this.getObj(id);
someHidden = false;
for (k = 0; k < keys.length; k++) {
if (filter && filter.indexOf(keys[k]) < 0) {
someHidden = true;
continue;
}
v = [].concat(obj.vertices[k]).concat(1.0);
v = this.multVM(v, this.prmvMatrix);
x = v[0]/v[3];
y = v[1]/v[3];
z = v[2]/v[3];
if (xmin <= x && x <= xmax && ymin <= y && y <= ymax && -1.0 <= z && z <= 1.0) {
selection.push(keys[k]);
} else
someHidden = true;
}
obj.someHidden = someHidden && (filter || selection.length);
obj.initialized = false;
/* Who should we notify?  Only shared data in the current subscene, or everyone? */
if (!this.equalArrays(selection, this.scene.crosstalk.selection)) {
handle = this.scene.crosstalk.sel_handle[j];
handle.set(selection, {rglSubsceneId: this.select.subscene});
}
}
}
};
/**
* Respond to selection or filter change from crosstalk
* @param { Object } event - crosstalk event
* @param { boolean } filter - filter or selection?
*/
rglwidgetClass.prototype.selection = function(event, filter) {
var i, j, ids, obj, keys, crosstalk = this.scene.crosstalk,
selection, someHidden;
// Record the message and find out if this event makes some objects have mixed values:
crosstalk = this.scene.crosstalk;
if (filter) {
filter = crosstalk.filter = event.value;
selection = crosstalk.selection;
} else {  
selection = crosstalk.selection = event.value;
filter = crosstalk.filter;
}
ids = crosstalk.id;
for (i = 0; i < ids.length ; i++) {
obj = this.getObj(ids[i]);
obj.initialized = false;
keys = crosstalk.key[i];
someHidden = false;
for (j = 0; j < keys.length && !someHidden; j++) {
if ((filter && filter.indexOf(keys[j]) < 0) ||
(selection.length && selection.indexOf(keys[j]) < 0))
someHidden = true;
}
obj.someHidden = someHidden;
}
this.drawScene();
};
/**
* Clear the selection brush
* @param { number } except - Subscene that should ignore this request
*/
rglwidgetClass.prototype.clearBrush = function(except) {
if (this.select.subscene != except) {
this.select.state = "inactive";
this.delFromSubscene(this.scene.brushId, this.select.subscene);
}
this.drawScene();
};
/**
* Compute mouse coordinates relative to current canvas
* @returns { Object }
* @param { Object } event - event object from mouse click
*/
rglwidgetClass.prototype.relMouseCoords = function(event) {
var totalOffsetX = 0,
totalOffsetY = 0,
currentElement = this.canvas;
do {
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
currentElement = currentElement.offsetParent;
}
while(currentElement);
var canvasX = event.pageX - totalOffsetX,
canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY};
};
/**
* Set mouse handlers for the scene
*/
rglwidgetClass.prototype.setMouseHandlers = function() {
var self = this, activeSubscene, handler,
handlers = {}, drag = 0;
handlers.rotBase = 0;
this.screenToVector = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
radius = Math.max(width, height)/2.0,
cx = width/2.0,
cy = height/2.0,
px = (x-cx)/radius,
py = (y-cy)/radius,
plen = Math.sqrt(px*px+py*py);
if (plen > 1.e-6) {
px = px/plen;
py = py/plen;
}
var angle = (Math.SQRT2 - plen)/Math.SQRT2*Math.PI/2,
z = Math.sin(angle),
zlen = Math.sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
};
handlers.trackballdown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.rotBase = this.screenToVector(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.trackballmove = function(x,y) {
var rotCurrent = this.screenToVector(x,y),
rotBase = handlers.rotBase,
dot = rotBase[0]*rotCurrent[0] +
rotBase[1]*rotCurrent[1] +
rotBase[2]*rotCurrent[2],
angle = Math.acos( dot/this.vlen(rotBase)/this.vlen(rotCurrent) )*180.0/Math.PI,
axis = this.xprod(rotBase, rotCurrent),
objects = this.scene.objects,
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
l = activeModel.par3d.listeners,
i;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
}
this.drawScene();
};
handlers.trackballend = 0;
this.clamp = function(x, lo, hi) {
return Math.max(lo, Math.min(x, hi));
};
this.screenToPolar = function(x,y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
r = Math.min(width, height)/2,
dx = this.clamp(x - width/2, -r, r),
dy = this.clamp(y - height/2, -r, r);
return [Math.asin(dx/r), Math.asin(-dy/r)];
};
handlers.polardown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.dragBase = this.screenToPolar(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
activeSub.camBase = [-Math.atan2(activeSub.saveMat.m13, activeSub.saveMat.m11),
Math.atan2(activeSub.saveMat.m32, activeSub.saveMat.m22)];
}
};
handlers.polarmove = function(x,y) {
var dragCurrent = this.screenToPolar(x,y),
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
objects = this.scene.objects,
l = activeModel.par3d.listeners,
i, changepos = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
for (j=0; j<2; j++)
changepos[j] = -(dragCurrent[j] - handlers.dragBase[j]);
activeSub.par3d.userMatrix.makeIdentity();
activeSub.par3d.userMatrix.rotate(changepos[0]*180/Math.PI, 0,-1,0);
activeSub.par3d.userMatrix.multRight(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(changepos[1]*180/Math.PI, -1,0,0);
}
this.drawScene();
};
handlers.polarend = 0;
handlers.axisdown = function(x,y) {
handlers.rotBase = this.screenToVector(x, this.canvas.height/2);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.axismove = function(x,y) {
var rotCurrent = this.screenToVector(x, this.canvas.height/2),
rotBase = handlers.rotBase,
angle = (rotCurrent[0] - rotBase[0])*180/Math.PI,
rotMat = new CanvasMatrix4();
rotMat.rotate(angle, handlers.axis[0], handlers.axis[1], handlers.axis[2]);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(activeSub.saveMat);
activeSub.par3d.userMatrix.multLeft(rotMat);
}
this.drawScene();
};
handlers.axisend = 0;
handlers.y0zoom = 0;
handlers.zoom0 = 0;
handlers.zoomdown = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
handlers.y0zoom = y;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.zoom0 = Math.log(activeSub.par3d.zoom);
}
};
handlers.zoommove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.zoom = Math.exp(activeSub.zoom0 + (y-handlers.y0zoom)/this.canvas.height);
}
this.drawScene();
};
handlers.zoomend = 0;
handlers.y0fov = 0;
handlers.fovdown = function(x, y) {
handlers.y0fov = y;
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.fov0 = activeSub.par3d.FOV;
}
};
handlers.fovmove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.FOV = Math.max(1, Math.min(179, activeSub.fov0 +
180*(y-handlers.y0fov)/this.canvas.height));
}
this.drawScene();
};
handlers.fovend = 0;
handlers.selectingdown = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height, 
p = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
this.select.region = {p1: p, p2: p};
if (this.select.subscene && this.select.subscene != activeSubscene)
this.delFromSubscene(this.scene.brushId, this.select.subscene);
this.select.subscene = activeSubscene;
this.addToSubscene(this.scene.brushId, activeSubscene);
this.select.state = "changing";
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingmove = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height;
if (this.select.state === "inactive") 
return;
this.select.region.p2 = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingend = 0;
this.canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1:
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ["left", "middle", "right"][ev.which-1];
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height-coords.y;
activeSubscene = self.whichSubscene(coords);
var sub = self.getObj(activeSubscene), f;
handler = sub.par3d.mouseMode[drag];
switch (handler) {
case "xAxis":
handler = "axis";
handlers.axis = [1.0, 0.0, 0.0];
break;
case "yAxis":
handler = "axis";
handlers.axis = [0.0, 1.0, 0.0];
break;
case "zAxis":
handler = "axis";
handlers.axis = [0.0, 0.0, 1.0];
break;
}
f = handlers[handler + "down"];
if (f) {
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
ev.preventDefault();
} else
console.warn("Mouse handler '" + handler + "' is not implemented.");
};
this.canvas.onmouseup = function ( ev ){
if ( drag === 0 ) return;
var f = handlers[handler + "end"];
if (f) {
f.call(self);
ev.preventDefault();
}
drag = 0;
};
this.canvas.onmouseout = this.canvas.onmouseup;
this.canvas.onmousemove = function ( ev ) {
if ( drag === 0 ) return;
var f = handlers[handler + "move"];
if (f) {
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height - coords.y;
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
}
};
handlers.wheelHandler = function(ev) {
var del = 1.02, i;
if (ev.shiftKey) del = 1.002;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
if (typeof activeSubscene === "undefined")
activeSubscene = self.scene.rootSubscene;
var activeSub = self.getObj(activeSubscene),
activeProjection = self.getObj(self.useid(activeSub.id, "projection")),
l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = self.getObj(l[i]);
activeSub.par3d.zoom *= ds;
}
self.drawScene();
ev.preventDefault();
};
this.canvas.addEventListener("DOMMouseScroll", handlers.wheelHandler, false);
this.canvas.addEventListener("mousewheel", handlers.wheelHandler, false);
};
/**
* Find a particular subscene by inheritance
* @returns { number } id of subscene to use
* @param { number } subsceneid - child subscene
* @param { string } type - type of inheritance:  "projection" or "model"
*/
rglwidgetClass.prototype.useid = function(subsceneid, type) {
var sub = this.getObj(subsceneid);
if (sub.embeddings[type] === "inherit")
return(this.useid(sub.parent, type));
else
return subsceneid;
};
/**
* Check whether point is in viewport of subscene
* @returns {boolean}
* @param { Object } coords - screen coordinates of point
* @param { number } subsceneid - subscene to check
*/
rglwidgetClass.prototype.inViewport = function(coords, subsceneid) {
var viewport = this.getObj(subsceneid).par3d.viewport,
x0 = coords.x - viewport.x*this.canvas.width,
y0 = coords.y - viewport.y*this.canvas.height;
return 0 <= x0 && x0 <= viewport.width*this.canvas.width &&
0 <= y0 && y0 <= viewport.height*this.canvas.height;
};
/**
* Find which subscene contains a point
* @returns { number } subscene id
* @param { Object } coords - coordinates of point
*/
rglwidgetClass.prototype.whichSubscene = function(coords) {
var self = this,
recurse = function(subsceneid) {
var subscenes = self.getChildSubscenes(subsceneid), i, id;
for (i=0; i < subscenes.length; i++) {
id = recurse(subscenes[i]);
if (typeof(id) !== "undefined")
return(id);
}
if (self.inViewport(coords, subsceneid))
return(subsceneid);
else
return undefined;
},
rootid = this.scene.rootSubscene,
result = recurse(rootid);
if (typeof(result) === "undefined")
result = rootid;
return result;
};
/**
* Translate from window coordinates to viewport coordinates
* @returns { Object } translated coordinates
* @param { number } subsceneid - which subscene to use?
* @param { Object } coords - point to translate
*/
rglwidgetClass.prototype.translateCoords = function(subsceneid, coords) {
var viewport = this.getObj(subsceneid).par3d.viewport;
return {x: coords.x - viewport.x*this.canvas.width,
y: coords.y - viewport.y*this.canvas.height};
};
/**
* Initialize the sphere object
*/
rglwidgetClass.prototype.initSphere = function() {
var verts = this.scene.sphereVerts,
reuse = verts.reuse, result;
if (typeof reuse !== "undefined") {
var prev = document.getElementById(reuse).rglinstance.sphere;
result = {values: prev.values, vOffsets: prev.vOffsets, it: prev.it};
} else
result = {values: new Float32Array(this.flatten(this.cbind(this.transpose(verts.vb),
this.transpose(verts.texcoords)))),
it: new Uint16Array(this.flatten(this.transpose(verts.it))),
vOffsets: {vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1,
tofs:3, nextofs:-1, pointofs:-1, stride:5}};
result.sphereCount = result.it.length;
this.sphere = result;
};
/**
* Set the vertices in the selection box object
*/
rglwidgetClass.prototype.initSelection = function(id) {
if (typeof this.select.region === "undefined")
return;
var obj = this.getObj(id),
width = this.canvas.width,
height = this.canvas.height, 
p1 = this.select.region.p1,
p2 = this.select.region.p2;
obj.vertices = [[p1.x, p1.y, 0.0],
[p2.x, p1.y, 0.0],
[p2.x, p2.y, 0.0],
[p1.x, p2.y, 0.0],
[p1.x, p1.y, 0.0]];
};
/**
* Do the gl part of initializing the sphere
*/
rglwidgetClass.prototype.initSphereGL = function() {
var gl = this.gl || this.initGL(), sphere = this.sphere;
if (gl.isContextLost()) return;
sphere.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphere.buf);
gl.bufferData(gl.ARRAY_BUFFER, sphere.values, gl.STATIC_DRAW);
sphere.ibuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphere.ibuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, sphere.it, gl.STATIC_DRAW);
return;
};
/**
* Initialize the DOM object
* @param { Object } el - the DOM object
* @param { Object } x - the scene data sent by JSON from R
*/
rglwidgetClass.prototype.initialize = function(el, x) {
this.textureCanvas = document.createElement("canvas");
this.textureCanvas.style.display = "block";
this.scene = x;
this.normMatrix = new CanvasMatrix4();
this.saveMat = {};
this.distance = null;
this.posLoc = 0;
this.colLoc = 1;
if (el) {
el.rglinstance = this;
this.el = el;
this.webGLoptions = el.rglinstance.scene.webGLoptions;
this.initCanvas();
}
if (typeof Shiny !== "undefined") {
var self = this;
Shiny.addCustomMessageHandler("shinyGetPar3d",
function(message) {
var i, param, 
subscene = self.getObj(message.subscene),
parameters = [].concat(message.parameters),
result = {tag: message.tag, subscene: message.subscene};
if (typeof subscene !== "undefined") {
for (i = 0; i < parameters.length; i++) {
param = parameters[i];
result[param] = subscene.par3d[param];
};
} else {
console.log("subscene "+message.subscene+" undefined.")
}
Shiny.setInputValue("par3d:shinyPar3d", result, {priority: "event"});
});
Shiny.addCustomMessageHandler("shinySetPar3d",
function(message) {
var param = message.parameter, 
subscene = self.getObj(message.subscene);
if (typeof subscene !== "undefined") {
subscene.par3d[param] = message.value;
subscene.initialized = false;
self.drawScene();
} else {
console.log("subscene "+message.subscene+" undefined.")
}
})
}
};
/**
* Restart the WebGL canvas
*/
rglwidgetClass.prototype.restartCanvas = function() {
var newcanvas = document.createElement("canvas"),
self = this;
newcanvas.width = this.el.width;
newcanvas.height = this.el.height;
newcanvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
newcanvas.addEventListener("webglcontextlost",
this.onContextLost, false);
while (this.el.firstChild) {
this.el.removeChild(this.el.firstChild);
}
this.el.appendChild(newcanvas);
this.canvas = newcanvas;
this.setMouseHandlers();
if (this.gl) 
Object.keys(this.scene.objects).forEach(function(key){
self.getObj(parseInt(key, 10)).texture = undefined; 
});
this.gl = null;
};
/**
* Initialize the WebGL canvas
*/
rglwidgetClass.prototype.initCanvas = function() {
this.restartCanvas();
var objs = this.scene.objects,
self = this;
Object.keys(objs).forEach(function(key){
var id = parseInt(key, 10),
obj = self.getObj(id);
if (typeof obj.reuse !== "undefined")
self.copyObj(id, obj.reuse);
});
Object.keys(objs).forEach(function(key){
self.initSubscene(parseInt(key, 10));
});
this.setMouseHandlers();
this.initSphere();
this.onContextRestored = function(event) {
self.initGL();
self.drawScene();
};
this.onContextLost = function(event) {
if (!self.drawing)
this.gl = null;
event.preventDefault();
};
this.initGL0();
this.lazyLoadScene = function() {
if (typeof self.slide === "undefined")
self.slide = self.getSlide();
if (self.isInBrowserViewport()) {
if (!self.gl || self.gl.isContextLost())
self.initGL();
self.drawScene();
}
};
window.addEventListener("DOMContentLoaded", this.lazyLoadScene, false);
window.addEventListener("load", this.lazyLoadScene, false);
window.addEventListener("resize", this.lazyLoadScene, false);
window.addEventListener("scroll", this.lazyLoadScene, false);
this.slide = this.getSlide();
if (this.slide) {
if (typeof this.slide.rgl === "undefined")
this.slide.rgl = [this];
else
this.slide.rgl.push(this);
if (this.scene.context.rmarkdown) 
if (this.scene.context.rmarkdown === "ioslides_presentation") {
this.slide.setAttribute("slideenter", "this.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window);})");
} else if (this.scene.context.rmarkdown === "slidy_presentation") {
// This method would also work in ioslides, but it gets triggered
// something like 5 times per slide for every slide change, so
// you'd need a quicker function than lazyLoadScene.
var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver,
observer = new MutationObserver(function(mutations) {
mutations.forEach(function(mutation) {
self.slide.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window); });});});
observer.observe(this.slide, { attributes: true, attributeFilter:["class"] });
}
}
};
/**
* Start the writeWebGL scene. This is only used by writeWebGL; rglwidget has
no debug element and does the drawing in rglwidget.js.
*/
rglwidgetClass.prototype.start = function() {
if (typeof this.prefix !== "undefined") {
this.debugelement = document.getElementById(this.prefix + "debug");
this.debug("");
}
this.drag = 0;
this.drawScene();
};
/**
* Display a debug message
* @param { string } msg - The message to display
* @param { Object } [img] - Image to insert before message
*/
rglwidgetClass.prototype.debug = function(msg, img) {
if (typeof this.debugelement !== "undefined" && this.debugelement !== null) {
this.debugelement.innerHTML = msg;
if (typeof img !== "undefined") {
this.debugelement.insertBefore(img, this.debugelement.firstChild);
}
} else if (msg !== "")
alert(msg);
};
/**
* Get the snapshot image of this scene
* @returns { Object } The img DOM element
*/
rglwidgetClass.prototype.getSnapshot = function() {
var img;
if (typeof this.scene.snapshot !== "undefined") {
img = document.createElement("img");
img.src = this.scene.snapshot;
img.alt = "Snapshot";
}
return img;
};
/**
* Initial test for WebGL
*/
rglwidgetClass.prototype.initGL0 = function() {
if (!window.WebGLRenderingContext){
alert("Your browser does not support WebGL. See http://get.webgl.org");
return;
}
};
/**
* If we are in an ioslides or slidy presentation, get the
* DOM element of the current slide
* @returns { Object }
*/
rglwidgetClass.prototype.getSlide = function() {
var result = this.el, done = false;
while (result && !done && this.scene.context.rmarkdown) {
switch(this.scene.context.rmarkdown) {
case "ioslides_presentation":
if (result.tagName === "SLIDE") return result;
break;
case "slidy_presentation":
if (result.tagName === "DIV" && result.classList.contains("slide"))
return result;
break;
default: return null;
}
result = result.parentElement;
}
return null;
};
/**
* Is this scene visible in the browser?
* @returns { boolean }
*/
rglwidgetClass.prototype.isInBrowserViewport = function() {
var rect = this.canvas.getBoundingClientRect(),
windHeight = (window.innerHeight || document.documentElement.clientHeight),
windWidth = (window.innerWidth || document.documentElement.clientWidth);
if (this.scene.context && this.scene.context.rmarkdown !== null) {
if (this.slide)
return (this.scene.context.rmarkdown === "ioslides_presentation" &&
this.slide.classList.contains("current")) ||
(this.scene.context.rmarkdown === "slidy_presentation" &&
!this.slide.classList.contains("hidden"));
}
return (
rect.top >= -windHeight &&
rect.left >= -windWidth &&
rect.bottom <= 2*windHeight &&
rect.right <= 2*windWidth);
};
/**
* Initialize WebGL
* @returns { Object } the WebGL context
*/
rglwidgetClass.prototype.initGL = function() {
var self = this;
if (this.gl) {
if (!this.drawing && this.gl.isContextLost())
this.restartCanvas();
else
return this.gl;
}
// if (!this.isInBrowserViewport()) return; Return what??? At this point we know this.gl is null.
this.canvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
this.canvas.addEventListener("webglcontextlost",
this.onContextLost, false);
this.gl = this.canvas.getContext("webgl", this.webGLoptions) ||
this.canvas.getContext("experimental-webgl", this.webGLoptions);
this.index_uint = this.gl.getExtension("OES_element_index_uint");
var save = this.startDrawing();
this.initSphereGL();
Object.keys(this.scene.objects).forEach(function(key){
self.initObj(parseInt(key, 10));
});
this.stopDrawing(save);
return this.gl;
};
/**
* Resize the display to match element
* @param { Object } el - DOM element to match
*/
rglwidgetClass.prototype.resize = function(el) {
this.canvas.width = el.width;
this.canvas.height = el.height;
};
/**
* Draw the whole scene
*/
rglwidgetClass.prototype.drawScene = function() {
var gl = this.gl || this.initGL(),
wasDrawing = this.startDrawing();
if (!wasDrawing) {
if (this.select.state !== "inactive")
this.selectionChanged();
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1,1,1,1);
gl.depthMask(true); // Must be true before clearing depth buffer
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.drawSubscene(this.scene.rootSubscene, true);
this.drawSubscene(this.scene.rootSubscene, false);
}
this.stopDrawing(wasDrawing);
};
/**
* Change the displayed subset
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The subset control data.
*/
rglwidgetClass.prototype.subsetSetter = function(el, control) {
if (typeof control.subscenes === "undefined" ||
control.subscenes === null)
control.subscenes = this.scene.rootSubscene;
var value = Math.round(control.value),
subscenes = [].concat(control.subscenes),
fullset = [].concat(control.fullset),
i, j, entries, subsceneid,
adds = [], deletes = [],
ismissing = function(x) {
return fullset.indexOf(x) < 0;
},
tointeger = function(x) {
return parseInt(x, 10);
};
if (isNaN(value))
value = control.value = 0;
if (control.accumulate)
for (i=0; i <= value; i++)
adds = adds.concat(control.subsets[i]);
else
adds = adds.concat(control.subsets[value]);
deletes = fullset.filter(function(x) { return adds.indexOf(x) < 0; });
for (i = 0; i < subscenes.length; i++) {
subsceneid = subscenes[i];
if (typeof this.getObj(subsceneid) === "undefined")
this.alertOnce("typeof object is undefined");
for (j = 0; j < adds.length; j++)
this.addToSubscene(adds[j], subsceneid);
for (j = 0; j < deletes.length; j++)
this.delFromSubscene(deletes[j], subsceneid);
}
};
/**
* Change the requested property
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The property setter control data.
*/
rglwidgetClass.prototype.propertySetter = function(el, control)  {
var value = control.value,
values = [].concat(control.values),
svals = [].concat(control.param),
direct = values[0] === null,
entries = [].concat(control.entries),
ncol = entries.length,
nrow = values.length/ncol,
properties = this.repeatToLen(control.properties, ncol),
objids = this.repeatToLen(control.objids, ncol),
property, objid = objids[0],
obj = this.getObj(objid),
propvals, i, v1, v2, p, entry, gl, needsBinding,
newprop, newid,
getPropvals = function() {
if (property === "userMatrix")
return obj.par3d.userMatrix.getAsArray();
else if (property === "scale" || property === "FOV" || property === "zoom")
return [].concat(obj.par3d[property]);
else
return [].concat(obj[property]);
};
putPropvals = function(newvals) {
if (newvals.length == 1)
newvals = newvals[0];
if (property === "userMatrix")
obj.par3d.userMatrix.load(newvals);
else if (property === "scale" || property === "FOV" || property === "zoom")
obj.par3d[property] = newvals;
else
obj[property] = newvals;
};
if (direct && typeof value === "undefined")
return;
if (control.interp) {
values = values.slice(0, ncol).concat(values).
concat(values.slice(ncol*(nrow-1), ncol*nrow));
svals = [-Infinity].concat(svals).concat(Infinity);
for (i = 1; i < svals.length; i++) {
if (value <= svals[i]) {
if (svals[i] === Infinity)
p = 1;
else
p = (svals[i] - value)/(svals[i] - svals[i-1]);
break;
}
}
} else if (!direct) {
value = Math.round(value);
}
for (j=0; j<entries.length; j++) {
entry = entries[j];
newprop = properties[j];
newid = objids[j];
if (newprop !== property || newid != objid) {
if (typeof property !== "undefined")
putPropvals(propvals);
property = newprop;
objid = newid;
obj = this.getObj(objid);
propvals = getPropvals();
}
if (control.interp) {
v1 = values[ncol*(i-1) + j];
v2 = values[ncol*i + j];
this.setElement(propvals, entry, p*v1 + (1-p)*v2);
} else if (!direct) {
this.setElement(propvals, entry, values[ncol*value + j]);
} else {
this.setElement(propvals, entry, value[j]);
}
}
putPropvals(propvals);
needsBinding = [];
for (j=0; j < entries.length; j++) {
if (properties[j] === "values" &&
needsBinding.indexOf(objids[j]) === -1) {
needsBinding.push(objids[j]);
}
}
for (j=0; j < needsBinding.length; j++) {
gl = this.gl || this.initGL();
obj = this.getObj(needsBinding[j]);
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertices
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The vertext setter control data.
*/
rglwidgetClass.prototype.vertexSetter = function(el, control)  {
var svals = [].concat(control.param),
j, k, p, a, propvals, stride, ofs, obj, entry,
attrib,
ofss    = {x:"vofs", y:"vofs", z:"vofs",
red:"cofs", green:"cofs", blue:"cofs",
alpha:"cofs", radii:"radofs",
nx:"nofs", ny:"nofs", nz:"nofs",
ox:"oofs", oy:"oofs", oz:"oofs",
ts:"tofs", tt:"tofs"},
pos     = {x:0, y:1, z:2,
red:0, green:1, blue:2,
alpha:3,radii:0,
nx:0, ny:1, nz:2,
ox:0, oy:1, oz:2,
ts:0, tt:1},
values = control.values,
direct = values === null,
ncol,
interp = control.interp,
vertices = [].concat(control.vertices),
attributes = [].concat(control.attributes),
value = control.value, newval, aliases, alias;
ncol = Math.max(vertices.length, attributes.length);
if (!ncol)
return;
vertices = this.repeatToLen(vertices, ncol);
attributes = this.repeatToLen(attributes, ncol);
if (direct)
interp = false;
/* JSON doesn't pass Infinity */
svals[0] = -Infinity;
svals[svals.length - 1] = Infinity;
for (j = 1; j < svals.length; j++) {
if (value <= svals[j]) {
if (interp) {
if (svals[j] === Infinity)
p = 1;
else
p = (svals[j] - value)/(svals[j] - svals[j-1]);
} else {
if (svals[j] - value > value - svals[j-1])
j = j - 1;
}
break;
}
}
obj = this.getObj(control.objid);
// First, make sure color attributes vary in original
if (typeof obj.vOffsets !== "undefined") {
varies = true;
for (k = 0; k < ncol; k++) {
attrib = attributes[k];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0) {
switch(attrib) {
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(control.objid);
}
propvals = obj.values;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
for (k=0; k<ncol; k++) {
if (direct) {
newval = value;
} else if (interp) {
newval = p*values[j-1][k] + (1-p)*values[j][k];
} else {
newval = values[j][k];
}       
attrib = attributes[k];
vertex = vertices[k];
alias = aliases[vertex];
if (obj.type === "planes" || obj.type === "clipplanes") {
ofs = ["nx", "ny", "nz", "offset"].indexOf(attrib);
if (ofs >= 0) {
if (ofs < 3) {
if (obj.normals[vertex][ofs] != newval) {  // Assume no aliases here...
obj.normals[vertex][ofs] = newval;
obj.initialized = false;
}
} else {
if (obj.offsets[vertex][0] != newval) {
obj.offsets[vertex][0] = newval;
obj.initialized = false;
}
}
continue;
}
}
// Not a plane setting...
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0)
this.alertOnce("Attribute '"+attrib+"' not found in object "+control.objid);
else {
stride = obj.vOffsets.stride;
ofs = ofs + pos[attrib];
entry = vertex*stride + ofs;
propvals[entry] = newval;
if (typeof alias !== "undefined")
for (a = 0; a < alias.length; a++)
propvals[alias[a]*stride + ofs] = newval;
}
}
if (typeof obj.buf !== "undefined") {
var gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, propvals, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertex properties by age
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The age setter control data.
*/
rglwidgetClass.prototype.ageSetter = function(el, control) {
var objids = [].concat(control.objids),
nobjs = objids.length,
time = control.value,
births = [].concat(control.births),
ages = [].concat(control.ages),
steps = births.length,
j = Array(steps),
p = Array(steps),
i, k, age, j0, propvals, stride, ofs, objid, obj,
attrib, dim, varies, alias, aliases, a, d,
attribs = ["colors", "alpha", "radii", "vertices",
"normals", "origins", "texcoords",
"x", "y", "z",
"red", "green", "blue"],
ofss    = ["cofs", "cofs", "radofs", "vofs",
"nofs", "oofs", "tofs",
"vofs", "vofs", "vofs",
"cofs", "cofs", "cofs"],
dims    = [3,1,1,3,
3,2,2,
1,1,1,
1,1,1],
pos     = [0,3,0,0,
0,0,0,
0,1,2,
0,1,2];
/* Infinity doesn't make it through JSON */
ages[0] = -Infinity;
ages[ages.length-1] = Infinity;
for (i = 0; i < steps; i++) {
if (births[i] !== null) {  // NA in R becomes null
age = time - births[i];
for (j0 = 1; age > ages[j0]; j0++);
if (ages[j0] == Infinity)
p[i] = 1;
else if (ages[j0] > ages[j0-1])
p[i] = (ages[j0] - age)/(ages[j0] - ages[j0-1]);
else
p[i] = 0;
j[i] = j0;
}
}
// First, make sure color attributes vary in original
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
varies = true;
if (typeof obj.vOffsets === "undefined")
continue;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs < 0) {
switch(attribs[k]) {
case "colors":
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(objid);
}
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
if (typeof obj.vOffsets === "undefined")
continue;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
propvals = obj.values;
stride = obj.vOffsets.stride;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs >= 0) {
dim = dims[k];
ofs = ofs + pos[k];
for (i = 0; i < steps; i++) {
alias = aliases[i];
if (births[i] !== null) {
for (d=0; d < dim; d++) {
propvals[i*stride + ofs + d] = p[i]*attrib[dim*(j[i]-1) + d] + (1-p[i])*attrib[dim*j[i] + d];
if (typeof alias !== "undefined")
for (a=0; a < alias.length; a++)
propvals[alias[a]*stride + ofs + d] = propvals[i*stride + ofs + d];
}
}
}
} else
this.alertOnce("\'"+attribs[k]+"\' property not found in object "+objid);
}
}
obj.values = propvals;
if (typeof obj.buf !== "undefined") {
gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
}
};
/**
* Bridge to old style control
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The bridge control data.
*/
rglwidgetClass.prototype.oldBridge = function(el, control) {
var attrname, global = window[control.prefix + "rgl"];
if (global)
for (attrname in global)
this[attrname] = global[attrname];
window[control.prefix + "rgl"] = this;
};
/**
* Set up a player control
* @param { Object } el - The player control element
* @param { Object } control - The player data.
*/
rglwidgetClass.prototype.Player = function(el, control) {
var
self = this,
components = [].concat(control.components),
buttonLabels = [].concat(control.buttonLabels),
Tick = function() { /* "this" will be a timer */
var i,
nominal = this.value,
slider = this.Slider,
labels = this.outputLabels,
output = this.Output,
step;
if (typeof slider !== "undefined" && nominal != slider.value)
slider.value = nominal;
if (typeof output !== "undefined") {
step = Math.round((nominal - output.sliderMin)/output.sliderStep);
if (labels !== null) {
output.innerHTML = labels[step];
} else {
step = step*output.sliderStep + output.sliderMin;
output.innerHTML = step.toPrecision(output.outputPrecision);
}
}
for (i=0; i < this.actions.length; i++) {
this.actions[i].value = nominal;
}
self.applyControls(el, this.actions, false);
self.drawScene();
},
OnSliderInput = function() { /* "this" will be the slider */
this.rgltimer.value = Number(this.value);
this.rgltimer.Tick();
},
addSlider = function(min, max, step, value) {
var slider = document.createElement("input");
slider.type = "range";
slider.min = min;
slider.max = max;
slider.step = step;
slider.value = value;
slider.oninput = OnSliderInput;
slider.sliderActions = control.actions;
slider.sliderScene = this;
slider.className = "rgl-slider";
slider.id = el.id + "-slider";
el.rgltimer.Slider = slider;
slider.rgltimer = el.rgltimer;
el.appendChild(slider);
},
addLabel = function(labels, min, step, precision) {
var output = document.createElement("output");
output.sliderMin = min;
output.sliderStep = step;
output.outputPrecision = precision;
output.className = "rgl-label";
output.id = el.id + "-label";
el.rgltimer.Output = output;
el.rgltimer.outputLabels = labels;
el.appendChild(output);
},
addButton = function(which, label, active) {
var button = document.createElement("input"),
onclicks = {Reverse: function() { this.rgltimer.reverse();},
Play: function() { this.rgltimer.play();
this.value = this.rgltimer.enabled ? this.inactiveValue : this.activeValue; },
Slower: function() { this.rgltimer.slower(); },
Faster: function() { this.rgltimer.faster(); },
Reset: function() { this.rgltimer.reset(); },
Step:  function() { this.rgltimer.step(); }
};
button.rgltimer = el.rgltimer;
button.type = "button";
button.value = label;
button.activeValue = label;
button.inactiveValue = active;
if (which === "Play")
button.rgltimer.PlayButton = button;
button.onclick = onclicks[which];
button.className = "rgl-button";
button.id = el.id + "-" + which;
el.appendChild(button);
};
if (typeof control.reinit !== "undefined" && control.reinit !== null) {
control.actions.reinit = control.reinit;
}
el.rgltimer = new rgltimerClass(Tick, control.start, control.interval, control.stop,
control.step, control.value, control.rate, control.loop, control.actions);
for (var i=0; i < components.length; i++) {
switch(components[i]) {
case "Slider": addSlider(control.start, control.stop,
control.step, control.value);
break;
case "Label": addLabel(control.labels, control.start,
control.step, control.precision);
break;
default:
addButton(components[i], buttonLabels[i], control.pause);
}
}
el.rgltimer.Tick();
};
/**
* Apply all registered controls
* @param { Object } el - DOM element of the control
* @param { Object } x - List of actions to apply
* @param { boolean } [draw=true] - Whether to redraw after applying
*/
rglwidgetClass.prototype.applyControls = function(el, x, draw) {
var self = this, reinit = x.reinit, i, control, type;
for (i = 0; i < x.length; i++) {
control = x[i];
type = control.type;
self[type](el, control);
}
if (typeof reinit !== "undefined" && reinit !== null) {
reinit = [].concat(reinit);
for (i = 0; i < reinit.length; i++)
self.getObj(reinit[i]).initialized = false;
}
if (typeof draw === "undefined" || draw)
self.drawScene();
};
/**
* Handler for scene change
* @param { Object } message - What sort of scene change to do?
*/
rglwidgetClass.prototype.sceneChangeHandler = function(message) {
var self = document.getElementById(message.elementId).rglinstance,
objs = message.objects, mat = message.material,
root = message.rootSubscene,
initSubs = message.initSubscenes,
redraw = message.redrawScene,
skipRedraw = message.skipRedraw,
deletes, subs, allsubs = [], i,j;
if (typeof message.delete !== "undefined") {
deletes = [].concat(message.delete);
if (typeof message.delfromSubscenes !== "undefined")
subs = [].concat(message.delfromSubscenes);
else
subs = [];
for (i = 0; i < deletes.length; i++) {
for (j = 0; j < subs.length; j++) {
self.delFromSubscene(deletes[i], subs[j]);
}
delete self.scene.objects[deletes[i]];
}
}
if (typeof objs !== "undefined") {
Object.keys(objs).forEach(function(key){
key = parseInt(key, 10);
self.scene.objects[key] = objs[key];
self.initObj(key);
var obj = self.getObj(key),
subs = [].concat(obj.inSubscenes), k;
allsubs = allsubs.concat(subs);
for (k = 0; k < subs.length; k++)
self.addToSubscene(key, subs[k]);
});
}
if (typeof mat !== "undefined") {
self.scene.material = mat;
}
if (typeof root !== "undefined") {
self.scene.rootSubscene = root;
}
if (typeof initSubs !== "undefined")
allsubs = allsubs.concat(initSubs);
allsubs = self.unique(allsubs);
for (i = 0; i < allsubs.length; i++) {
self.initSubscene(allsubs[i]);
}
if (typeof skipRedraw !== "undefined") {
root = self.getObj(self.scene.rootSubscene);
root.par3d.skipRedraw = skipRedraw;
}
if (redraw)
self.drawScene();
};
/**
* Set mouse mode for a subscene
* @param { string } mode - name of mode
* @param { number } button - button number (1 to 3)
* @param { number } subscene - subscene id number
* @param { number } stayActive - if truthy, don't clear brush
*/
rglwidgetClass.prototype.setMouseMode = function(mode, button, subscene, stayActive) {
var sub = this.getObj(subscene),
which = ["left", "right", "middle"][button - 1];
if (!stayActive && sub.par3d.mouseMode[which] === "selecting")
this.clearBrush(null);
sub.par3d.mouseMode[which] = mode;
};
/**
* The class of an rgl timer object
* @class
*/
/**
* Construct an rgltimerClass object
* @constructor
* @param { function } Tick - action when timer fires
* @param { number } startTime - nominal start time in seconds
* @param { number } interval - seconds between updates
* @param { number } stopTime - nominal stop time in seconds
* @param { number } stepSize - nominal step size
* @param { number } value - current nominal time
* @param { number } rate - nominal units per second
* @param { string } loop - "none", "cycle" or "oscillate"
* @param { Object } actions - list of actions
*/
rgltimerClass = function(Tick, startTime, interval, stopTime, stepSize, value, rate, loop, actions) {
this.enabled = false;
this.timerId = 0;
/** nominal start time in seconds */
this.startTime = startTime;   
/** current nominal time */      
this.value = value;
/** seconds between updates */                 
this.interval = interval;
/** nominal stop time */           
this.stopTime = stopTime;
/** nominal step size */           
this.stepSize = stepSize;
/** nominal units per second */           
this.rate = rate;
/** "none", "cycle", or "oscillate" */                   
this.loop = loop;
/** real world start time */                   
this.realStart = undefined;
/** multiplier for fast-forward or reverse */         
this.multiplier = 1;                
this.actions = actions;
this.Tick = Tick;
};
/**
* Start playing timer object
*/
rgltimerClass.prototype.play = function() {
if (this.enabled) {
this.enabled = false;
window.clearInterval(this.timerId);
this.timerId = 0;
return;
}
var tick = function(self) {
var now = new Date();
self.value = self.multiplier*self.rate*(now - self.realStart)/1000 + self.startTime;
self.forceToRange();
if (typeof self.Tick !== "undefined") {
self.Tick(self.value);
}
};
this.realStart = new Date() - 1000*(this.value - this.startTime)/this.rate/this.multiplier;
this.timerId = window.setInterval(tick, 1000*this.interval, this);
this.enabled = true;
};
/**
* Force value into legal range
*/
rgltimerClass.prototype.forceToRange = function() {
if (this.value > this.stopTime + this.stepSize/2 || this.value < this.startTime - this.stepSize/2) {
if (!this.loop) {
this.reset();
} else {
var cycle = this.stopTime - this.startTime + this.stepSize,
newval = (this.value - this.startTime) % cycle + this.startTime;
if (newval < this.startTime) {
newval += cycle;
}
this.realStart += (this.value - newval)*1000/this.multiplier/this.rate;
this.value = newval;
}
}
};
/**
* Reset to start values
*/
rgltimerClass.prototype.reset = function() {
this.value = this.startTime;
this.newmultiplier(1);
if (typeof this.Tick !== "undefined") {
this.Tick(this.value);
}
if (this.enabled)
this.play();  /* really pause... */
if (typeof this.PlayButton !== "undefined")
this.PlayButton.value = "Play";
};
/**
* Increase the multiplier to play faster
*/
rgltimerClass.prototype.faster = function() {
this.newmultiplier(Math.SQRT2*this.multiplier);
};
/**
* Decrease the multiplier to play slower
*/
rgltimerClass.prototype.slower = function() {
this.newmultiplier(this.multiplier/Math.SQRT2);
};
/**
* Change sign of multiplier to reverse direction
*/
rgltimerClass.prototype.reverse = function() {
this.newmultiplier(-this.multiplier);
};
/**
* Set multiplier for play speed
* @param { number } newmult - new value
*/
rgltimerClass.prototype.newmultiplier = function(newmult) {
if (newmult != this.multiplier) {
this.realStart += 1000*(this.value - this.startTime)/this.rate*(1/this.multiplier - 1/newmult);
this.multiplier = newmult;
}
};
/**
* Take one step
*/
rgltimerClass.prototype.step = function() {
this.value += this.rate*this.multiplier;
this.forceToRange();
if (typeof this.Tick !== "undefined")
this.Tick(this.value);
};</script>
<div id="Sample_clustering_MDS_plotdiv" class="rglWebGL">

</div>
<script type="text/javascript">
var Sample_clustering_MDS_plotdiv = document.getElementById("Sample_clustering_MDS_plotdiv"),
Sample_clustering_MDS_plotrgl = new rglwidgetClass();
Sample_clustering_MDS_plotdiv.width = 673;
Sample_clustering_MDS_plotdiv.height = 481;
Sample_clustering_MDS_plotrgl.initialize(Sample_clustering_MDS_plotdiv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":1,"objects":{"7":{"id":7,"type":"points","material":{"lit":false,"size":6},"vertices":[[-0.5354632,-0.6635892,-0.3868492],[-0.6525,-0.8120626,-0.48107],[-0.4866261,-0.669313,-0.3124518],[1.133898,-0.248175,-0.5266891],[1.248301,-0.1096591,-0.2847941],[1.24368,-0.1470371,-0.467866],[1.21157,0.05332293,-0.2082963],[-0.4876152,-0.322009,0.4697881],[-0.5495156,-0.4992754,0.3173182],[-0.3703592,-0.4177786,0.4799015],[1.198602,-0.08468534,0.0699437],[1.419116,0.157444,0.3259569],[1.215907,-0.006956706,0.2580898],[1.196251,-0.01514557,0.1555833],[1.192215,0.3386267,0.5123454],[-0.5968296,-0.3452792,-0.2532429],[-0.6840421,-0.7154773,-0.3450951],[-0.6322123,-0.5575138,-0.08908502],[-0.647083,0.4217209,-0.5787768],[-0.6156667,0.3787557,-0.5338851],[-0.4968426,0.5849884,-0.4591612],[-0.5571406,-0.2907821,0.4028248],[-0.3198964,-0.1189971,0.8478774],[-0.5034947,-0.3835415,0.7037019],[-0.5229366,0.7430826,0.2784426],[-0.5244744,0.7317455,0.1942073],[-0.6371179,0.636673,0.03703783],[-0.6491583,0.5612117,0.1579747],[1.22171,0.02122605,-0.3416471],[-0.5147494,0.5523455,-0.5304666],[-0.633567,0.4966426,-0.6726102],[-0.2852323,-0.1315312,0.8811117],[-0.3787266,0.8610234,0.3798813]],"colors":[[0.7254902,0,0.09019608,1],[0.7254902,0,0.09019608,1],[0.7254902,0,0.09019608,1],[0.7411765,0.5058824,0.007843138,1],[0.7411765,0.5058824,0.007843138,1],[0.7411765,0.5058824,0.007843138,1],[0.7411765,0.5058824,0.007843138,1],[0.02352941,0.1921569,0.6117647,1],[0.02352941,0.1921569,0.6117647,1],[0.02352941,0.1921569,0.6117647,1],[0.1294118,0.6431373,0,1],[0.1294118,0.6431373,0,1],[0.1294118,0.6431373,0,1],[0.1294118,0.6431373,0,1],[0.1294118,0.6431373,0,1],[0.9843137,0.4156863,0.4823529,1],[0.9843137,0.4156863,0.4823529,1],[0.9843137,0.4156863,0.4823529,1],[1,0.8117647,0.4196078,1],[1,0.8117647,0.4196078,1],[1,0.8117647,0.4196078,1],[0.4196078,0.5490196,0.8705882,1],[0.4196078,0.5490196,0.8705882,1],[0.4196078,0.5490196,0.8705882,1],[0.509804,0.9372549,0.3960784,1],[0.509804,0.9372549,0.3960784,1],[0.509804,0.9372549,0.3960784,1],[0.509804,0.9372549,0.3960784,1],[0.7411765,0.5058824,0.007843138,1],[1,0.8117647,0.4196078,1],[1,0.8117647,0.4196078,1],[0.4196078,0.5490196,0.8705882,1],[0.509804,0.9372549,0.3960784,1]],"centers":[[-0.5354632,-0.6635892,-0.3868492],[-0.6525,-0.8120626,-0.48107],[-0.4866261,-0.669313,-0.3124518],[1.133898,-0.248175,-0.5266891],[1.248301,-0.1096591,-0.2847941],[1.24368,-0.1470371,-0.467866],[1.21157,0.05332293,-0.2082963],[-0.4876152,-0.322009,0.4697881],[-0.5495156,-0.4992754,0.3173182],[-0.3703592,-0.4177786,0.4799015],[1.198602,-0.08468534,0.0699437],[1.419116,0.157444,0.3259569],[1.215907,-0.006956706,0.2580898],[1.196251,-0.01514557,0.1555833],[1.192215,0.3386267,0.5123454],[-0.5968296,-0.3452792,-0.2532429],[-0.6840421,-0.7154773,-0.3450951],[-0.6322123,-0.5575138,-0.08908502],[-0.647083,0.4217209,-0.5787768],[-0.6156667,0.3787557,-0.5338851],[-0.4968426,0.5849884,-0.4591612],[-0.5571406,-0.2907821,0.4028248],[-0.3198964,-0.1189971,0.8478774],[-0.5034947,-0.3835415,0.7037019],[-0.5229366,0.7430826,0.2784426],[-0.5244744,0.7317455,0.1942073],[-0.6371179,0.636673,0.03703783],[-0.6491583,0.5612117,0.1579747],[1.22171,0.02122605,-0.3416471],[-0.5147494,0.5523455,-0.5304666],[-0.633567,0.4966426,-0.6726102],[-0.2852323,-0.1315312,0.8811117],[-0.3787266,0.8610234,0.3798813]],"ignoreExtent":false,"flags":4096},"9":{"id":9,"type":"text","material":{"lit":false},"vertices":[[0.3675368,-1.095651,-0.935966]],"colors":[[0,0,0,1]],"texts":[["log2 FC (Dimension 1)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[0.3675368,-1.095651,-0.935966]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"10":{"id":10,"type":"text","material":{"lit":false},"vertices":[[-1.040527,0.02448037,-0.935966]],"colors":[[0,0,0,1]],"texts":[["log2 FC (Dimension 2)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.040527,0.02448037,-0.935966]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"11":{"id":11,"type":"text","material":{"lit":false},"vertices":[[-1.040527,-1.095651,0.1042508]],"colors":[[0,0,0,1]],"texts":[["log2 FC (Dimension 3)"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.040527,-1.095651,0.1042508]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"5":{"id":5,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"4":{"id":4,"type":"background","material":{"fog":true},"colors":[[0.2980392,0.2980392,0.2980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"6":{"id":6,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[0.8980392,0.8980392,0.8980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"8":{"id":8,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-0.5,"NA","NA"],[0,"NA","NA"],[0.5,"NA","NA"],[1,"NA","NA"],["NA",-0.5,"NA"],["NA",0,"NA"],["NA",0.5,"NA"],["NA","NA",-0.5],["NA","NA",0],["NA","NA",0.5]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[20,21,22,23,24,25,26]},"1":{"id":1,"type":"subscene","par3d":{"antialias":1,"FOV":30,"ignoreExtent":false,"listeners":1,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,7.596206],"modelMatrix":[[0.8521737,0,0,-0.3132052],[0,0.3663814,1.083958,-0.1219727],[0,-1.006624,0.3945285,-7.612693],[0,0,0,1]],"projMatrix":[[2.665751,0,0,0],[0,3.732051,0,0],[0,0,-3.863704,-27.38345],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8521737,1.071227,1.153524],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-0.6840421,1.419116,-0.8120626,0.8610234,-0.6726102,0.8811117],"windowRect":[100,100,772,580],"family":"sans","font":1,"cex":1,"useFreeType":false,"fontname":"NULL","maxClipPlanes":2147483647,"glVersion":"NaN","activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,8,7,9,10,11,5,20,21,22,23,24,25,26],"subscenes":[],"flags":6736},"20":{"id":20,"type":"lines","material":{"lit":false},"vertices":[[-0.5,-0.8371589,-0.695916],[1,-0.8371589,-0.695916],[-0.5,-0.8371589,-0.695916],[-0.5,-0.8802409,-0.7359243],[0,-0.8371589,-0.695916],[0,-0.8802409,-0.7359243],[0.5,-0.8371589,-0.695916],[0.5,-0.8802409,-0.7359243],[1,-0.8371589,-0.695916],[1,-0.8802409,-0.7359243]],"colors":[[0,0,0,1]],"centers":[[0.25,-0.8371589,-0.695916],[-0.5,-0.8586999,-0.7159202],[0,-0.8586999,-0.7159202],[0.5,-0.8586999,-0.7159202],[1,-0.8586999,-0.7159202]],"ignoreExtent":true,"origId":8,"flags":64},"21":{"id":21,"type":"text","material":{"lit":false},"vertices":[[-0.5,-0.9664048,-0.815941],[0,-0.9664048,-0.815941],[0.5,-0.9664048,-0.815941],[1,-0.9664048,-0.815941]],"colors":[[0,0,0,1]],"texts":[["-0.5"],["0"],["0.5"],["1"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.5,-0.9664048,-0.815941],[0,-0.9664048,-0.815941],[0.5,-0.9664048,-0.815941],[1,-0.9664048,-0.815941]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"22":{"id":22,"type":"lines","material":{"lit":false},"vertices":[[-0.7155895,-0.5,-0.695916],[-0.7155895,0.5,-0.695916],[-0.7155895,-0.5,-0.695916],[-0.7697458,-0.5,-0.7359243],[-0.7155895,0,-0.695916],[-0.7697458,0,-0.7359243],[-0.7155895,0.5,-0.695916],[-0.7697458,0.5,-0.7359243]],"colors":[[0,0,0,1]],"centers":[[-0.7155895,0,-0.695916],[-0.7426676,-0.5,-0.7159202],[-0.7426676,0,-0.7159202],[-0.7426676,0.5,-0.7159202]],"ignoreExtent":true,"origId":8,"flags":64},"23":{"id":23,"type":"text","material":{"lit":false},"vertices":[[-0.8780584,-0.5,-0.815941],[-0.8780584,0,-0.815941],[-0.8780584,0.5,-0.815941]],"colors":[[0,0,0,1]],"texts":[["-0.5"],["0"],["0.5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.8780584,-0.5,-0.815941],[-0.8780584,0,-0.815941],[-0.8780584,0.5,-0.815941]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"24":{"id":24,"type":"lines","material":{"lit":false},"vertices":[[-0.7155895,-0.8371589,-0.5],[-0.7155895,-0.8371589,0.5],[-0.7155895,-0.8371589,-0.5],[-0.7697458,-0.8802409,-0.5],[-0.7155895,-0.8371589,0],[-0.7697458,-0.8802409,0],[-0.7155895,-0.8371589,0.5],[-0.7697458,-0.8802409,0.5]],"colors":[[0,0,0,1]],"centers":[[-0.7155895,-0.8371589,0],[-0.7426676,-0.8586999,-0.5],[-0.7426676,-0.8586999,0],[-0.7426676,-0.8586999,0.5]],"ignoreExtent":true,"origId":8,"flags":64},"25":{"id":25,"type":"text","material":{"lit":false},"vertices":[[-0.8780584,-0.9664048,-0.5],[-0.8780584,-0.9664048,0],[-0.8780584,-0.9664048,0.5]],"colors":[[0,0,0,1]],"texts":[["-0.5"],["0"],["0.5"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-0.8780584,-0.9664048,-0.5],[-0.8780584,-0.9664048,0],[-0.8780584,-0.9664048,0.5]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":8,"flags":2064},"26":{"id":26,"type":"lines","material":{"lit":false},"vertices":[[-0.7155895,-0.8371589,-0.695916],[-0.7155895,0.8861197,-0.695916],[-0.7155895,-0.8371589,0.9044176],[-0.7155895,0.8861197,0.9044176],[-0.7155895,-0.8371589,-0.695916],[-0.7155895,-0.8371589,0.9044176],[-0.7155895,0.8861197,-0.695916],[-0.7155895,0.8861197,0.9044176],[-0.7155895,-0.8371589,-0.695916],[1.450663,-0.8371589,-0.695916],[-0.7155895,-0.8371589,0.9044176],[1.450663,-0.8371589,0.9044176],[-0.7155895,0.8861197,-0.695916],[1.450663,0.8861197,-0.695916],[-0.7155895,0.8861197,0.9044176],[1.450663,0.8861197,0.9044176],[1.450663,-0.8371589,-0.695916],[1.450663,0.8861197,-0.695916],[1.450663,-0.8371589,0.9044176],[1.450663,0.8861197,0.9044176],[1.450663,-0.8371589,-0.695916],[1.450663,-0.8371589,0.9044176],[1.450663,0.8861197,-0.695916],[1.450663,0.8861197,0.9044176]],"colors":[[0,0,0,1]],"centers":[[-0.7155895,0.02448037,-0.695916],[-0.7155895,0.02448037,0.9044176],[-0.7155895,-0.8371589,0.1042508],[-0.7155895,0.8861197,0.1042508],[0.3675368,-0.8371589,-0.695916],[0.3675368,-0.8371589,0.9044176],[0.3675368,0.8861197,-0.695916],[0.3675368,0.8861197,0.9044176],[1.450663,0.02448037,-0.695916],[1.450663,0.02448037,0.9044176],[1.450663,-0.8371589,0.1042508],[1.450663,0.8861197,0.1042508]],"ignoreExtent":true,"origId":8,"flags":64}},"width":673,"height":481,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1],[0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]]},"context":{"shiny":false,"rmarkdown":"html_document"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
Sample_clustering_MDS_plotrgl.prefix = "Sample_clustering_MDS_plot";
</script>
<p id="Sample_clustering_MDS_plotdebug">
You must enable Javascript to view this page properly.
</p>
<script>Sample_clustering_MDS_plotrgl.start();</script>
<p>The MDS plot above can be rotated by clicking and dragging.</p>
<p>We observe a clear separation of samples on the basis of experimental factors. Both genotypes clearly segregate along Dimension 3, while Dimensions 1 and 2 delineate immediate and progressive responses to Dexamethasone treatment, respectively.</p>
</div>
<div id="clustering-highly-variable-genes" class="section level2">
<h2>Clustering highly variable genes</h2>
<p>We then plot a heatmap of the 500 most highly variable genes to investigate whether these are delineated by experimental grouping.</p>
<pre class="r"><code>#Get variance of log counts on a row-by-row basis
geneVariance &lt;- apply(logCounts, MARGIN = 1, FUN = var)
#Select the top 500
topVariableGenes &lt;- names(sort(geneVariance, decreasing = TRUE))[1:500]
topVariableLogCPM &lt;- logCounts[topVariableGenes, ]

heatmap.2(
  topVariableLogCPM,
  ColSideColors = as.character(sampleColours),
  trace = &quot;none&quot;,
  key = FALSE,
  labRow = FALSE
)</code></pre>
<p><img src="figure/Dexamethasone-study.Rmd/Variable-genes-heatmap-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>These genes are sufficient to separate experimental groupings, and show a primary separation on the basis of Dexamethasone treatment with a secondary separation by genotype. We then proceed to process the data for differential expression analysis.</p>
</div>
</div>
<div id="sample-processing" class="section level1">
<h1>Sample processing</h1>
<div id="normalisation" class="section level2">
<h2>Normalisation</h2>
<p>First we normalise samples to scale gene expression to library size, permitting comparisons across samples.</p>
<pre class="r"><code>y &lt;- calcNormFactors(y)</code></pre>
<p>We can observe a shift in the mean-difference plot of gene expression in the samples towards zero, indicating that the data are better scaled for comparison. <img src="figure/Dexamethasone-study.Rmd/MD-normalisation-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="model-design" class="section level2">
<h2>Model design</h2>
<p>We then construct a design matrix and convert the gene counts into a corresponding <em>voom</em> object from <em>limma</em> to normalise for a variety of factors. The below plot shows the estimated mean-variance trend (in red) used to correct for transcript length bias in the dataset.</p>
<pre class="r"><code>#Construct a design matrix delineating experimental groups
design &lt;- model.matrix(~ 0 + sampleGroups)
#Label the design matrix
colnames(design) &lt;- groups
rownames(design) &lt;- sampleInfo$Name

#Convert to a voom object
v &lt;- voom(y, design, plot = TRUE)</code></pre>
<p><img src="figure/Dexamethasone-study.Rmd/Voom-object-generation-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can see below that the normalisation process results in a more homogeneous distribution of counts across samples. The median count value is represented by a line in blue. <img src="figure/Dexamethasone-study.Rmd/Voom-normalisation-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="differential-expression-testing" class="section level1">
<h1>Differential expression testing</h1>
<div id="linear-modelling" class="section level2">
<h2>Linear modelling</h2>
<p>Differential expression is calculated by fitting a linear model to the normalised gene counts, and assessing differences across contrasting groups of interest. In each of the contrasts, we pool saline-treated samples because the different sampling timepoints show very similar results.</p>
<pre class="r"><code>fit &lt;- lmFit(v)

#Select testing comparisons to make
#The contrast matrix defines which contrasts will be selected for differential expression testing. Each contrast is labeled and defined individually below.
contrastMatrix &lt;- makeContrasts(
  #Genotype effect
  &#39;KO vs WT&#39; = (
    ((KO_SAL_3H + KO_SAL_24H + KO_DEX_3H + KO_DEX_24H) / 4) - 
      ((WT_SAL_3H + WT_SAL_24H + WT_DEX_3H + WT_DEX_24H) / 4)
    ),
  
  #Treatment effect
  &#39;Dex vs Saline&#39; = (
    ((WT_DEX_3H + WT_DEX_24H + KO_DEX_3H + KO_DEX_24H) / 4) -
      ((WT_SAL_3H + WT_SAL_24H + KO_SAL_3H + KO_SAL_24H) / 4)
    ),
  
  #Treatment-time interaction effect
  #A time effect is not modelled for saline samples due to their high similarity
  &#39;Change in overall Dex response over time&#39; = (
    ((KO_DEX_24H + WT_DEX_24H) / 2) -
      ((KO_DEX_3H + WT_DEX_3H) / 2)
    ),
  
  #Genotype-treatment interaction effect
  &#39;Overall genotype gap in Dex response&#39; = (
    ((((KO_DEX_3H + KO_DEX_24H) / 2) - ((KO_SAL_3H + KO_SAL_24H / 2)))) -
      (((WT_DEX_3H + WT_DEX_24H) / 2) - ((WT_SAL_3H + WT_SAL_24H / 2)))
    ),
  
  #Genotype-treatment-time interaction effect
  &#39;Time specific genotype gap in Dex response&#39; = (
    (KO_DEX_24H - WT_DEX_24H) -
      (KO_DEX_3H - WT_DEX_3H)
    ),
  levels = design
)</code></pre>
</div>
<div id="differential-expression-calculation" class="section level2">
<h2>Differential expression calculation</h2>
<p>Now that the linear model has been fit and contrasts have been defined, contrasts are fit to the linear model and probabilities are calculated for differential expression.</p>
<pre class="r"><code>#Compute coefficients for the fit linear model on the basis of the defined contrasts
contrastFit &lt;- contrasts.fit(fit, contrastMatrix)

#Estimate the probability of differential expression across these contrasts
contrastFit &lt;- eBayes(contrastFit)

#Store the results of differential expression testing
differentialExpressionResults &lt;- list()
for (i in seq_along(colnames(contrastFit))) {
  differentiallyExpressedGenes &lt;- topTable(
    contrastFit,
    coef = colnames(contrastFit)[i],
    sort.by = &quot;p&quot;,
    number = Inf
  )
  differentialExpressionResults[[i]] &lt;- differentiallyExpressedGenes
  rm(differentiallyExpressedGenes)
}
names(differentialExpressionResults) &lt;- colnames(contrastFit)</code></pre>
<p>We also identify significantly differentially expressed genes on the basis of a Benjamini-Hochberg procedure, with a nominal false discovery rate of 0.05. This uses the default settings of limma::decideTests.</p>
<pre class="r"><code>#Summarise the test results with decideTests
summaryFit &lt;- decideTests(contrastFit)</code></pre>
</div>
<div id="differential-expression-results" class="section level2">
<h2>Differential expression results</h2>
<p>The top 500 genes are presented for the <em>KO vs WT</em> contrast. <div id="htmlwidget-5a4604c77a8f94508fa9" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5a4604c77a8f94508fa9">{"x":{"filter":"none","data":[["Actn3","Slc2a3","Pla2g7","Pld5","Cd28","Phf7","Neto2","Tmem100","Snph","Igfn1","Gdpd5","Musk","1700001O22Rik","Myoz3","Stab2","Spns2","Adrbk1","Shc2","A830010M20Rik","Tceal7","E2f2","Mstn","Grem2","Abcc5","Zfp641","Dkk3","Npnt","Golm1","Lrp2bp","Egf","Csda","Sfxn3","Itpr1","Ankrd44","Mtss1l","Xrra1","Kcnf1","Gm4861","Krt222","Lingo3","Mlec","Gdap1","Ift122","Myom2","Ctxn3","Tead4","Mfap3l","Neu2","Samd10","Slc38a4","Hsd17b7","Ston2","Tpx2","Mybph","Lrrcc1","Plekhd1","Atmin","Fam69a","Fsd1l","Obsl1","Vldlr","Fth1","Wls","Ntng2","Spred3","Yipf7","Sbf1","Cacng7","Zfp180","2410137F16Rik","Gm13490","Gnl3l","Spag5","Zmat3","Grlf1","Il17re","Ly6g6e","Krt18","Ankrd23","Glcci1","Plekha2","3632451O06Rik","Tgif1","Cdkn2aipnl","Fgd4","Cnrip1","Cdkn2c","Amotl1","Col9a1","Fam122a","Kcnc4","Car3","Smim1","Npc1","Abhd16a","Prss23","Tnfrsf19","Myo1a","Fxr1","Bmpr1b","Arhgef6","Exoc4","Atp8a1","Tppp","Lgals1","Cpne2","Atp2b3","Nin","Tekt1","Dicer1","Rnf126","Syne1","Kcnab1","Actr3b","Serinc3","Itga9","Gadl1","Npepl1","Armcx3","9030617O03Rik","Pkp2","Slc30a2","4930453N24Rik","2310022B05Rik","Ccdc92","Smarcd3","Lmbr1","Tmc7","Ces1d","Odc1","Iws1","Ube2n","Lnp","Schip1","Fut8","Ttll7","Galm","Xirp2","Vamp1","Rpa1","Trim35","Ache","Ppp1r3b","Slc23a3","Itgb5","Gm4980","Gpx3","Polk","Vps72","Myot","Prepl","Chst11","Kcmf1","Morn4","Wdr37","Aimp2","Prkcd","Cyp4f39","2310015B20Rik","Mmd","Armcx4","Net1","Extl3","6530402F18Rik","Lsp1","Fam220a","Fmnl2","Rab12","Sesn3","Ddah1","Psmd8","Serf1","App","1110032A03Rik","Epdr1","Afap1l1","Atp1b2","Pmepa1","Smtnl2","Twsg1","Sorl1","Itgav","Htra1","Mpg","Tceal5","Sub1","Csnk2a1","Phc1","Slc1a1","Vps13a","Abcb4","Sorcs1","Tdrkh","Phtf2","Mpdz","Themis3","Jmjd4","Dtnb","Slc15a4","Pim1","Ppp1r14b","Rnf222","Klhdc1","Acot9","Otub2","Entpd5","Wnt4","Atp6v0e2","Sema4d","Cog6","Zfp467","Gtf3a","Nek6","Rian","Abcg4","Ccndbp1","Fam120a","Gm5113","Camk2d","Dcaf5","Zmpste24","Snap23","Mob1b","Acvr2a","Rhobtb2","Actr1b","Cast","Sec31b","Fgfr4","Shisa3","Camk2g","Enox2","Cpeb2","Hif3a","Itm2a","Cpe","Vasn","Tom1l2","Fam78b","Chrnb1","AW551984","Odf3l2","Sec14l1","Dusp3","Anxa11","Plekho1","Smpdl3b","Mbd2","Nup93","Hif1an","Idh3a","Sbk2","Srgap3","Eif4e3","Supt3","Pcolce2","Anapc15","Enho","Phospho1","Nipal3","Ap3s2","Abra","Itgb6","Me1","Pik3c2b","Pccb","Lmo7","Vwa7","Gramd1b","Dpysl5","Tmem123","Slc7a6","Nhlrc2","Nhs","Exoc3","Kpna6","Sgcb","AU022252","Zfp239","Pctp","Smox","Setbp1","Rdx","Adi1","Kcnc1","Zyg11b","Pbld2","Bmp8a","Adamts20","Tmem109","Whrn","Slc47a1","Igfbp5","Tns3","A930005H10Rik","Cdkal1","Zbed4","Zfp934","Dync1li2","Efha2","Tmem5","Mad2l2","Gm5918","Pla2g5","Pde7a","Fgfrl1","Slc38a2","Ldb3","Yaf2","ambiguous","Opn1mw","Sdha","Nfkbiz","Mdfic","Tmem135","Atp13a5","Piezo1","Asb12","Rabgef1","Hlcs","Lyz1","Hexim2","Katnal2","Dusp16","Gbas","Nudcd3","Taf10","C130080G10Rik","Ccnk","Msl3","Cd27","Cd55","Capn1","Klhl41","Pcx","Mapkapk3","Lrrc59","Dtnbp1","Tmx4","Tmem8","C030046E11Rik","Slc25a30","Abcb7","Mllt3","Wipi1","0610009O20Rik","Eml6","Grb2","Cry1","Tox4","Myoc","Atf4","Arid5a","Pde10a","Myl4","Tubgcp2","Hsd17b14","Gprc5b","Tmem150a","Cap2","Sgcg","Tiam1","Vamp5","Magt1","Dcun1d1","Ar","Bckdha","Zbtb18","Amigo1","Actc1","Ube3b","Elf3","Gm7120","Ap3s1","Exd2","Tmem192","Wdsub1","Akt1","2210416O15Rik","Stxbp2","Wdr35","Inpp5a","Anapc13","Sync","Frem2","Fam65b","Prkaa2","Tmem117","Atrx","Tmem161a","Stt3b","Fkbp9","Mrs2","Gclm","Abcg2","Xpr1","AI316807","Sgcd","Sipa1l1","Sacs","Pms2","1700020I14Rik","Fam13c","Cask","Blmh","Fbxo32","Csde1","Ubac2","Mbnl2","Sucla2","Alg10b","Epm2aip1","Tnfrsf21","Dpf1","Otog","Kif3c","St3gal6","Gca","Phf15","Scrn3","Ppm1l","Opa3","Hrc","Plekha1","Pdk1","Slc4a10","Gpcpd1","Gdf11","Ensa","Nek5","Asb16","Ak4","Mical2","Msi2","Amot","Cdc42","Chia","Ubc","Rfx5","Osbp","Ldlr","Slc9b2","Zdhhc16","Map2k3","Zfp358","Prdm4","Lmbrd2","Fbxo17","Agps","Acp2","Mfn1","Uso1","2510009E07Rik","Mmab","Fbxl16","Fam83d","Dnajc27","Gfra4","Ptpn11","Rab40b","Ctsf","Fez1","Gnl3","Ldhd","Calcr","Fbxl4","D5Ertd579e","Cnnm4","Traf3ip2","Wnk3","Ccdc47","Syt3","Fgf6","Golga7b","1110007C09Rik","Tppp3","Ppp2r5c","Tmem184a","Usp28","Ifitm10","Klhl7","1810041L15Rik","Sugp2","Ccdc134","Sugt1","Axin1","Peg3","Pole","Dnajc18","Cuedc1","Slc2a12","Ano5","Dmd","Sgms2","Tln2","Dedd","Bbs1","Hist1h4i","Clec2d","Bola3"],["Actn3        ","Slc2a3       ","Pla2g7       ","Pld5         ","Cd28         ","Phf7         ","Neto2        ","Tmem100      ","Snph         ","Igfn1        ","Gdpd5        ","Musk         ","1700001O22Rik","Myoz3        ","Stab2        ","Spns2        ","Adrbk1       ","Shc2         ","A830010M20Rik","Tceal7       ","E2f2         ","Mstn         ","Grem2        ","Abcc5        ","Zfp641       ","Dkk3         ","Npnt         ","Golm1        ","Lrp2bp       ","Egf          ","Csda         ","Sfxn3        ","Itpr1        ","Ankrd44      ","Mtss1l       ","Xrra1        ","Kcnf1        ","Gm4861       ","Krt222       ","Lingo3       ","Mlec         ","Gdap1        ","Ift122       ","Myom2        ","Ctxn3        ","Tead4        ","Mfap3l       ","Neu2         ","Samd10       ","Slc38a4      ","Hsd17b7      ","Ston2        ","Tpx2         ","Mybph        ","Lrrcc1       ","Plekhd1      ","Atmin        ","Fam69a       ","Fsd1l        ","Obsl1        ","Vldlr        ","Fth1         ","Wls          ","Ntng2        ","Spred3       ","Yipf7        ","Sbf1         ","Cacng7       ","Zfp180       ","2410137F16Rik","Gm13490      ","Gnl3l        ","Spag5        ","Zmat3        ","Grlf1        ","Il17re       ","Ly6g6e       ","Krt18        ","Ankrd23      ","Glcci1       ","Plekha2      ","3632451O06Rik","Tgif1        ","Cdkn2aipnl   ","Fgd4         ","Cnrip1       ","Cdkn2c       ","Amotl1       ","Col9a1       ","Fam122a      ","Kcnc4        ","Car3         ","Smim1        ","Npc1         ","Abhd16a      ","Prss23       ","Tnfrsf19     ","Myo1a        ","Fxr1         ","Bmpr1b       ","Arhgef6      ","Exoc4        ","Atp8a1       ","Tppp         ","Lgals1       ","Cpne2        ","Atp2b3       ","Nin          ","Tekt1        ","Dicer1       ","Rnf126       ","Syne1        ","Kcnab1       ","Actr3b       ","Serinc3      ","Itga9        ","Gadl1        ","Npepl1       ","Armcx3       ","9030617O03Rik","Pkp2         ","Slc30a2      ","4930453N24Rik","2310022B05Rik","Ccdc92       ","Smarcd3      ","Lmbr1        ","Tmc7         ","Ces1d        ","Odc1         ","Iws1         ","Ube2n        ","Lnp          ","Schip1       ","Fut8         ","Ttll7        ","Galm         ","Xirp2        ","Vamp1        ","Rpa1         ","Trim35       ","Ache         ","Ppp1r3b      ","Slc23a3      ","Itgb5        ","Gm4980       ","Gpx3         ","Polk         ","Vps72        ","Myot         ","Prepl        ","Chst11       ","Kcmf1        ","Morn4        ","Wdr37        ","Aimp2        ","Prkcd        ","Cyp4f39      ","2310015B20Rik","Mmd          ","Armcx4       ","Net1         ","Extl3        ","6530402F18Rik","Lsp1         ","Fam220a      ","Fmnl2        ","Rab12        ","Sesn3        ","Ddah1        ","Psmd8        ","Serf1        ","App          ","1110032A03Rik","Epdr1        ","Afap1l1      ","Atp1b2       ","Pmepa1       ","Smtnl2       ","Twsg1        ","Sorl1        ","Itgav        ","Htra1        ","Mpg          ","Tceal5       ","Sub1         ","Csnk2a1      ","Phc1         ","Slc1a1       ","Vps13a       ","Abcb4        ","Sorcs1       ","Tdrkh        ","Phtf2        ","Mpdz         ","Themis3      ","Jmjd4        ","Dtnb         ","Slc15a4      ","Pim1         ","Ppp1r14b     ","Rnf222       ","Klhdc1       ","Acot9        ","Otub2        ","Entpd5       ","Wnt4         ","Atp6v0e2     ","Sema4d       ","Cog6         ","Zfp467       ","Gtf3a        ","Nek6         ","Rian         ","Abcg4        ","Ccndbp1      ","Fam120a      ","Gm5113       ","Camk2d       ","Dcaf5        ","Zmpste24     ","Snap23       ","Mob1b        ","Acvr2a       ","Rhobtb2      ","Actr1b       ","Cast         ","Sec31b       ","Fgfr4        ","Shisa3       ","Camk2g       ","Enox2        ","Cpeb2        ","Hif3a        ","Itm2a        ","Cpe          ","Vasn         ","Tom1l2       ","Fam78b       ","Chrnb1       ","AW551984     ","Odf3l2       ","Sec14l1      ","Dusp3        ","Anxa11       ","Plekho1      ","Smpdl3b      ","Mbd2         ","Nup93        ","Hif1an       ","Idh3a        ","Sbk2         ","Srgap3       ","Eif4e3       ","Supt3        ","Pcolce2      ","Anapc15      ","Enho         ","Phospho1     ","Nipal3       ","Ap3s2        ","Abra         ","Itgb6        ","Me1          ","Pik3c2b      ","Pccb         ","Lmo7         ","Vwa7         ","Gramd1b      ","Dpysl5       ","Tmem123      ","Slc7a6       ","Nhlrc2       ","Nhs          ","Exoc3        ","Kpna6        ","Sgcb         ","AU022252     ","Zfp239       ","Pctp         ","Smox         ","Setbp1       ","Rdx          ","Adi1         ","Kcnc1        ","Zyg11b       ","Pbld2        ","Bmp8a        ","Adamts20     ","Tmem109      ","Whrn         ","Slc47a1      ","Igfbp5       ","Tns3         ","A930005H10Rik","Cdkal1       ","Zbed4        ","Zfp934       ","Dync1li2     ","Efha2        ","Tmem5        ","Mad2l2       ","Gm5918       ","Pla2g5       ","Pde7a        ","Fgfrl1       ","Slc38a2      ","Ldb3         ","Yaf2         ","ambiguous    ","Opn1mw       ","Sdha         ","Nfkbiz       ","Mdfic        ","Tmem135      ","Atp13a5      ","Piezo1       ","Asb12        ","Rabgef1      ","Hlcs         ","Lyz1         ","Hexim2       ","Katnal2      ","Dusp16       ","Gbas         ","Nudcd3       ","Taf10        ","C130080G10Rik","Ccnk         ","Msl3         ","Cd27         ","Cd55         ","Capn1        ","Klhl41       ","Pcx          ","Mapkapk3     ","Lrrc59       ","Dtnbp1       ","Tmx4         ","Tmem8        ","C030046E11Rik","Slc25a30     ","Abcb7        ","Mllt3        ","Wipi1        ","0610009O20Rik","Eml6         ","Grb2         ","Cry1         ","Tox4         ","Myoc         ","Atf4         ","Arid5a       ","Pde10a       ","Myl4         ","Tubgcp2      ","Hsd17b14     ","Gprc5b       ","Tmem150a     ","Cap2         ","Sgcg         ","Tiam1        ","Vamp5        ","Magt1        ","Dcun1d1      ","Ar           ","Bckdha       ","Zbtb18       ","Amigo1       ","Actc1        ","Ube3b        ","Elf3         ","Gm7120       ","Ap3s1        ","Exd2         ","Tmem192      ","Wdsub1       ","Akt1         ","2210416O15Rik","Stxbp2       ","Wdr35        ","Inpp5a       ","Anapc13      ","Sync         ","Frem2        ","Fam65b       ","Prkaa2       ","Tmem117      ","Atrx         ","Tmem161a     ","Stt3b        ","Fkbp9        ","Mrs2         ","Gclm         ","Abcg2        ","Xpr1         ","AI316807     ","Sgcd         ","Sipa1l1      ","Sacs         ","Pms2         ","1700020I14Rik","Fam13c       ","Cask         ","Blmh         ","Fbxo32       ","Csde1        ","Ubac2        ","Mbnl2        ","Sucla2       ","Alg10b       ","Epm2aip1     ","Tnfrsf21     ","Dpf1         ","Otog         ","Kif3c        ","St3gal6      ","Gca          ","Phf15        ","Scrn3        ","Ppm1l        ","Opa3         ","Hrc          ","Plekha1      ","Pdk1         ","Slc4a10      ","Gpcpd1       ","Gdf11        ","Ensa         ","Nek5         ","Asb16        ","Ak4          ","Mical2       ","Msi2         ","Amot         ","Cdc42        ","Chia         ","Ubc          ","Rfx5         ","Osbp         ","Ldlr         ","Slc9b2       ","Zdhhc16      ","Map2k3       ","Zfp358       ","Prdm4        ","Lmbrd2       ","Fbxo17       ","Agps         ","Acp2         ","Mfn1         ","Uso1         ","2510009E07Rik","Mmab         ","Fbxl16       ","Fam83d       ","Dnajc27      ","Gfra4        ","Ptpn11       ","Rab40b       ","Ctsf         ","Fez1         ","Gnl3         ","Ldhd         ","Calcr        ","Fbxl4        ","D5Ertd579e   ","Cnnm4        ","Traf3ip2     ","Wnk3         ","Ccdc47       ","Syt3         ","Fgf6         ","Golga7b      ","1110007C09Rik","Tppp3        ","Ppp2r5c      ","Tmem184a     ","Usp28        ","Ifitm10      ","Klhl7        ","1810041L15Rik","Sugp2        ","Ccdc134      ","Sugt1        ","Axin1        ","Peg3         ","Pole         ","Dnajc18      ","Cuedc1       ","Slc2a12      ","Ano5         ","Dmd          ","Sgms2        ","Tln2         ","Dedd         ","Bbs1         ","Hist1h4i     ","Clec2d       ","Bola3        "],["11474    ","20527    ","27226    ","319455   ","12487    ","71838    ","74513    ","67888    ","241727   ","226438   ","233552   ","18198    ","73598    ","170947   ","192188   ","216892   ","NA       ","216148   ","231570   ","100040972","242705   ","17700    ","23893    ","27416    ","239652   ","50781    ","114249   ","105348   ","67620    ","13645    ","NA       ","94280    ","16438    ","329154   ","NA       ","446101   ","382571   ","229862   ","268481   ","237403   ","109154   ","14545    ","81896    ","17930    ","629147   ","21679    ","71306    ","23956    ","229011   ","69354    ","15490    ","108800   ","72119    ","53311    ","71710    ","217682   ","234776   ","NA       ","319636   ","98733    ","22359    ","14319    ","68151    ","171171   ","101809   ","75581    ","77980    ","81904    ","210135   ","NA       ","433426   ","237107   ","54141    ","22401    ","NA       ","57890    ","70274    ","16668    ","78321    ","170772   ","83436    ","NA       ","21815    ","52626    ","224014   ","380686   ","12580    ","75723    ","12839    ","68034    ","99738    ","12350    ","68859    ","18145    ","193742   ","76453    ","29820    ","432516   ","14359    ","12167    ","73341    ","20336    ","11980    ","72948    ","16852    ","234577   ","320707   ","18080    ","21689    ","192119   ","70294    ","64009    ","16497    ","242894   ","26943    ","104099   ","73748    ","228961   ","71703    ","NA       ","67451    ","230810   ","67609    ","69551    ","215707   ","66993    ","56873    ","209760   ","104158   ","18263    ","73473    ","93765    ","NA       ","30953    ","53618    ","70892    ","319625   ","241431   ","22317    ","68275    ","66854    ","11423    ","244416   ","22626    ","16419    ","NA       ","14778    ","27015    ","21427    ","58916    ","213760   ","58250    ","74287    ","226123   ","207615   ","231872   ","18753    ","320997   ","NA       ","67468    ","100503043","56349    ","54616    ","76220    ","16985    ","67238    ","71409    ","19328    ","75747    ","69219    ","57296    ","20365    ","11820    ","68721    ","105298   ","106877   ","11932    ","65112    ","276829   ","65960    ","20660    ","16410    ","56213    ","268395   ","331532   ","20024    ","12995    ","13619    ","20510    ","271564   ","18670    ","58178    ","72634    ","68770    ","17475    ","74556    ","194952   ","13528    ","100561   ","18712    ","18938    ","320040   ","271005   ","56360    ","68149    ","12499    ","22417    ","76252    ","20354    ","67542    ","68910    ","66596    ","59126    ","75745    ","192663   ","17151    ","218236   ","330503   ","108058   ","320808   ","230709   ","20619    ","68473    ","11480    ","246710   ","226977   ","12380    ","240667   ","14186    ","330096   ","12325    ","209224   ","231207   ","53417    ","16431    ","12876    ","246154   ","216810   ","226610   ","11443    ","244810   ","382384   ","74136    ","72349    ","11744    ","67220    ","100340   ","17191    ","71805    ","319594   ","67834    ","381836   ","259302   ","66892    ","109115   ","76477    ","75430    ","69638    ","237928   ","74552    ","11778    ","223513   ","16420    ","17436    ","240752   ","66904    ","380928   ","27762    ","235283   ","65254    ","71929    ","330836   ","66866    ","195727   ","211446   ","16650    ","24051    ","230696   ","22685    ","18559    ","228608   ","240427   ","19684    ","104923   ","16502    ","414872   ","67307    ","12163    ","223838   ","68539    ","73750    ","67473    ","16011    ","319939   ","68161    ","68916    ","223773   ","77117    ","234663   ","NA       ","NA       ","71890    ","NA       ","18784    ","18583    ","116701   ","67760    ","24131    ","67057    ","NA       ","14539    ","66945    ","80859    ","16543    ","72759    ","268878   ","234839   ","70392    ","56715    ","110948   ","17110    ","71059    ","71206    ","70686    ","NA       ","209586   ","24075    ","100303644","12454    ","17692    ","21940    ","13136    ","12333    ","228003   ","18563    ","102626   ","98238    ","94245    ","52837    ","60455    ","NA       ","67554    ","11306    ","70122    ","52639    ","NA       ","237711   ","14784    ","12952    ","268741   ","17926    ","11911    ","214855   ","23984    ","17896    ","74237    ","66065    ","64297    ","232086   ","67252    ","24053    ","21844    ","53620    ","67075    ","114893   ","11835    ","12039    ","30928    ","229715   ","11464    ","117146   ","13710    ","NA       ","11777    ","97827    ","73067    ","72137    ","11651    ","70393    ","20911    ","74682    ","212111   ","69010    ","68828    ","242022   ","NA       ","108079   ","320709   ","22589    ","234371   ","68292    ","27055    ","380836   ","14630    ","26357    ","19775    ","NA       ","24052    ","217692   ","50720    ","18861    ","66602    ","71721    ","12361    ","104184   ","67731    ","229663   ","68889    ","105559   ","20916    ","380959   ","77781    ","94185    ","29861    ","18419    ","16570    ","54613    ","227960   ","NA       ","74616    ","242083   ","403187   ","15464    ","101476   ","228026   ","94229    ","74182    ","14561    ","56205    ","330721   ","217217   ","11639    ","320878   ","76626    ","27494    ","12540    ","NA       ","22190    ","53970    ","76303    ","16835    ","97086    ","74168    ","26397    ","140482   ","72843    ","320506   ","50760    ","228061   ","11432    ","67414    ","56041    ","72190    ","77697    ","214931   ","71878    ","217378   ","14588    ","19247    ","217371   ","56464    ","235180   ","30877    ","52815    ","12311    ","269514   ","320661   ","94220    ","103213   ","279561   ","67163    ","20981    ","14177    ","71146    ","NA       ","67971    ","26931    ","231832   ","235323   ","320802   ","52323    ","NA       ","234373   ","76457    ","67955    ","12005    ","18616    ","18973    ","76594    ","103841   ","353169   ","233246   ","13405    ","74442    ","70549    ","21945    ","52028    ","319158   ","93694    ","78653    "],["actinin alpha 3                                                                                                 ","solute carrier family 2 (facilitated glucose transporter), member 3                                             ","phospholipase A2, group VII (platelet-activating factor acetylhydrolase, plasma)                                ","phospholipase D family, member 5                                                                                ","CD28 antigen                                                                                                    ","PHD finger protein 7                                                                                            ","neuropilin (NRP) and tolloid (TLL)-like 2                                                                       ","transmembrane protein 100                                                                                       ","syntaphilin                                                                                                     ","immunoglobulin-like and fibronectin type III domain containing 1                                                ","glycerophosphodiester phosphodiesterase domain containing 5                                                     ","muscle, skeletal, receptor tyrosine kinase                                                                      ","RIKEN cDNA 1700001O22 gene                                                                                      ","myozenin 3                                                                                                      ","stabilin 2                                                                                                      ","spinster homolog 2                                                                                              ","NA                                                                                                              ","SHC (Src homology 2 domain containing) transforming protein 2                                                   ","RIKEN cDNA A830010M20 gene                                                                                      ","transcription elongation factor A (SII)-like 7                                                                  ","E2F transcription factor 2                                                                                      ","myostatin                                                                                                       ","gremlin 2, DAN family BMP antagonist                                                                            ","ATP-binding cassette, sub-family C (CFTR/MRP), member 5                                                         ","zinc finger protein 641                                                                                         ","dickkopf WNT signaling pathway inhibitor 3                                                                      ","nephronectin                                                                                                    ","golgi membrane protein 1                                                                                        ","Lrp2 binding protein                                                                                            ","epidermal growth factor                                                                                         ","NA                                                                                                              ","sideroflexin 3                                                                                                  ","inositol 1,4,5-trisphosphate receptor 1                                                                         ","ankyrin repeat domain 44                                                                                        ","NA                                                                                                              ","X-ray radiation resistance associated 1                                                                         ","potassium voltage-gated channel, subfamily F, member 1                                                          ","predicted gene 4861                                                                                             ","keratin 222                                                                                                     ","leucine rich repeat and Ig domain containing 3                                                                  ","malectin                                                                                                        ","ganglioside-induced differentiation-associated-protein 1                                                        ","intraflagellar transport 122                                                                                    ","myomesin 2                                                                                                      ","cortexin 3                                                                                                      ","TEA domain family member 4                                                                                      ","microfibrillar-associated protein 3-like                                                                        ","neuraminidase 2                                                                                                 ","sterile alpha motif domain containing 10                                                                        ","solute carrier family 38, member 4                                                                              ","hydroxysteroid (17-beta) dehydrogenase 7                                                                        ","stonin 2                                                                                                        ","TPX2, microtubule-associated                                                                                    ","myosin binding protein H                                                                                        ","leucine rich repeat and coiled-coil domain containing 1                                                         ","pleckstrin homology domain containing, family D (with coiled-coil domains) member 1                             ","ATM interactor                                                                                                  ","NA                                                                                                              ","fibronectin type III and SPRY domain containing 1-like                                                          ","obscurin-like 1                                                                                                 ","very low density lipoprotein receptor                                                                           ","ferritin heavy polypeptide 1                                                                                    ","wntless WNT ligand secretion mediator                                                                           ","netrin G2                                                                                                       ","sprouty-related EVH1 domain containing 3                                                                        ","Yip1 domain family, member 7                                                                                    ","SET binding factor 1                                                                                            ","calcium channel, voltage-dependent, gamma subunit 7                                                             ","zinc finger protein 180                                                                                         ","NA                                                                                                              ","predicted gene 13490                                                                                            ","guanine nucleotide binding protein-like 3 (nucleolar)-like                                                      ","sperm associated antigen 5                                                                                      ","zinc finger matrin type 3                                                                                       ","NA                                                                                                              ","interleukin 17 receptor E                                                                                       ","lymphocyte antigen 6 complex, locus G6E                                                                         ","keratin 18                                                                                                      ","ankyrin repeat domain 23                                                                                        ","glucocorticoid induced transcript 1                                                                             ","pleckstrin homology domain-containing, family A (phosphoinositide binding specific) member 2                    ","NA                                                                                                              ","TGFB-induced factor homeobox 1                                                                                  ","CDKN2A interacting protein N-terminal like                                                                      ","FYVE, RhoGEF and PH domain containing 4                                                                         ","cannabinoid receptor interacting protein 1                                                                      ","cyclin dependent kinase inhibitor 2C                                                                            ","angiomotin-like 1                                                                                               ","collagen, type IX, alpha 1                                                                                      ","family with sequence similarity 122, member A                                                                   ","potassium voltage gated channel, Shaw-related subfamily, member 4                                               ","carbonic anhydrase 3                                                                                            ","small integral membrane protein 1                                                                               ","NPC intracellular cholesterol transporter 1                                                                     ","abhydrolase domain containing 16A                                                                               ","protease, serine 23                                                                                             ","tumor necrosis factor receptor superfamily, member 19                                                           ","myosin IA                                                                                                       ","fragile X mental retardation gene 1, autosomal homolog                                                          ","bone morphogenetic protein receptor, type 1B                                                                    ","Rac/Cdc42 guanine nucleotide exchange factor (GEF) 6                                                            ","exocyst complex component 4                                                                                     ","ATPase, aminophospholipid transporter (APLT), class I, type 8A, member 1                                        ","tubulin polymerization promoting protein                                                                        ","lectin, galactose binding, soluble 1                                                                            ","copine II                                                                                                       ","ATPase, Ca++ transporting, plasma membrane 3                                                                    ","ninein                                                                                                          ","tektin 1                                                                                                        ","dicer 1, ribonuclease type III                                                                                  ","ring finger protein 126                                                                                         ","spectrin repeat containing, nuclear envelope 1                                                                  ","potassium voltage-gated channel, shaker-related subfamily, beta member 1                                        ","ARP3 actin-related protein 3B                                                                                   ","serine incorporator 3                                                                                           ","integrin alpha 9                                                                                                ","glutamate decarboxylase-like 1                                                                                  ","aminopeptidase-like 1                                                                                           ","armadillo repeat containing, X-linked 3                                                                         ","NA                                                                                                              ","plakophilin 2                                                                                                   ","solute carrier family 30 (zinc transporter), member 2                                                           ","RIKEN cDNA 4930453N24 gene                                                                                      ","RIKEN cDNA 2310022B05 gene                                                                                      ","coiled-coil domain containing 92                                                                                ","SWI/SNF related, matrix associated, actin dependent regulator of chromatin, subfamily d, member 3               ","limb region 1                                                                                                   ","transmembrane channel-like gene family 7                                                                        ","carboxylesterase 1D                                                                                             ","ornithine decarboxylase, structural 1                                                                           ","IWS1, SUPT6 interacting protein                                                                                 ","ubiquitin-conjugating enzyme E2N                                                                                ","NA                                                                                                              ","schwannomin interacting protein 1                                                                               ","fucosyltransferase 8                                                                                            ","tubulin tyrosine ligase-like family, member 7                                                                   ","galactose mutarotase                                                                                            ","xin actin-binding repeat containing 2                                                                           ","vesicle-associated membrane protein 1                                                                           ","replication protein A1                                                                                          ","tripartite motif-containing 35                                                                                  ","acetylcholinesterase                                                                                            ","protein phosphatase 1, regulatory subunit 3B                                                                    ","solute carrier family 23 (nucleobase transporters), member 3                                                    ","integrin beta 5                                                                                                 ","NA                                                                                                              ","glutathione peroxidase 3                                                                                        ","polymerase (DNA directed), kappa                                                                                ","vacuolar protein sorting 72                                                                                     ","myotilin                                                                                                        ","prolyl endopeptidase-like                                                                                       ","carbohydrate sulfotransferase 11                                                                                ","potassium channel modulatory factor 1                                                                           ","MORN repeat containing 4                                                                                        ","WD repeat domain 37                                                                                             ","aminoacyl tRNA synthetase complex-interacting multifunctional protein 2                                         ","protein kinase C, delta                                                                                         ","cytochrome P450, family 4, subfamily f, polypeptide 39                                                          ","NA                                                                                                              ","monocyte to macrophage differentiation-associated                                                               ","armadillo repeat containing, X-linked 4                                                                         ","neuroepithelial cell transforming gene 1                                                                        ","exostoses (multiple)-like 3                                                                                     ","RIKEN cDNA 6530402F18 gene                                                                                      ","lymphocyte specific 1                                                                                           ","family with sequence similarity 220, member A                                                                   ","formin-like 2                                                                                                   ","RAB12, member RAS oncogene family                                                                               ","sestrin 3                                                                                                       ","dimethylarginine dimethylaminohydrolase 1                                                                       ","proteasome (prosome, macropain) 26S subunit, non-ATPase, 8                                                      ","small EDRK-rich factor 1                                                                                        ","amyloid beta (A4) precursor protein                                                                             ","RIKEN cDNA 1110032A03 gene                                                                                      ","ependymin related protein 1 (zebrafish)                                                                         ","actin filament associated protein 1-like 1                                                                      ","ATPase, Na+/K+ transporting, beta 2 polypeptide                                                                 ","prostate transmembrane protein, androgen induced 1                                                              ","smoothelin-like 2                                                                                               ","twisted gastrulation BMP signaling modulator 1                                                                  ","sortilin-related receptor, LDLR class A repeats-containing                                                      ","integrin alpha V                                                                                                ","HtrA serine peptidase 1                                                                                         ","N-methylpurine-DNA glycosylase                                                                                  ","transcription elongation factor A (SII)-like 5                                                                  ","SUB1 homolog, transcriptional regulator                                                                         ","casein kinase 2, alpha 1 polypeptide                                                                            ","polyhomeotic 1                                                                                                  ","solute carrier family 1 (neuronal/epithelial high affinity glutamate transporter, system Xag), member 1         ","vacuolar protein sorting 13A                                                                                    ","ATP-binding cassette, sub-family B (MDR/TAP), member 4                                                          ","sortilin-related VPS10 domain containing receptor 1                                                             ","tudor and KH domain containing protein                                                                          ","putative homeodomain transcription factor 2                                                                     ","multiple PDZ domain protein                                                                                     ","thymocyte selection associated family member 3                                                                  ","jumonji domain containing 4                                                                                     ","dystrobrevin, beta                                                                                              ","solute carrier family 15, member 4                                                                              ","proviral integration site 1                                                                                     ","protein phosphatase 1, regulatory inhibitor subunit 14B                                                         ","ring finger protein 222                                                                                         ","kelch domain containing 1                                                                                       ","acyl-CoA thioesterase 9                                                                                         ","OTU domain, ubiquitin aldehyde binding 2                                                                        ","ectonucleoside triphosphate diphosphohydrolase 5                                                                ","wingless-type MMTV integration site family, member 4                                                            ","ATPase, H+ transporting, lysosomal V0 subunit E2                                                                ","sema domain, immunoglobulin domain (Ig), transmembrane domain (TM) and short cytoplasmic domain, (semaphorin) 4D","component of oligomeric golgi complex 6                                                                         ","zinc finger protein 467                                                                                         ","general transcription factor III A                                                                              ","NIMA (never in mitosis gene a)-related expressed kinase 6                                                       ","RNA imprinted and accumulated in nucleus                                                                        ","ATP binding cassette subfamily G member 4                                                                       ","cyclin D-type binding-protein 1                                                                                 ","family with sequence similarity 120, member A                                                                   ","predicted gene 5113                                                                                             ","calcium/calmodulin-dependent protein kinase II, delta                                                           ","DDB1 and CUL4 associated factor 5                                                                               ","zinc metallopeptidase, STE24                                                                                    ","synaptosomal-associated protein 23                                                                              ","MOB kinase activator 1B                                                                                         ","activin receptor IIA                                                                                            ","Rho-related BTB domain containing 2                                                                             ","ARP1 actin-related protein 1B, centractin beta                                                                  ","calpastatin                                                                                                     ","Sec31 homolog B (S. cerevisiae)                                                                                 ","fibroblast growth factor receptor 4                                                                             ","shisa family member 3                                                                                           ","calcium/calmodulin-dependent protein kinase II gamma                                                            ","ecto-NOX disulfide-thiol exchanger 2                                                                            ","cytoplasmic polyadenylation element binding protein 2                                                           ","hypoxia inducible factor 3, alpha subunit                                                                       ","integral membrane protein 2A                                                                                    ","carboxypeptidase E                                                                                              ","vasorin                                                                                                         ","target of myb1-like 2 (chicken)                                                                                 ","family with sequence similarity 78, member B                                                                    ","cholinergic receptor, nicotinic, beta polypeptide 1 (muscle)                                                    ","expressed sequence AW551984                                                                                     ","outer dense fiber of sperm tails 3-like 2                                                                       ","SEC14-like lipid binding 1                                                                                      ","dual specificity phosphatase 3 (vaccinia virus phosphatase VH1-related)                                         ","annexin A11                                                                                                     ","pleckstrin homology domain containing, family O member 1                                                        ","sphingomyelin phosphodiesterase, acid-like 3B                                                                   ","methyl-CpG binding domain protein 2                                                                             ","nucleoporin 93                                                                                                  ","hypoxia-inducible factor 1, alpha subunit inhibitor                                                             ","isocitrate dehydrogenase 3 (NAD+) alpha                                                                         ","SH3-binding domain kinase family, member 2                                                                      ","SLIT-ROBO Rho GTPase activating protein 3                                                                       ","eukaryotic translation initiation factor 4E member 3                                                            ","suppressor of Ty 3                                                                                              ","procollagen C-endopeptidase enhancer 2                                                                          ","anaphase prompoting complex C subunit 15                                                                        ","energy homeostasis associated                                                                                   ","phosphatase, orphan 1                                                                                           ","NIPA-like domain containing 3                                                                                   ","adaptor-related protein complex 3, sigma 2 subunit                                                              ","actin-binding Rho activating protein                                                                            ","integrin beta 6                                                                                                 ","malic enzyme 1, NADP(+)-dependent, cytosolic                                                                    ","phosphatidylinositol-4-phosphate 3-kinase catalytic subunit type 2 beta                                         ","propionyl Coenzyme A carboxylase, beta polypeptide                                                              ","LIM domain only 7                                                                                               ","von Willebrand factor A domain containing 7                                                                     ","GRAM domain containing 1B                                                                                       ","dihydropyrimidinase-like 5                                                                                      ","transmembrane protein 123                                                                                       ","solute carrier family 7 (cationic amino acid transporter, y+ system), member 6                                  ","NHL repeat containing 2                                                                                         ","NHS actin remodeling regulator                                                                                  ","exocyst complex component 3                                                                                     ","karyopherin (importin) alpha 6                                                                                  ","sarcoglycan, beta (dystrophin-associated glycoprotein)                                                          ","expressed sequence AU022252                                                                                     ","zinc finger protein 239                                                                                         ","phosphatidylcholine transfer protein                                                                            ","spermine oxidase                                                                                                ","SET binding protein 1                                                                                           ","radixin                                                                                                         ","acireductone dioxygenase 1                                                                                      ","potassium voltage gated channel, Shaw-related subfamily, member 1                                               ","zyg-ll family member B, cell cycle regulator                                                                    ","phenazine biosynthesis-like protein domain containing 2                                                         ","bone morphogenetic protein 8a                                                                                   ","a disintegrin-like and metallopeptidase (reprolysin type) with thrombospondin type 1 motif, 20                  ","transmembrane protein 109                                                                                       ","whirlin                                                                                                         ","solute carrier family 47, member 1                                                                              ","insulin-like growth factor binding protein 5                                                                    ","tensin 3                                                                                                        ","RIKEN cDNA A930005H10 gene                                                                                      ","CDK5 regulatory subunit associated protein 1-like 1                                                             ","zinc finger, BED type containing 4                                                                              ","zinc finger protein 934                                                                                         ","dynein, cytoplasmic 1 light intermediate chain 2                                                                ","NA                                                                                                              ","NA                                                                                                              ","MAD2 mitotic arrest deficient-like 2                                                                            ","NA                                                                                                              ","phospholipase A2, group V                                                                                       ","phosphodiesterase 7A                                                                                            ","fibroblast growth factor receptor-like 1                                                                        ","solute carrier family 38, member 2                                                                              ","LIM domain binding 3                                                                                            ","YY1 associated factor 2                                                                                         ","NA                                                                                                              ","opsin 1 (cone pigments), medium-wave-sensitive (color blindness, deutan)                                        ","succinate dehydrogenase complex, subunit A, flavoprotein (Fp)                                                   ","nuclear factor of kappa light polypeptide gene enhancer in B cells inhibitor, zeta                              ","MyoD family inhibitor domain containing                                                                         ","transmembrane protein 135                                                                                       ","ATPase type 13A5                                                                                                ","piezo-type mechanosensitive ion channel component 1                                                             ","ankyrin repeat and SOCS box-containing 12                                                                       ","RAB guanine nucleotide exchange factor (GEF) 1                                                                  ","holocarboxylase synthetase (biotin- [propriony-Coenzyme A-carboxylase (ATP-hydrolysing)] ligase)                ","lysozyme 1                                                                                                      ","hexamethylene bis-acetamide inducible 2                                                                         ","katanin p60 subunit A-like 2                                                                                    ","dual specificity phosphatase 16                                                                                 ","NA                                                                                                              ","NudC domain containing 3                                                                                        ","TATA-box binding protein associated factor 10                                                                   ","RIKEN cDNA C130080G10 gene                                                                                      ","cyclin K                                                                                                        ","MSL complex subunit 3                                                                                           ","CD27 antigen                                                                                                    ","CD55 molecule, decay accelerating factor for complement                                                         ","calpain 1                                                                                                       ","kelch-like 41                                                                                                   ","pyruvate carboxylase                                                                                            ","mitogen-activated protein kinase-activated protein kinase 3                                                     ","leucine rich repeat containing 59                                                                               ","dystrobrevin binding protein 1                                                                                  ","thioredoxin-related transmembrane protein 4                                                                     ","transmembrane protein 8                                                                                         ","NA                                                                                                              ","solute carrier family 25, member 30                                                                             ","ATP-binding cassette, sub-family B (MDR/TAP), member 7                                                          ","myeloid/lymphoid or mixed-lineage leukemia; translocated to, 3                                                  ","WD repeat domain, phosphoinositide interacting 1                                                                ","NA                                                                                                              ","echinoderm microtubule associated protein like 6                                                                ","growth factor receptor bound protein 2                                                                          ","cryptochrome 1 (photolyase-like)                                                                                ","TOX high mobility group box family member 4                                                                     ","myocilin                                                                                                        ","activating transcription factor 4                                                                               ","AT rich interactive domain 5A (MRF1-like)                                                                       ","phosphodiesterase 10A                                                                                           ","myosin, light polypeptide 4                                                                                     ","tubulin, gamma complex associated protein 2                                                                     ","hydroxysteroid (17-beta) dehydrogenase 14                                                                       ","G protein-coupled receptor, family C, group 5, member B                                                         ","transmembrane protein 150A                                                                                      ","CAP, adenylate cyclase-associated protein, 2 (yeast)                                                            ","sarcoglycan, gamma (dystrophin-associated glycoprotein)                                                         ","T cell lymphoma invasion and metastasis 1                                                                       ","vesicle-associated membrane protein 5                                                                           ","magnesium transporter 1                                                                                         ","DCN1, defective in cullin neddylation 1, domain containing 1 (S. cerevisiae)                                    ","androgen receptor                                                                                               ","branched chain ketoacid dehydrogenase E1, alpha polypeptide                                                     ","zinc finger and BTB domain containing 18                                                                        ","adhesion molecule with Ig like domain 1                                                                         ","actin, alpha, cardiac muscle 1                                                                                  ","ubiquitin protein ligase E3B                                                                                    ","E74-like factor 3                                                                                               ","NA                                                                                                              ","adaptor-related protein complex 3, sigma 1 subunit                                                              ","exonuclease 3'-5' domain containing 2                                                                           ","transmembrane protein 192                                                                                       ","WD repeat, SAM and U-box domain containing 1                                                                    ","thymoma viral proto-oncogene 1                                                                                  ","RIKEN cDNA 2210416O15 gene                                                                                      ","syntaxin binding protein 2                                                                                      ","WD repeat domain 35                                                                                             ","inositol polyphosphate-5-phosphatase A                                                                          ","anaphase promoting complex subunit 13                                                                           ","syncoilin                                                                                                       ","Fras1 related extracellular matrix protein 2                                                                    ","NA                                                                                                              ","protein kinase, AMP-activated, alpha 2 catalytic subunit                                                        ","transmembrane protein 117                                                                                       ","ATRX, chromatin remodeler                                                                                       ","transmembrane protein 161A                                                                                      ","STT3, subunit of the oligosaccharyltransferase complex, homolog B (S. cerevisiae)                               ","FK506 binding protein 9                                                                                         ","MRS2 magnesium transporter                                                                                      ","glutamate-cysteine ligase, modifier subunit                                                                     ","ATP binding cassette subfamily G member 2 (Junior blood group)                                                  ","xenotropic and polytropic retrovirus receptor 1                                                                 ","NA                                                                                                              ","sarcoglycan, delta (dystrophin-associated glycoprotein)                                                         ","signal-induced proliferation-associated 1 like 1                                                                ","sacsin                                                                                                          ","PMS1 homolog2, mismatch repair system component                                                                 ","RIKEN cDNA 1700020I14 gene                                                                                      ","family with sequence similarity 13, member C                                                                    ","calcium/calmodulin-dependent serine protein kinase (MAGUK family)                                               ","bleomycin hydrolase                                                                                             ","F-box protein 32                                                                                                ","cold shock domain containing E1, RNA binding                                                                    ","ubiquitin associated domain containing 2                                                                        ","muscleblind like splicing factor 2                                                                              ","succinate-Coenzyme A ligase, ADP-forming, beta subunit                                                          ","asparagine-linked glycosylation 10B (alpha-1,2-glucosyltransferase)                                             ","EPM2A (laforin) interacting protein 1                                                                           ","tumor necrosis factor receptor superfamily, member 21                                                           ","D4, zinc and double PHD fingers family 1                                                                        ","otogelin                                                                                                        ","kinesin family member 3C                                                                                        ","ST3 beta-galactoside alpha-2,3-sialyltransferase 6                                                              ","grancalcin                                                                                                      ","NA                                                                                                              ","secernin 3                                                                                                      ","protein phosphatase 1 (formerly 2C)-like                                                                        ","optic atrophy 3                                                                                                 ","histidine rich calcium binding protein                                                                          ","pleckstrin homology domain containing, family A (phosphoinositide binding specific) member 1                    ","pyruvate dehydrogenase kinase, isoenzyme 1                                                                      ","solute carrier family 4, sodium bicarbonate cotransporter-like, member 10                                       ","glycerophosphocholine phosphodiesterase 1                                                                       ","growth differentiation factor 11                                                                                ","endosulfine alpha                                                                                               ","NIMA (never in mitosis gene a)-related expressed kinase 5                                                       ","ankyrin repeat and SOCS box-containing 16                                                                       ","adenylate kinase 4                                                                                              ","microtubule associated monooxygenase, calponin and LIM domain containing 2                                      ","musashi RNA-binding protein 2                                                                                   ","angiomotin                                                                                                      ","cell division cycle 42                                                                                          ","NA                                                                                                              ","ubiquitin C                                                                                                     ","regulatory factor X, 5 (influences HLA class II expression)                                                     ","oxysterol binding protein                                                                                       ","low density lipoprotein receptor                                                                                ","solute carrier family 9, subfamily B (NHA2, cation proton antiporter 2), member 2                               ","zinc finger, DHHC domain containing 16                                                                          ","mitogen-activated protein kinase kinase 3                                                                       ","zinc finger protein 358                                                                                         ","PR domain containing 4                                                                                          ","LMBR1 domain containing 2                                                                                       ","F-box protein 17                                                                                                ","alkylglycerone phosphate synthase                                                                               ","acid phosphatase 2, lysosomal                                                                                   ","mitofusin 1                                                                                                     ","USO1 vesicle docking factor                                                                                     ","RIKEN cDNA 2510009E07 gene                                                                                      ","methylmalonic aciduria (cobalamin deficiency) cblB type homolog (human)                                         ","F-box and leucine-rich repeat protein 16                                                                        ","family with sequence similarity 83, member D                                                                    ","DnaJ heat shock protein family (Hsp40) member C27                                                               ","glial cell line derived neurotrophic factor family receptor alpha 4                                             ","protein tyrosine phosphatase, non-receptor type 11                                                              ","Rab40B, member RAS oncogene family                                                                              ","cathepsin F                                                                                                     ","fasciculation and elongation protein zeta 1 (zygin I)                                                           ","guanine nucleotide binding protein-like 3 (nucleolar)                                                           ","lactate dehydrogenase D                                                                                         ","calcitonin receptor                                                                                             ","F-box and leucine-rich repeat protein 4                                                                         ","DNA segment, Chr 5, ERATO Doi 579, expressed                                                                    ","cyclin M4                                                                                                       ","TRAF3 interacting protein 2                                                                                     ","WNK lysine deficient protein kinase 3                                                                           ","coiled-coil domain containing 47                                                                                ","synaptotagmin III                                                                                               ","fibroblast growth factor 6                                                                                      ","golgi autoantigen, golgin subfamily a, 7B                                                                       ","NA                                                                                                              ","tubulin polymerization-promoting protein family member 3                                                        ","protein phosphatase 2, regulatory subunit B', gamma                                                             ","transmembrane protein 184a                                                                                      ","ubiquitin specific peptidase 28                                                                                 ","interferon induced transmembrane protein 10                                                                     ","kelch-like 7                                                                                                    ","NA                                                                                                              ","SURP and G patch domain containing 2                                                                            ","coiled-coil domain containing 134                                                                               ","SGT1, suppressor of G2 allele of SKP1 (S. cerevisiae)                                                           ","axin 1                                                                                                          ","paternally expressed 3                                                                                          ","polymerase (DNA directed), epsilon                                                                              ","DnaJ heat shock protein family (Hsp40) member C18                                                               ","CUE domain containing 1                                                                                         ","solute carrier family 2 (facilitated glucose transporter), member 12                                            ","anoctamin 5                                                                                                     ","dystrophin, muscular dystrophy                                                                                  ","sphingomyelin synthase 2                                                                                        ","talin 2                                                                                                         ","death effector domain-containing                                                                                ","Bardet-Biedl syndrome 1 (human)                                                                                 ","histone cluster 1, H4i                                                                                          ","C-type lectin domain family 2, member d                                                                         ","bolA-like 3 (E. coli)                                                                                           "],["-7.1644985","-2.5087323","-1.9249565","-3.9296392","1.5972206","-0.9454440","-3.0269259","-2.1631803","-1.4604799","-2.4254498","-0.9592543","-1.3236172","-3.7326612","0.6363806","-1.5305870","-1.3380452","0.9783597","-1.2735419","1.3694577","2.1489541","1.4494571","-1.0767372","-2.5680647","0.5410583","0.8377324","-2.0883556","-1.9526570","-0.7270395","1.1376340","0.7240018","-0.7404973","0.5482433","-0.7673217","-0.5754559","-0.7724064","-2.5347889","-3.2359200","-1.7739934","1.1962293","-0.7895919","0.4776430","-0.9132835","1.1839269","0.6311713","-1.1915587","-0.9207753","-0.6754617","0.7526876","-0.6608888","-0.8571480","-0.7502805","0.5107343","-1.1875279","1.5106160","0.6816099","-3.3396167","-0.3347987","-0.6356604","0.8611151","0.7877698","-0.6376983","-0.5824894","-0.6599539","0.7379491","-0.8447801","0.4633633","-0.4220771","-1.1012790","-0.4849487","1.4260882","0.7461415","0.3890014","0.8098924","0.4535469","-0.5230708","-1.9753080","-3.1697983","1.7813017","0.7428024","-0.6906602","0.5940778","0.6000362","-0.7536086","-0.5131701","-0.5794254","0.8184782","-0.7728173","-0.4166527","-2.1449974","-0.7426056","0.5853504","-1.1275356","-0.9413405","-0.6648589","-0.4455389","0.4731973","0.9490259","1.7651882","0.3359901","-0.6530834","0.5099671","0.3966594","0.5810820","-0.5452878","-0.5342516","1.2225472","0.4863118","0.5094159","-1.2606513","-0.3483980","-0.8224871","-0.5151022","-1.0826638","-0.8066426","-0.3763159","0.4883405","-0.9149594","-0.3711964","0.3922866","-0.6629273","-0.8287867","-0.7463330","-0.3731179","0.4983397","1.7433571","-0.5629820","0.5186304","0.3906322","-0.9180447","-0.9587832","0.3957693","0.3111435","0.4229149","1.2726106","-0.3847770","-0.5478250","-0.7486957","0.5393424","0.4091162","0.3794291","0.7227469","0.5692299","-0.9503114","2.1727218","-0.3744016","-0.8962748","-0.5940394","-0.6834140","-0.5376606","0.5257100","0.5465252","-0.9662391","-0.3675971","-0.6324128","0.3896851","0.8307543","-0.7717045","0.6993018","-0.9324435","-0.4769701","0.5378305","-0.5636747","0.2856794","0.7576045","-0.5162565","-0.4860728","-0.4426444","-0.4699967","0.6365798","-0.8757111","-0.4329991","-0.8691465","0.2685801","-0.3759676","0.3804814","0.2896440","0.7155493","-0.6825068","-0.4632762","0.3027801","0.2929713","0.3588203","-0.5585484","-0.5567631","0.6885094","-0.3471948","0.2570160","-0.6034961","0.7664172","0.3244155","0.3190505","-0.9878278","-0.6883472","0.3862804","0.3021115","-4.3802287","0.3381469","-0.8576547","-0.4779887","-0.8425497","-0.6506490","1.7156976","0.4763765","0.5060768","-0.8366762","0.2960662","-0.6620007","0.3041161","0.3657115","0.3694957","-0.4563417","-0.4566103","-0.8762237","0.8603585","0.6550060","0.3463564","-0.2479441","0.5208743","0.3805213","-0.2979888","0.2884731","0.2798349","0.4642120","-0.4097533","-0.3363009","0.2811968","0.2771663","0.3297406","0.6455197","-0.5784433","0.2495089","-0.7668120","-0.4534349","-0.9012004","0.4906157","0.4292810","-0.5637747","0.3687912","-0.6920115","0.5294188","1.5921902","-1.1379951","-0.3138111","0.3676120","0.4142424","-0.6725882","-0.7911990","-0.3122196","-0.3167194","0.3810074","0.2408181","-0.7669062","0.7714759","0.2891349","-0.6270753","-0.3263644","-0.3958447","-1.0021156","-0.5791041","0.3364074","0.2387071","0.7354480","0.5923860","-0.4018544","0.4122104","0.2616156","0.3565407","0.5132824","0.5653922","0.7256339","-0.3136814","0.4186091","0.3421044","-0.9174875","0.2481294","0.2051015","0.2667858","0.3043804","-1.0263774","-0.5787253","-0.8920205","-0.4930911","0.2851043","-0.3198957","0.5550816","0.3780529","0.8672080","-1.9400201","0.8778433","0.3850895","-0.7345889","0.7418101","-0.7231718","0.3981028","-0.5258793","0.2688619","-0.3414807","-0.6556313","0.2174553","0.4427190","-0.3511481","-0.3503968","-0.4543619","-1.0546939","-0.3747559","-0.3138112","-0.5359332","0.4956959","-0.3379798","-0.2164153","-2.5194153","0.2374147","-0.4898270","0.3117494","-0.3053610","-0.6545446","-0.4030943","0.3586598","-0.3189566","0.3055816","-0.8253103","-0.6182685","0.9435653","0.2731109","0.2065719","0.2465713","-0.4664607","-2.5578373","-0.4112280","0.2667924","-1.1397734","0.4022653","0.2909990","0.2882556","-0.4847136","-0.3038577","-0.2245586","-0.3394473","0.2974690","0.5810832","-0.2463348","-1.1480862","0.3092153","0.3665844","0.2765982","0.2358358","-0.4703240","0.1903967","-0.3358711","0.2443204","-0.3122080","-0.3924766","0.5310212","1.0262028","-0.8135981","0.2437829","-0.9337138","-0.3281373","-0.3316175","0.3685460","0.2453137","-0.6117758","-0.4204163","0.2784114","0.3020086","-0.6295193","0.2889631","-0.2396941","-0.3242740","-1.0451942","0.2067083","-1.4523004","-0.7927825","-0.3398558","0.2557096","-0.4226622","-0.3342626","-0.2846880","-1.3344202","-0.4541178","0.2992914","-0.3173388","-0.3111237","0.3632302","0.7589813","-0.6917833","0.2573220","0.3230531","0.4158545","0.2269922","-0.2882578","-0.1916889","0.2516329","-0.4112990","0.4065972","-0.3918783","-0.3369315","0.4095075","0.2975620","0.9820597","0.4252679","0.4268435","-0.3247473","-0.2431263","0.2623870","-0.9152559","0.2540854","-0.3046782","0.3059229","0.2685866","0.3382928","0.3205455","-0.3667638","-0.8025513","-1.3633753","-0.3319209","0.3385172","0.3918949","-0.3695007","0.2353393","0.2444409","0.3067295","0.3088805","0.2096275","0.2250641","-0.6959302","-0.4014911","-0.5796768","0.2628456","0.7964366","0.4962205","0.8004950","0.4123155","0.2879072","0.3653060","0.2052877","1.0604207","-0.6427464","0.4117521","0.2256285","-0.4671167","1.6467816","-0.2511419","0.2832085","-0.4253735","-0.2449320","0.3682123","-0.4571807","0.2713434","0.2194496","0.2130971","0.2185912","0.3246069","0.2299192","0.7722041","-0.8811160","0.1883765","-0.9308267","-0.2232147","0.4347557","0.2752295","-0.4736244","-0.2828493","0.3099599","1.0262261","-0.3308819","0.2136296","0.4593677","-0.4564347","-0.6461071","0.2942042","-0.5956887","0.6262822","0.8689116","-0.5317916","0.5981733","0.1852107","1.0479918","0.3431732","-0.7147149","0.3635340","0.8518749","0.3320453","-0.5220602","0.2865831","-0.2534576","0.5521785","0.5070076","0.2235188","-0.3193985","0.3130908","0.2839074","0.3282226","0.6186385","0.2649773","-0.2067038","0.4565949","-0.9385126","-0.5103142","-0.3123185"],["9.004677155","2.205827528","4.929852422","-0.996501640","3.089708782","2.534157207","1.982527780","2.806337037","1.182622603","5.240976256","2.148796688","4.325216619","2.443599952","7.772103746","3.496636335","5.786962446","6.105080472","2.288829022","3.450120466","4.666532029","1.718462095","6.118312181","1.523030979","6.213683711","4.259906571","3.643279583","3.575659126","3.924602875","3.617021829","5.549558955","9.076250709","4.733604247","5.178928910","3.334751934","5.957068116","-2.801922910","1.461244475","-1.026323292","1.084152615","2.979627113","7.573582234","4.209078419","3.199732331","10.716440605","3.664914021","2.824824794","3.394408056","2.746906579","1.921507232","7.093500200","2.531851329","7.151546393","1.821122416","6.712154893","3.707249089","-1.873817271","5.052005710","3.927514517","3.754155671","4.810826550","8.134044424","9.081017584","4.833768767","1.987475465","1.740968337","6.009295647","5.559302863","3.033134542","4.607484842","1.165392280","1.472459062","5.819947438","1.929810034","3.980090473","5.670431454","-1.800082658","-2.203592759","-2.126336908","10.960626101","2.385141596","4.417854023","1.791962584","1.895219953","4.389294697","3.674734773","1.189071719","2.440199864","9.119917681","-1.825020242","3.331962341","5.736898344","9.172765360","2.046294313","6.589212427","5.633485321","5.743331084","4.244001188","-1.450389467","8.713096956","2.506325846","6.085656174","5.809223785","6.996827824","4.073622997","7.458823670","3.393467883","3.721079918","5.367712491","-0.342189539","5.876981674","4.567783022","6.456537823","1.773198250","3.528963568","7.960841350","3.421954655","2.486486608","5.760564347","3.785171838","4.100991603","0.567296243","4.383181233","5.375776443","3.953312847","-0.823294727","6.201575968","3.758311363","3.935630260","4.776249366","6.803692837","5.173548474","5.103493233","6.535432998","0.146633718","4.132090705","8.312628895","1.825874020","12.210770636","4.408100491","5.624713431","6.544029861","4.333841877","0.385787012","-2.117847586","5.724183880","4.968533720","8.107428702","4.207554587","5.260107681","10.345962545","4.192423353","2.009410049","7.741292542","1.535784645","4.853079777","6.559188519","3.641371634","2.847124684","3.346786303","3.994382636","4.903887064","6.316235622","6.043279547","2.235872666","4.150246015","5.823536608","3.707792074","7.385655302","2.122850173","2.220536749","7.248840804","0.572768180","6.753323478","3.230325105","6.277073563","5.284488644","8.540123985","4.147820468","7.651551691","5.332075173","5.650708062","5.329250289","4.494067905","1.406299354","4.143763381","5.728220724","6.806327215","4.253230996","2.114406199","5.267563706","7.320042772","0.027037786","1.886759516","7.472536947","6.840190254","-1.544247011","4.115339055","0.862417353","3.229725859","2.657379895","3.934521355","-2.050264706","4.613532842","4.218088657","3.328899539","4.477561139","3.374206632","5.203521826","5.680804955","6.476027139","3.416717286","3.593867830","2.903339999","3.205666602","1.152526914","4.185106932","7.362704184","3.086392079","5.926908499","6.106423802","5.228868102","5.784165746","4.224835672","5.216694121","4.470071380","6.336507980","6.434560839","5.270008586","0.898201204","1.532115851","7.219852203","2.979304914","4.292651668","1.456858048","6.241029114","7.287183591","2.339750783","6.894868526","1.668292953","4.525217542","0.646684535","4.598453291","5.501654893","7.233662072","6.900193715","2.812464134","-0.126979087","4.986750261","3.230187176","8.056345901","8.877351674","4.237757782","1.351058096","5.128990230","2.877051455","3.191532439","2.440269778","1.531082698","6.165980840","4.147011924","5.370035141","6.989876434","4.749112051","7.561469378","4.505417312","6.138792056","6.480408549","4.339652672","2.660249317","0.771057926","4.960121111","4.008698439","3.052376680","0.924840315","5.835258394","6.926399415","6.898173068","3.694402528","-0.706019175","1.754631929","7.365809486","4.033639170","7.509919196","5.691377172","6.188073290","7.054167995","-0.473085665","-1.203932975","2.094819666","7.262928656","-0.029157578","4.181024189","9.164649811","4.324517412","2.289404653","4.496545518","3.171901595","0.010547745","6.620962940","4.149450645","4.101587081","2.319131448","1.812880241","-0.943768484","6.094785911","3.948332369","6.477493957","10.892183824","3.680678705","11.194457668","-3.064479889","9.669211865","1.563789454","3.568609295","4.256393413","1.839511727","5.370026913","4.938010314","6.103938132","3.643549469","1.987176789","0.553756451","0.997770949","4.748101741","8.577932003","5.817619114","2.825932236","-2.489181232","6.813190168","5.248476021","0.175082384","5.805211539","6.248658272","8.894021560","6.268306988","5.170356746","4.815851295","4.069409079","4.426195893","0.825936507","5.105395777","2.396668488","6.576237581","6.893360535","5.612004466","6.203714921","1.060472301","5.563473039","3.009679153","6.459817426","5.850298156","6.795617847","1.995193764","2.490630765","0.484796636","4.224994074","-0.773243164","4.308110887","3.888300296","8.547401733","7.105548623","3.367804744","3.945268311","5.091260604","5.681227199","3.508961257","6.733499119","6.776959176","5.068897796","5.363709194","7.527608728","-1.854605524","3.700412525","2.930352230","4.754576012","3.098691722","2.956600863","5.288767247","-2.205091125","1.367194673","3.383169062","6.281995126","4.184232911","5.554259993","0.029190359","3.424234157","8.519903040","3.813364722","6.318014447","5.475005578","6.555134195","6.146059066","4.111592189","3.543099366","4.447253820","7.065991800","3.819320583","4.705305094","4.497544784","-0.375170445","2.114788980","7.221841133","3.204646197","3.541393702","4.444491588","8.597223332","10.129003931","4.445021532","8.090982426","8.549452235","4.555039968","5.844793817","4.809891690","-0.120224533","0.974576090","6.041187989","7.011981746","2.400690622","3.909739325","6.311897664","6.674082417","5.858991876","10.016159140","5.302668505","6.063955214","0.359274565","8.014638080","3.000371053","6.884646313","-0.009474609","5.208212934","2.117974311","6.943850689","7.659199994","6.575082524","7.431089793","-0.926749340","5.137796542","3.111388939","6.140217821","3.902544452","-2.649811026","3.472742401","7.105934493","4.902727854","4.596302275","3.518754776","1.352545575","5.100732681","4.881498856","7.477862186","6.489323189","5.486251990","5.123087892","0.965343230","0.682983752","6.578757881","-1.412903035","7.162996543","3.401302526","4.248864827","1.622682930","4.204525113","4.803133046","-1.324654326","4.096787642","7.030411879","3.395228711","2.104000835","0.826255380","7.205719356","0.966935423","0.822324292","1.641179224","4.909485702","4.272738156","6.121907673","-1.195022179","5.614798807","-0.598853873","5.283309952","-0.542674942","4.792321906","2.270892508","5.654082158","4.150183437","4.950288002","1.361894576","5.054318587","6.643306882","3.158934230","8.112993044","7.235467518","1.468548690","6.787576157","4.511329031","1.846984338","1.768670507","4.291025099","4.755951695"],["-100.442001","-22.855140","-21.246879","-17.826377","17.155865","-16.790215","-16.611288","-16.440956","-16.162051","-14.908066","-14.559286","-14.540752","-14.472510","14.353115","-14.302369","-14.085953","13.382794","-13.311358","13.310505","13.055011","12.813119","-12.641388","-12.528019","12.136494","12.130977","-12.093091","-12.065537","-11.948375","11.762323","11.651370","-11.614281","11.572264","-11.508386","-11.445593","-11.345228","-11.075584","-10.965835","-10.922231","10.782610","-10.693024","10.660570","-10.613153","10.459815","10.455499","-10.438385","-10.434659","-10.397326","10.311657","-10.303981","-10.289446","-10.239338","10.227284","-10.095771","10.075342","9.941821","-9.908646","-9.855382","-9.819941","9.791970","9.770563","-9.757122","-9.677879","-9.669401","9.611755","-9.593724","9.573412","-9.511079","-9.434883","-9.421585","9.408436","9.336354","9.331941","9.306510","9.303041","-9.278814","-9.225102","-9.178986","9.169789","9.154562","-9.145774","9.127917","9.046392","-9.041465","-8.998526","-8.987538","8.970284","-8.961066","-8.960136","-8.922615","-8.902639","8.885760","-8.882113","-8.867772","-8.864139","-8.851899","8.848762","8.832858","8.807623","8.756757","-8.731408","8.715423","8.669235","8.653867","-8.625411","-8.558198","8.498207","8.468106","8.420818","-8.390938","-8.377750","-8.375885","-8.337307","-8.336839","-8.335918","-8.310842","8.285195","-8.273900","-8.238656","8.185332","-8.167372","-8.166015","-8.151994","-8.147889","8.133957","8.124450","-8.116340","8.100030","8.089762","-8.062832","-8.053948","8.051112","8.037775","8.011229","8.008920","-8.001692","-7.965233","-7.963397","7.960630","7.949726","7.940502","7.928479","7.917493","-7.854469","7.843928","-7.841635","-7.808343","-7.803177","-7.773465","-7.770170","7.767515","7.747873","-7.742448","-7.736127","-7.733471","7.712065","7.690252","-7.686404","7.674697","-7.658441","-7.638812","7.630770","-7.623271","7.581142","7.554669","-7.488004","-7.486591","-7.485210","-7.479911","7.454159","-7.453667","-7.450531","-7.443482","7.440052","-7.429170","7.407606","7.405500","7.394293","-7.388155","-7.381811","7.374548","7.349734","7.349693","-7.333471","-7.330775","7.310493","-7.299819","7.290494","-7.278660","7.271163","7.265992","7.262042","-7.259574","-7.239257","7.233286","7.218252","-7.215852","7.208018","-7.202771","-7.188794","-7.171820","-7.171052","7.162969","7.149153","7.138131","-7.130229","7.114965","-7.114354","7.111418","7.108270","7.100914","-7.099672","-7.098137","-7.070130","7.068712","7.013914","7.010723","-7.008496","7.006744","7.006520","-6.999979","6.996755","6.994866","6.994028","-6.989217","-6.980929","6.969592","6.959194","6.951658","6.945913","-6.941049","6.939898","-6.931112","-6.906680","-6.900021","6.888229","6.852563","-6.844931","6.836287","-6.803235","6.786470","6.772518","-6.754096","-6.753535","6.752102","6.740993","-6.738980","-6.738196","-6.737290","-6.723802","6.723637","6.713173","-6.711849","6.707958","6.706627","-6.706452","-6.700161","-6.675100","-6.666871","-6.665458","6.662411","6.651365","6.645364","6.636495","-6.623099","6.617180","6.614416","6.607145","6.602520","6.598435","6.594899","-6.592665","6.589962","6.582961","-6.577892","6.560949","6.553201","6.552347","6.547505","-6.528469","-6.511796","-6.483677","-6.470310","6.464794","-6.454034","6.451226","6.450223","6.446236","-6.435881","6.434254","6.420017","-6.416631","6.415183","-6.413000","6.402152","-6.383100","6.378651","-6.370668","-6.357216","6.353735","6.351924","-6.343645","-6.341443","-6.323835","-6.313986","-6.312290","-6.311377","-6.301734","6.297729","-6.295304","-6.293334","-6.288069","6.287444","-6.284434","6.277242","-6.275242","-6.268323","-6.252066","6.250618","-6.246170","6.243989","-6.235755","-6.234202","6.212110","6.204122","6.202863","6.201533","-6.194850","-6.193413","-6.179954","6.172496","-6.158900","6.158179","6.156160","6.156114","-6.142507","-6.140188","-6.139196","-6.132313","6.131323","6.128082","-6.109517","-6.108884","6.101964","6.098993","6.098035","6.096895","-6.089320","6.075148","-6.061250","6.057810","-6.056262","-6.054000","6.053283","6.044924","-6.043847","6.028174","-6.024206","-6.012820","-6.008035","6.006210","6.003717","-5.989823","-5.974656","5.971879","5.969795","-5.968149","5.959847","-5.958641","-5.942983","-5.935923","5.930551","-5.929009","-5.926183","-5.921880","5.919219","-5.913360","-5.910530","-5.909875","-5.908073","-5.904796","5.902593","-5.901186","-5.900688","5.895956","5.891336","-5.885825","5.883664","5.872011","5.862061","5.858887","-5.857584","-5.854566","5.843862","-5.843551","5.836991","-5.835142","-5.834196","5.832859","5.825543","5.824297","5.823118","5.806896","-5.806039","-5.803572","5.799647","-5.796976","5.792422","-5.788961","5.782574","5.780417","5.780242","5.779204","-5.776984","-5.776180","-5.771081","-5.766137","5.764304","5.755823","-5.746238","5.744026","5.743135","5.727894","5.721489","5.718480","5.716384","-5.711225","-5.709361","-5.704862","5.695013","5.693058","5.679656","5.679407","5.673695","5.673214","5.669020","5.666157","5.646060","-5.642641","5.640368","5.634253","-5.628672","5.627930","-5.615239","5.603816","-5.598665","-5.596631","5.596403","-5.596144","5.587627","5.579743","5.579507","5.574760","5.571756","5.569462","5.565893","-5.565191","5.560100","-5.554140","-5.550909","5.550152","5.546348","-5.542378","-5.541295","5.538946","5.537316","-5.531177","5.529463","5.529165","-5.527072","-5.525951","5.520517","-5.517641","5.516572","5.509517","-5.508458","5.507650","5.497211","5.496723","5.489369","-5.481048","5.470110","5.466002","5.465406","-5.464859","5.463789","-5.461708","5.458860","5.454482","5.448305","-5.446017","5.439165","5.438082","5.435260","5.429952","5.421593","-5.421500","5.420867","-5.414921","-5.414515","-5.404908"],["3.704246e-41","3.245904e-21","2.838701e-20","4.796539e-18","1.442696e-17","2.669465e-17","3.621713e-17","4.854062e-17","7.882379e-17","7.586857e-16","1.461602e-15","1.513925e-15","1.723749e-15","2.165595e-15","2.387175e-15","3.627160e-15","1.459791e-14","1.686522e-14","1.689439e-14","2.844263e-14","4.688336e-14","6.711711e-14","8.520951e-14","1.965128e-13","1.988655e-13","2.158226e-13","2.290809e-13","2.954736e-13","4.441123e-13","5.674012e-13","6.160283e-13","6.763054e-13","7.797535e-13","8.972876e-13","1.124155e-12","2.072564e-12","2.665448e-12","2.946879e-12","4.070500e-12","5.014457e-12","5.409366e-12","6.044387e-12","8.671530e-12","8.760442e-12","9.122332e-12","9.203120e-12","1.005420e-11","1.232509e-11","1.255261e-11","1.299531e-11","1.464768e-11","1.507631e-11","2.067713e-11","2.172149e-11","3.001461e-11","3.253748e-11","3.705024e-11","4.040294e-11","4.326689e-11","4.559826e-11","4.712735e-11","5.727070e-11","5.848056e-11","6.742963e-11","7.050700e-11","7.414614e-11","8.655752e-11","1.046577e-10","1.081927e-10","1.118080e-10","1.339370e-10","1.354289e-10","1.443640e-10","1.456284e-10","1.547813e-10","1.772265e-10","1.991369e-10","2.038272e-10","2.118424e-10","2.166134e-10","2.266493e-10","2.788573e-10","2.823804e-10","3.150762e-10","3.240472e-10","3.386635e-10","3.467456e-10","3.475723e-10","3.826391e-10","4.027606e-10","4.206024e-10","4.245618e-10","4.405047e-10","4.446388e-10","4.588629e-10","4.625835e-10","4.819196e-10","5.143084e-10","5.865085e-10","6.262670e-10","6.527402e-10","7.358301e-10","7.658072e-10","8.246378e-10","9.825791e-10","1.149495e-09","1.243861e-09","1.408327e-09","1.523510e-09","1.577362e-09","1.585129e-09","1.754891e-09","1.757060e-09","1.761337e-09","1.881956e-09","2.014035e-09","2.075161e-09","2.278310e-09","2.624886e-09","2.753330e-09","2.763292e-09","2.868384e-09","2.899920e-09","3.009588e-09","3.086841e-09","3.154336e-09","3.294649e-09","3.386230e-09","3.638920e-09","3.726426e-09","3.754803e-09","3.891252e-09","4.178047e-09","4.203996e-09","4.286265e-09","4.726890e-09","4.750253e-09","4.785699e-09","4.928010e-09","5.051751e-09","5.217795e-09","5.374381e-09","6.369646e-09","6.553552e-09","6.594266e-09","7.215216e-09","7.316778e-09","7.929707e-09","8.000814e-09","8.058591e-09","8.499370e-09","8.625376e-09","8.774590e-09","8.838069e-09","9.367012e-09","9.939117e-09","1.004369e-08","1.036869e-08","1.083780e-08","1.143308e-08","1.168644e-08","1.192786e-08","1.338145e-08","1.438564e-08","1.726731e-08","1.733434e-08","1.740013e-08","1.765491e-08","1.894810e-08","1.897370e-08","1.913788e-08","1.951207e-08","1.969687e-08","2.029494e-08","2.153503e-08","2.166021e-08","2.233882e-08","2.271955e-08","2.312001e-08","2.358731e-08","2.525729e-08","2.526010e-08","2.641638e-08","2.661368e-08","2.814669e-08","2.898922e-08","2.974609e-08","3.073564e-08","3.137969e-08","3.183190e-08","3.218175e-08","3.240242e-08","3.427757e-08","3.484930e-08","3.633208e-08","3.657468e-08","3.737794e-08","3.792586e-08","3.942569e-08","4.132824e-08","4.141645e-08","4.235690e-08","4.401486e-08","4.538455e-08","4.639302e-08","4.840591e-08","4.848827e-08","4.888621e-08","4.931645e-08","5.033698e-08","5.051136e-08","5.072779e-08","5.484524e-08","5.506249e-08","6.416154e-08","6.473595e-08","6.514012e-08","6.545971e-08","6.550067e-08","6.670922e-08","6.731311e-08","6.766945e-08","6.782807e-08","6.874675e-08","7.035872e-08","7.262588e-08","7.477032e-08","7.636447e-08","7.760292e-08","7.866726e-08","7.892128e-08","8.088806e-08","8.662170e-08","8.825452e-08","9.122298e-08","1.008313e-07","1.030170e-07","1.055504e-07","1.158332e-07","1.214305e-07","1.262969e-07","1.330263e-07","1.332369e-07","1.337762e-07","1.380322e-07","1.388180e-07","1.391254e-07","1.394814e-07","1.448905e-07","1.449580e-07","1.493023e-07","1.498611e-07","1.515160e-07","1.520863e-07","1.521617e-07","1.548883e-07","1.662499e-07","1.701617e-07","1.708428e-07","1.723207e-07","1.777872e-07","1.808302e-07","1.854246e-07","1.925884e-07","1.958420e-07","1.973808e-07","2.014863e-07","2.041426e-07","2.065182e-07","2.085973e-07","2.099217e-07","2.115350e-07","2.157732e-07","2.188954e-07","2.296658e-07","2.347681e-07","2.353369e-07","2.385917e-07","2.518340e-07","2.640408e-07","2.859973e-07","2.970734e-07","3.017689e-07","3.111455e-07","3.136409e-07","3.145369e-07","3.181245e-07","3.276372e-07","3.291571e-07","3.427699e-07","3.460907e-07","3.475201e-07","3.496864e-07","3.606585e-07","3.807757e-07","3.856341e-07","3.945100e-07","4.099343e-07","4.140247e-07","4.161683e-07","4.261133e-07","4.287981e-07","4.508930e-07","4.637487e-07","4.659993e-07","4.672164e-07","4.802594e-07","4.857836e-07","4.891590e-07","4.919191e-07","4.993732e-07","5.002655e-07","5.045862e-07","5.150623e-07","5.180145e-07","5.283582e-07","5.534916e-07","5.557878e-07","5.629026e-07","5.664233e-07","5.799213e-07","5.825019e-07","6.205095e-07","6.348595e-07","6.371510e-07","6.395809e-07","6.519347e-07","6.546228e-07","6.803439e-07","6.950325e-07","7.226402e-07","7.241345e-07","7.283353e-07","7.284309e-07","7.573973e-07","7.624496e-07","7.646213e-07","7.798568e-07","7.820748e-07","7.893742e-07","8.325403e-07","8.340531e-07","8.507737e-07","8.580579e-07","8.604183e-07","8.632378e-07","8.822050e-07","9.188256e-07","9.562253e-07","9.657171e-07","9.700194e-07","9.763416e-07","9.783531e-07","1.002123e-06","1.005229e-06","1.051521e-06","1.063576e-06","1.098950e-06","1.114168e-06","1.120028e-06","1.128080e-06","1.174051e-06","1.226388e-06","1.236222e-06","1.243653e-06","1.249555e-06","1.279752e-06","1.284199e-06","1.343375e-06","1.370947e-06","1.392308e-06","1.398503e-06","1.409924e-06","1.427496e-06","1.438471e-06","1.462939e-06","1.474907e-06","1.477690e-06","1.485380e-06","1.499460e-06","1.509002e-06","1.515130e-06","1.517302e-06","1.538119e-06","1.558723e-06","1.583659e-06","1.593545e-06","1.647947e-06","1.695871e-06","1.711453e-06","1.717892e-06","1.732897e-06","1.787186e-06","1.788790e-06","1.822932e-06","1.832674e-06","1.837677e-06","1.844777e-06","1.884095e-06","1.890877e-06","1.897313e-06","1.988163e-06","1.993085e-06","2.007314e-06","2.030168e-06","2.045862e-06","2.072914e-06","2.093711e-06","2.132640e-06","2.145955e-06","2.147034e-06","2.153474e-06","2.167311e-06","2.172344e-06","2.204534e-06","2.236206e-06","2.248067e-06","2.303759e-06","2.368376e-06","2.383540e-06","2.389679e-06","2.497151e-06","2.543754e-06","2.565946e-06","2.581520e-06","2.620260e-06","2.634405e-06","2.668850e-06","2.745838e-06","2.761386e-06","2.870366e-06","2.872428e-06","2.920217e-06","2.924272e-06","2.959913e-06","2.984501e-06","3.162907e-06","3.194310e-06","3.215359e-06","3.272673e-06","3.325881e-06","3.333019e-06","3.457536e-06","3.573598e-06","3.627204e-06","3.648596e-06","3.650997e-06","3.653735e-06","3.744809e-06","3.831144e-06","3.833753e-06","3.886737e-06","3.920633e-06","3.946724e-06","3.987666e-06","3.995771e-06","4.055023e-06","4.125517e-06","4.164239e-06","4.173360e-06","4.219530e-06","4.268253e-06","4.281637e-06","4.310828e-06","4.331195e-06","4.408770e-06","4.430682e-06","4.434506e-06","4.461424e-06","4.475917e-06","4.546826e-06","4.584807e-06","4.598996e-06","4.693809e-06","4.708212e-06","4.719226e-06","4.863902e-06","4.870777e-06","4.975506e-06","5.096733e-06","5.260594e-06","5.323496e-06","5.332685e-06","5.341135e-06","5.357691e-06","5.390040e-06","5.434650e-06","5.503928e-06","5.603179e-06","5.640400e-06","5.753345e-06","5.771401e-06","5.818723e-06","5.908785e-06","6.053460e-06","6.055084e-06","6.066190e-06","6.171464e-06","6.178724e-06","6.352922e-06"],["<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.708468e-37<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.062934e-17<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.202757e-16<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.524220e-14<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.667623e-14<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.655262e-14<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.576513e-14<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">7.712498e-14<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.113255e-13<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.643654e-13<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.603626e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.603626e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.685428e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.966205e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.022892e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.881552e-12<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.091494e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.130235e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.130235e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.807671e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.837783e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.877844e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.709122e-11<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.011112e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.011112e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.055124e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.078462e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.341345e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.946590e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.404079e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.525915e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.686412e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.003469e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.354536e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.082608e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">7.317879e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.156894e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.857309e-10<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.326670e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.593469e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.677035e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.829291e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.530772e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.530772e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.543062e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.543062e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.719127e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.256250e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.256250e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.303667e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.650719e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.685288e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.959000e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.112998e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.936650e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">7.385428e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">8.262203e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">8.854512e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.321449e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.659990e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.820258e-09<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.174142e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.179915e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.339216e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.378792e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.427987e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.642138e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.956330e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.993097e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.030274e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.390885e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.390885e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.501462e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.501462e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.623234e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.964114e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.287311e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.321599e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.408517e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.441716e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.556715e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.322628e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.324503e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.767779e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.845840e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.005525e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.020444e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.020444e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.464860e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.688322e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.865875e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.865875e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.012557e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.012557e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.124894e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.124894e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.315134e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.670789e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">7.530414e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">7.960480e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">8.214832e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.169742e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">9.450656e-08<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.007882e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.189482e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.378418e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.477638e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.657523e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.776637e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.815187e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.815187e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.963891e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.963891e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">1.963891e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.080134e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.206931e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.254476e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.454203e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.803776e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.902827e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.902827e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.988527e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">2.996820e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.085071e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.138947e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.182124e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.297503e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.362686e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.585605e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.643306e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.643306e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.747099e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.987835e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">3.987835e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.035757e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.407333e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.407333e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.408045e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.506470e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.586629e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.703787e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">4.810828e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.661858e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.780670e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">5.780670e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.281686e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0000\">6.326773e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">6.810439e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">6.825392e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">6.828850e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">7.154668e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">7.212971e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">7.289792e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">7.294850e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">7.681554e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">8.098469e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">8.131550e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">8.341549e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">8.664109e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">9.082865e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">9.226481e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">9.358953e-07<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">1.043507e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0101\">1.114975e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.324390e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.324390e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.324390e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.335783e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.418675e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.418675e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.422583e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.441965e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.447208e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.482580e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.564181e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.564335e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.604230e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.622405e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.641779e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.665657e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.764182e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.764182e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.834855e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0202\">1.838513e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">1.933906e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">1.981086e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.021939e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.078089e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.110409e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.129554e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.141687e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.145141e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.257524e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.283348e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.368293e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.371943e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.411731e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.434725e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0303\">2.518291e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.619127e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.619127e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.665339e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.756024e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.827858e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.876593e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.977461e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.977461e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.987465e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">2.999337e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">3.041514e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">3.041514e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0404\">3.041514e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0505\">3.270558e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0505\">3.270558e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0505\">3.793290e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.801731e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.801731e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.801731e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.801731e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.854277e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.866200e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.866200e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.866200e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.901071e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">3.974799e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.084724e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.186809e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.257319e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.307471e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.342720e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.342720e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0606\">4.431759e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0707\">4.725530e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0707\">4.794031e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0707\">4.934193e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0808\">5.430791e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0808\">5.525100e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0808\">5.637191e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0909\">6.160483e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0a0a\">6.431264e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0a0a\">6.661244e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">6.968971e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">6.968971e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">6.968971e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.148984e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.148984e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.148984e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.148984e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.370244e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.370244e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.559067e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.559067e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.584813e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.584813e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0b0b\">7.584813e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0c0c\">7.690567e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0c0c\">8.222579e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0d0d\">8.383433e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0d0d\">8.384490e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0d0d\">8.424495e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0d0d\">8.658440e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0d0d\">8.773025e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0e0e\">8.961717e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0e0e\">9.272692e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0e0e\">9.393765e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0e0e\">9.431982e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.592105e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.682300e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.758559e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.820295e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.846179e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">9.885373e-06<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff0f0f\">1.004649e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1010\">1.015467e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1010\">1.061557e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1111\">1.079916e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1111\">1.079916e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1111\">1.090913e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1212\">1.147334e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1212\">1.198651e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1414\">1.293705e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1515\">1.339043e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1515\">1.355401e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1515\">1.392595e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1616\">1.397929e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1616\">1.397929e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1616\">1.408948e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1616\">1.446040e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1616\">1.447722e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1717\">1.502396e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1717\">1.511738e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1717\">1.512784e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1717\">1.517018e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1818\">1.559296e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1919\">1.640691e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1a1a\">1.656012e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1a1a\">1.688423e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1b1b\">1.748549e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1b1b\">1.760090e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1b1b\">1.763305e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1c1c\">1.799444e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1c1c\">1.804785e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1d1d\">1.891518e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1e1e\">1.939049e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1e1e\">1.940780e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1e1e\">1.940780e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1f1f\">1.988462e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1f1f\">2.004804e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1f1f\">2.012201e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff1f1f\">2.017027e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2020\">2.038101e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2020\">2.038101e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2020\">2.049136e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2020\">2.085018e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2121\">2.090312e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2121\">2.125304e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2323\">2.219379e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2323\">2.221578e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2323\">2.242964e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2323\">2.249940e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2424\">2.296380e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2424\">2.299435e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2626\">2.441887e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2727\">2.490648e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2727\">2.491947e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2727\">2.493777e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2828\">2.534172e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2828\">2.536863e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2929\">2.628526e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2a2a\">2.677139e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2b2b\">2.772181e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2b2b\">2.772181e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2b2b\">2.772181e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2b2b\">2.772181e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2d2d\">2.873814e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2d2d\">2.884006e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2d2d\">2.884006e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2e2e\">2.932434e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2e2e\">2.932434e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff2e2e\">2.951099e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3030\">3.099897e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3030\">3.099897e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3131\">3.152823e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3232\">3.170080e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3232\">3.170080e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3232\">3.171276e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3333\">3.231616e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3434\">3.356090e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3636\">3.482688e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3737\">3.507208e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3737\">3.512797e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3737\">3.522902e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3737\">3.522902e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3838\">3.598300e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3838\">3.599285e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3b3b\">3.754461e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3b3b\">3.786865e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3d3d\">3.901885e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3e3e\">3.944898e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3e3e\">3.954633e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff3e3e\">3.972030e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4141\">4.122476e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4343\">4.294384e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4444\">4.316929e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4444\">4.330978e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4444\">4.339645e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4545\">4.432405e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4646\">4.435721e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4949\">4.627544e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4a4a\">4.709759e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4b4b\">4.770249e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4b4b\">4.778594e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4b4b\">4.804703e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4c4c\">4.851578e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4c4c\">4.875840e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4e4e\">4.945589e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4e4e\">4.969027e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4e4e\">4.969027e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4e4e\">4.981707e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4f4f\">5.015695e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4f4f\">5.034362e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4f4f\">5.035620e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff4f4f\">5.035620e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5050\">5.091413e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5151\">5.146215e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5252\">5.214996e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5252\">5.233993e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5555\">5.398724e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5757\">5.541443e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5858\">5.578022e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5858\">5.584686e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5858\">5.619095e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5b5b\">5.770892e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5b5b\">5.770892e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5c5c\">5.866148e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5c5c\">5.882605e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5c5c\">5.883806e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5d5d\">5.891697e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5e5e\">6.002188e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5e5e\">6.008735e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff5e5e\">6.014150e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6363\">6.286377e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6363\">6.286377e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6363\">6.315587e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6464\">6.371719e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6565\">6.405162e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6666\">6.473910e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6666\">6.522832e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6868\">6.627871e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6868\">6.640133e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6868\">6.640133e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6868\">6.643887e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6969\">6.669727e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6969\">6.669727e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6a6a\">6.752248e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6b6b\">6.832793e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6c6c\">6.852562e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff6e6e\">7.005522e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7171\">7.184827e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7171\">7.213613e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7171\">7.215015e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7676\">7.521632e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7878\">7.643889e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7979\">7.692392e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7979\">7.720870e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7b7b\">7.818339e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7b7b\">7.842138e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff7d7d\">7.926111e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8080\">8.135745e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8080\">8.162786e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8585\">8.451720e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8585\">8.451720e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8787\">8.564613e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8787\">8.564613e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8888\">8.649071e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff8989\">8.700914e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9191\">9.199934e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9292\">9.270063e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9292\">9.309893e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9595\">9.454307e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9797\">9.585070e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9797\">9.585070e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ff9c9c\">9.920709e-05<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa1a1\">1.023063e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa3a3\">1.036076e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa3a3\">1.036666e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa3a3\">1.036666e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa3a3\">1.036666e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa7a7\">1.060140e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffaaaa\">1.080506e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffaaaa\">1.080506e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffacac\">1.093016e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffadad\">1.100114e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffaeae\">1.104996e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffafaf\">1.113821e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffafaf\">1.113821e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb2b2\">1.127864e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb4b4\">1.144966e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb6b6\">1.153195e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb6b6\">1.153208e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb7b7\">1.163437e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb9b9\">1.174324e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb9b9\">1.175462e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbaba\">1.180925e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbaba\">1.183953e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbdbd\">1.202572e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbebe\">1.204423e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbebe\">1.204423e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbebe\">1.209151e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbfbf\">1.210497e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc1c1\">1.227064e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc2c2\">1.234692e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc3c3\">1.235895e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc6c6\">1.258713e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc6c6\">1.259917e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc6c6\">1.260212e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffcccc\">1.295239e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffcccc\">1.295239e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd0d0\">1.320327e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd5d5\">1.349679e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdbdb\">1.390175e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdddd\">1.402710e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdddd\">1.402710e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdddd\">1.402710e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdddd\">1.404157e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdede\">1.409728e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffdfdf\">1.418477e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe2e2\">1.433615e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe5e5\">1.456483e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7e7\">1.463166e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffebeb\">1.489425e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffebeb\">1.491063e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffecec\">1.500239e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff0f0\">1.520376e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4f4\">1.551455e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4f4\">1.551455e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff4f4\">1.551455e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff8f8\">1.573903e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #fff8f8\">1.573903e-04<\/span>","<span style=\"display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff\">1.615040e-04<\/span>"],["73.391970","37.388636","36.189311","27.057892","30.031436","29.367349","28.782388","28.774989","27.868426","26.148515","25.445103","25.467354","25.120186","25.097814","25.018035","24.581049","23.184184","23.061679","23.074210","22.533910","22.033719","21.655063","21.378583","20.574396","20.585567","20.541777","20.488990","20.206694","19.806646","19.511700","19.443203","19.346310","19.196448","19.120218","18.821648","15.845868","17.971040","17.234461","17.649845","17.423827","17.246486","17.164245","16.859104","16.790482","16.789857","16.830202","16.691084","16.532312","16.560172","16.360666","16.376660","16.212116","16.070530","15.845295","15.572607","14.051402","15.312203","15.266774","15.206733","15.110310","15.073105","14.886769","14.864750","14.890133","14.859885","14.603482","14.451033","14.386741","14.247687","14.418459","14.234448","13.997301","14.139689","13.975552","13.864229","13.197211","12.452652","12.955999","13.591331","13.700562","13.508095","13.495848","13.484861","13.184050","13.193090","13.332507","13.232813","13.072838","12.508202","13.004552","12.857124","12.873109","13.033482","12.801133","12.770092","12.760708","12.775058","12.379200","12.542614","12.632051","12.412606","12.292920","12.255940","12.229995","12.007586","11.951206","11.835487","11.644054","11.770068","11.524941","11.549082","11.417565","11.681698","11.522455","11.358347","11.376248","11.445720","11.155835","11.080051","11.014717","11.291230","11.014141","10.917489","10.949560","11.032042","10.826790","10.854365","10.813392","10.706299","10.661911","10.660301","10.625520","10.544575","10.876067","10.566844","10.435823","10.695855","10.470789","10.411568","10.355253","10.321394","10.326943","10.480811","9.928080","10.086757","10.011280","9.994772","9.945727","9.899155","9.926488","9.872940","10.086946","9.807750","10.103557","9.748387","9.674071","9.777316","9.795066","9.725869","9.590114","9.526919","9.493087","9.372996","9.531039","9.163347","9.115373","9.192478","9.100959","9.268962","9.268814","9.018562","9.392828","8.986209","9.081942","8.894736","8.895973","8.879855","8.894159","8.832964","8.809928","8.736856","8.740584","8.736713","9.040243","8.676705","8.598822","8.572432","8.583716","8.789511","8.508997","8.497865","8.907866","8.712980","8.419603","8.371792","8.308377","8.390951","8.731002","8.436663","8.455818","8.311941","8.363206","8.202181","8.199359","8.246896","8.111525","8.194430","8.081027","8.064554","8.042402","8.150550","8.132265","8.131699","8.087118","8.187187","7.836022","7.790003","7.914934","7.778186","7.759287","7.758367","7.745869","7.789781","7.738034","7.736063","7.673832","7.644982","7.631256","8.016798","7.935436","7.596465","7.734454","7.546712","7.889363","7.445283","7.351321","7.571879","7.301888","7.544276","7.191079","7.565685","7.223940","7.070639","7.067933","7.032421","7.208794","7.505234","7.033866","7.119961","6.996383","6.979351","7.003472","7.321441","6.943843","7.115585","7.051810","7.078244","7.191775","6.816269","6.859590","6.781789","6.763475","6.756528","6.705100","6.709869","6.670951","6.651132","6.677154","6.859995","7.065201","6.628091","6.668167","6.737798","7.000067","6.520110","6.500664","6.497989","6.567250","6.928263","6.709729","6.307568","6.323610","6.254967","6.217557","6.208188","6.208970","6.714535","6.567838","6.452735","6.125052","6.628126","6.159824","6.132732","6.118072","6.279418","6.041542","6.124639","6.459012","5.930415","5.975691","5.957968","6.163204","6.169860","6.343435","5.812342","5.879584","5.781900","5.824450","5.855981","5.815363","5.844614","5.779926","6.111060","5.812387","5.753133","6.020593","5.653365","5.655028","5.622937","5.706096","5.922887","6.079365","5.986486","5.525065","5.522223","5.495132","5.674623","5.740457","5.435016","5.418569","5.928337","5.370970","5.364220","5.393555","5.325593","5.328893","5.338748","5.360001","5.330112","5.741440","5.242674","5.528591","5.209854","5.203880","5.200199","5.194166","5.605292","5.135233","5.257434","5.082666","5.078495","5.073301","5.367259","5.289695","5.561979","5.044710","5.564018","4.995636","5.012180","4.958353","4.931836","5.008291","4.916245","4.847965","4.831646","4.939568","4.802808","4.799729","4.767387","4.743706","4.726159","5.200185","4.819385","4.869737","4.706361","4.829828","4.840341","4.665644","5.124108","5.043277","4.755226","4.632369","4.687382","4.620590","5.166544","4.735002","4.606503","4.630169","4.520160","4.516255","4.508021","4.498279","4.524232","4.575781","4.487904","4.447552","4.524064","4.462425","4.450654","5.010915","4.695276","4.367802","4.505101","4.459855","4.379505","4.356310","4.366450","4.354748","4.308453","4.309613","4.316389","4.282457","4.296285","4.866226","4.766664","4.244316","4.243432","4.465383","4.272491","4.180437","4.179786","4.134661","4.161667","4.114989","4.100644","4.639770","4.097371","4.248217","4.042338","4.620302","4.004452","4.298498","3.981916","3.987897","3.965810","3.964769","4.535014","3.904493","4.032884","3.864306","3.939924","4.337363","3.928615","3.781087","3.781140","3.786163","3.863129","4.169905","3.742520","3.724916","3.716002","3.693671","3.688911","3.689767","4.139840","4.179306","3.652035","4.273068","3.629308","3.750748","3.665873","3.985306","3.650692","3.613811","4.238897","3.628505","3.567584","3.687345","3.864958","4.058175","3.543267","4.012310","4.011884","3.881338","3.523479","3.548369","3.469763","4.128973","3.450549","4.078773","3.400988","4.030208","3.400110","3.690909","3.376224","3.425860","3.378438","3.755970","3.343430","3.324456","3.451328","3.317313","3.298275","3.669126","3.254912","3.288045","3.608854","3.623864","3.293233","3.229227"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>SYMBOL<\/th>\n      <th>ENTREZID<\/th>\n      <th>GENENAME<\/th>\n      <th>logFC<\/th>\n      <th>AveExpr<\/th>\n      <th>t<\/th>\n      <th>P.Value<\/th>\n      <th>adj.P.Val<\/th>\n      <th>B<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"columnDefs":[{"orderable":false,"targets":0}]}},"evals":[],"jsHooks":[]}</script></p>
<p>Full results from differential expression testing are then exported to the output folder.</p>
<pre class="r"><code>for (i in seq_along(colnames(contrastFit))){
  #Write one output file containing the summary table for each contrast, exported to the projectName folder
  outputFile&lt;-paste(&quot;./output/&quot;,projectName,&quot;/&quot;,&quot;DE genes - &quot;,colnames(contrastFit)[i],&quot;.csv&quot;,sep=&quot;&quot;)
  write.csv(differentialExpressionResults[[i]],outputFile)
}</code></pre>
</div>
</div>
<div id="differential-expression-plots" class="section level1">
<h1>Differential expression plots</h1>
<div id="venn-diagram" class="section level2">
<h2>Venn diagram</h2>
<p>Statistical testing suggests several thousand differentially expressed genes across the main contrasts of interest. These are summarised below.</p>
<pre class="r"><code>#Generate a list of significantly DE genes for each contrast
contrastSigNames&lt;-list()
for(i in seq_along(colnames(contrastFit))){
  contrastSigNames[[i]]&lt;-names(which(summaryFit[,i]!=0))
}
#Name this list according to each contrast
names(contrastSigNames)&lt;-colnames(contrastFit)

#Select the contrasts for which to plot the overlaps
vennContrasts&lt;-c(1,2,3)
vennList&lt;-contrastSigNames[vennContrasts]
names(vennList)&lt;-colnames(contrastFit)[vennContrasts]
#Determine the shared elements of the lists
vennOverlap&lt;-calculate.overlap(vennList)

#Draw the Venn diagram
plot.new()
grid.draw(venn.diagram(vennList,filename=NULL))</code></pre>
<p><img src="figure/Dexamethasone-study.Rmd/Venn-diagram-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="volcano-plots" class="section level2">
<h2>Volcano plots</h2>
<p>In the volcano plots below, the top 15 genes (if significant) are highlighted in red. Vertical dashed lines represent a doubling or halving of gene expression, and the horizontal dashed line indicates an adjusted p=0.05.</p>
<div id="genotype-effect" class="section level3">
<h3>Genotype effect</h3>
<p>Throughout this analysis, a positive fold change value for this contrast indicates higher expression in the wild type animal. Note that <em>Actn3</em> is significantly downregulated in the <em>Actn3</em> KO mouse. <img src="figure/Dexamethasone-study.Rmd/Genotype-effect-volcano-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="treatment-effect" class="section level3">
<h3>Treatment effect</h3>
<p>Throughout this analysis, a positive fold change value for this contrast indicates higher expression in the Dexamethasone treated animal. <img src="figure/Dexamethasone-study.Rmd/Treatment-effect-volcano-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="treatment-time-interaction-effect" class="section level3">
<h3>Treatment-time interaction effect</h3>
<p>For this and the interaction effect plots below, fold change refers to an estimated effect size, and does not have a direct biological interpretation. <img src="figure/Dexamethasone-study.Rmd/Treatment-time-interaction-effect-volcano-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="genotype-treatment-interaction-effect" class="section level3">
<h3>Genotype-treatment interaction effect</h3>
<p><img src="figure/Dexamethasone-study.Rmd/Genotype-treatment-interaction-effect-volcano-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="genotype-treatment-time-interaction-effect" class="section level3">
<h3>Genotype-treatment-time interaction effect</h3>
<p><img src="figure/Dexamethasone-study.Rmd/Genotype-treatment-time-interaction-effect-volcano-plot-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="patterns-of-differential-expression" class="section level1">
<h1>Patterns of differential expression</h1>
<div id="filtering" class="section level2">
<h2>Filtering</h2>
<p>We proceed to assess coordinated shifts in gene expression. Only genes asssessed as significantly differentially expressed (as described earlier) with a prescribed minimum fold change in any assessed contrast are included in the heatmaps that follow.</p>
<pre class="r"><code>#Select the minimum fold change of differential expression for inclusion in heatmaps
foldChangeThreshold &lt;- 2
log2FoldChangeThreshold &lt;- log2(foldChangeThreshold)

#Filter the geneset
filteredGenes&lt;-filterGenes(dataset=differentialExpressionResults,
                           summaryTable=summaryFit,
                           contrastsToConsider=colnames(contrastFit),
                           filterSig=TRUE,
                           filterFC=TRUE,
                           fcThreshold=log2FoldChangeThreshold)</code></pre>
<p>Of a total 12711 genes for which differential expression was assessed, 1145 are retained for analysis in the heatmap.</p>
</div>
<div id="clustered-heatmap" class="section level2">
<h2>Clustered heatmap</h2>
<pre class="r"><code>baseHeatMap &lt;- generateBaseHeatmapFunction(
  geneList = filteredGenes,
  dataset = v$E,
  clusterMethod = &quot;ward.D2&quot;,
  sampleSetLabel = as.character(sampleColours)
)

geneDendrogram &lt;- getDendrogramLabels(
  heatmapFunction = baseHeatMap,
  geneList = filteredGenes,
  dataset = v$E,
  clusterDepth = 10
)</code></pre>
<p>To identify coordinated shifts in gene expression related to experimental grouping, we then cluster sample expression data on the basis of both gene-wise and sample-wise variation.</p>
<pre class="r"><code>plotHeatmap&lt;-generateHeatmapFunction(geneList = filteredGenes,
                                   dataset = v$E,
                                   clusterGenes = TRUE,
                                   clusterMethod = &quot;ward.D2&quot;,
                                   clusterDepth = 10,
                                   suppliedDendrogram = geneDendrogram,
                                   geneSetLabel = NULL,
                                   sampleSetLabel = as.character(sampleColours))

plotHeatmap()</code></pre>
<p><img src="figure/Dexamethasone-study.Rmd/Clustered-heatmap-1.png" width="672" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.0 (2019-04-26)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS release 6.7 (Final)

Matrix products: default
BLAS:   /usr/local/installed/R/3.6.0/lib64/R/lib/libRblas.so
LAPACK: /usr/local/installed/R/3.6.0/lib64/R/lib/libRlapack.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
 [1] grid      parallel  stats4    stats     graphics  grDevices utils    
 [8] datasets  methods   base     

other attached packages:
 [1] DT_0.9               formattable_0.2.0.1  condformat_0.8.0    
 [4] kableExtra_1.1.0     rglwidget_0.2.1      rgl_0.100.26        
 [7] RColorBrewer_1.1-2   VennDiagram_1.6.20   futile.logger_1.4.3 
[10] ggrepel_0.8.1        ggplot2_3.2.1        gplots_3.0.1.1      
[13] dendextend_1.12.0    dplyr_0.8.3          GO.db_3.8.2         
[16] org.Mm.eg.db_3.8.2   AnnotationDbi_1.46.1 IRanges_2.18.1      
[19] S4Vectors_0.22.0     Biobase_2.44.0       BiocGenerics_0.30.0 
[22] fgsea_1.10.0         Rcpp_1.0.2           biomaRt_2.40.5      
[25] edgeR_3.26.7         limma_3.40.6         knitr_1.25          

loaded via a namespace (and not attached):
 [1] bitops_1.0-6            fs_1.3.1               
 [3] bit64_0.9-7             webshot_0.5.1          
 [5] progress_1.2.2          httr_1.4.1             
 [7] rprojroot_1.3-2         tools_3.6.0            
 [9] backports_1.1.5         R6_2.4.0               
[11] KernSmooth_2.23-15      DBI_1.0.0              
[13] lazyeval_0.2.2          colorspace_1.4-1       
[15] manipulateWidget_0.10.0 withr_2.1.2            
[17] tidyselect_0.2.5        gridExtra_2.3          
[19] prettyunits_1.0.2       bit_1.1-14             
[21] compiler_3.6.0          git2r_0.26.1           
[23] rvest_0.3.4             htmlTable_1.13.2       
[25] formatR_1.7             xml2_1.2.2             
[27] labeling_0.3            checkmate_1.9.4        
[29] caTools_1.17.1.2        scales_1.0.0           
[31] readr_1.3.1             stringr_1.4.0          
[33] digest_0.6.21           rmarkdown_1.14         
[35] pkgconfig_2.0.3         htmltools_0.4.0        
[37] htmlwidgets_1.5         rlang_0.4.0            
[39] rstudioapi_0.10         RSQLite_2.1.2          
[41] shiny_1.3.2             jsonlite_1.6           
[43] crosstalk_1.0.0         BiocParallel_1.18.1    
[45] gtools_3.8.1            RCurl_1.95-4.12        
[47] magrittr_1.5            Matrix_1.2-17          
[49] munsell_0.5.0           viridis_0.5.1          
[51] stringi_1.4.3           whisker_0.3-2          
[53] yaml_2.2.0              blob_1.2.0             
[55] gdata_2.18.0            promises_1.0.1         
[57] crayon_1.3.4            miniUI_0.1.1.1         
[59] lattice_0.20-38         hms_0.5.0              
[61] locfit_1.5-9.1          zeallot_0.1.0          
[63] pillar_1.4.2            futile.options_1.0.1   
[65] fastmatch_1.1-0         XML_3.98-1.20          
[67] glue_1.3.1              evaluate_0.14          
[69] lambda.r_1.2.3          data.table_1.12.4      
[71] vctrs_0.2.0             httpuv_1.5.1           
[73] gtable_0.3.0            purrr_0.3.2            
[75] assertthat_0.2.1        xfun_0.10              
[77] mime_0.7                xtable_1.8-4           
[79] later_0.8.0             viridisLite_0.3.0      
[81] tibble_2.1.3            memoise_1.1.0          
[83] workflowr_1.4.0        </code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
